<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>condor_annex</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,sec-filename,next,info,NoFonts,fonts,html --> 
<meta name="src" content="ref.tex"> 
<link rel="stylesheet" type="text/css" href="ref.css"> 
</head><body 
>
<span style="font-size: 200%;"><a 
href="Condoradvertise.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condoradvertise.html#tailCondoradvertise.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="#tailCondorannex.html">&#x2193;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="CommandReferenceManualmanpages.html#Condorannex.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condorcheckuserlogs.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><h3 class="sectionHead"><a 
 id="x99-68500012"></a><span class="textit">condor_annex</span></h3>
<div class="sectionTOCS">
</div>
<!--l. 2--><p class="noindent" >Add cloud resources to the pool.  <a 
 id="dx99-685001"></a><a 
 id="dx99-685002"></a>
<!--l. 6--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-68600012"></a>Synopsis</h4>
<!--l. 8--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> <span class="textbf">-help</span>
<!--l. 10--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> [<span class="textbf">-aws-region&#x00A0;&#x00A0;</span><span class="textit">&#x003C;region&#x003E;</span>] <span class="textbf">-setup&#x00A0;</span><span class="textit">[/full/path/to/access/key/file [/full/path/to/secret/key/file]]</span>
<!--l. 12--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> [<span class="textbf">-aws-on-demand</span>] <span class="textbf">-annex-name&#x00A0;</span><span class="textit">&#x003C;name of the annex&#x003E;</span> <span class="textbf">-count&#x00A0;</span><span class="textit">&#x003C;integer number of instances&#x003E;</span>
[<span class="textbf">-aws-on-demand-*</span>] [<span class="textbf">common options</span>]
<!--l. 18--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> [<span class="textbf">-aws-spot-fleet</span>] <span class="textbf">-annex-name&#x00A0;</span><span class="textit">&#x003C;name of the annex&#x003E;</span> <span class="textbf">-slots&#x00A0;</span><span class="textit">&#x003C;integer weight&#x003E;</span>
[<span class="textbf">-aws-spot-fleet-*</span>] [<span class="textbf">common options</span>]
<!--l. 24--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> <span class="textbf">-annex-name&#x00A0;</span><span class="textit">&#x003C;name of the annex&#x003E;</span> <span class="textbf">-duration&#x00A0;</span><span class="textit">hours</span>
<!--l. 28--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> [<span class="textbf">-annex-name&#x00A0;&#x00A0;</span><span class="textit">&#x003C;name of the annex&#x003E;</span>] <span class="textbf">-status</span> [<span class="textbf">-classad</span>]
<!--l. 33--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> <span class="textbf">-check-setup</span>
<!--l. 35--><p class="noindent" ><span class="textbf"><span class="textit">condor_annex</span></span> <span class="emph">&#x003C;condor_annex options&#x003E;</span> <span class="textbf">status</span> <span class="emph">&#x003C;condor_status options&#x003E;</span>
<!--l. 37--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-68700012"></a>Description</h4>
<!--l. 39--><p class="noindent" ><span class="textit">condor_annex</span> adds clouds resources to the pool. (&#8220;The pool&#8221; is determined in the usual manner for HTCondor
daemons and tools.) This version supports only Amazon Web Services (&#8216;AWS&#8217;). To add &#8220;on-demand&#8221; instances, use
the third form listed above; to add &#8220;spot&#8221; instances, use the fourth. For an explanation of terms, consult either the
HTCondor manual (chapter <a 
href="CloudComputing.html#x58-4970006">6<!--tex4ht:ref: cloud-computing --></a>) or the AWS documentation.
                                                                                         

                                                                                         
<!--l. 46--><p class="noindent" >Using <span class="textit">condor_annex</span> with AWS requires a one-time setup procedure performed by invoking <span class="textit">condor_annex</span> with the
<span class="textbf">-setup</span> flag (the second form listed above). You may check if this procedure has been performed with the
<span class="textbf">-check-setup</span> flag (the seventh form listed above).
<!--l. 51--><p class="noindent" >To reset the lease on an existing annex, invoke <span class="textit">condor_annex</span> with only the <span class="textbf">-annex-name</span> option and <span class="textbf">-duration</span>
flag (the fifth form listed above).
<!--l. 55--><p class="noindent" >To determine which of the instances previously requested for a particular annex are not currently in the pool, invoke
<span class="textit">condor_annex</span> with the <span class="textbf">-status</span> flag and the <span class="textbf">-annex-name</span> option (the sixth form listed above). The
output of this command is intended to be human-readable; specifying the <span class="textbf">-classad</span> flag will produce the
same information in ClassAd format. If you omit <span class="textbf">-annex-name</span>, information for all annexes will be
returned.
<!--l. 63--><p class="noindent" >Starting in 8.7.3, you may instead invoke <span class="textit">condor_annex</span> with <span class="textbf">status</span> as a command argument (the eighth form
listed above). This will cause <span class="textit">condor_annex</span> to use <span class="textit">condor_status</span> to present annex instance data. Arguments and
options on the command line after <span class="textbf">status</span> will be passed unmodified to <span class="textit">condor_status</span>, but not all arguments and
options will behave as expected. (See below.) <span class="textit">condor_annex</span> will construct an ad for each annex instance and pass
that information to <span class="textit">condor_status</span>; <span class="textit">condor_status</span> will (unless you specify otherwise using its command line)
query the collector for more information about the instances. Information from the collector will be
presented as usual; instances which did not have ads in the collector will be presented last, in their
own table. These instances can not be presented in the usual way because the annex instance ads
generated by <span class="textit">condor_annex</span> do not (and can not) have the same information in them as ads generated
by a <span class="textit">condor_startd</span> running in the instance. See the <span class="textit">condor_status</span> documentation (section&#x00A0;<a 
href="Condorstatus.html#x147-106400012">12<!--tex4ht:ref: man-condor-status --></a>) for
details about the &#8220;merge&#8221; mode of <span class="textit">condor_status</span> used by this command argument. Note that both
<span class="textit">condor_annex</span> and <span class="textit">condor_status</span> have <span class="textbf">-annex-name</span> options; if you&#8217;re interested in a particular
annex, put this flag on the command line <span class="emph">before</span> the <span class="textbf">status</span> command argument to avoid confusing
results.
<!--l. 83--><p class="noindent" >Common options are listed first, followed by options specific to AWS, followed by options specific to AWS&#8217;
on-demand instances, followed by options specific to AWS&#8217; spot instances, followed by options intended for use by
experts.
<!--l. 88--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-68800012"></a>Options</h4>
     <dl class="description"><dt class="description">
<span class="textbf">-help</span> </dt><dd 
class="description">Print a usage reminder.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-setup&#x00A0;</span><span class="textit">[/full/path/to/access/key/file /full/path/to/secret/key/file]</span> </dt><dd 
class="description">Do the first-time setup.<br 
class="newline" />
                                                                                         

                                                                                         
     </dd><dt class="description">
<span class="textbf">-duration&#x00A0;</span><span class="textit">hours</span> </dt><dd 
class="description">Set the maximum lease duration in decimal <span class="textit">hours</span>. After this amount of time, all instances
     will terminated, regardless of their idleness. Defaults to 50 minutes.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-idle&#x00A0;</span><span class="textit">hours</span> </dt><dd 
class="description">Set the maximum idle duration in decimal <span class="textit">hours</span>. An instance idle for longer than this duration
     will terminate itself. Defaults to 15 minutes.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-config-dir&#x00A0;</span><span class="textit">/full/path/to/directory</span> </dt><dd 
class="description">Copy  the  contents  of  <span class="textit">/full/path/to/directory</span>  to  each  instance&#8217;s
     configuration directory.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-owner&#x00A0;</span><span class="textit">owner[, owner]*</span> </dt><dd 
class="description">Configure the annex so that only <span class="textit">owner</span> may start jobs there. By default,
     configure the annex so that only the user running <span class="textit">condor_annex</span> may start jobs there.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-no-owner</span> </dt><dd 
class="description">Configure the annex so that anyone in the pool may use the annex.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-region&#x00A0;</span><span class="textit">region</span> </dt><dd 
class="description">Specify the region in which to create the annex.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-user-data&#x00A0;</span><span class="textit">user-data</span> </dt><dd 
class="description">Set the instance user data to <span class="textit">user-data</span>.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-user-data-file&#x00A0;</span><span class="textit">/full/path/to/file</span> </dt><dd 
class="description">Set   the   instance   user   data   to   the   contents   of   the   file
     <span class="textit">/full/path/to/file</span>.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-default-user-data&#x00A0;</span><span class="textit">user-data</span> </dt><dd 
class="description">Set the instance user data to <span class="textit">user-data</span>, if it&#8217;s not already set. Only
     applies to spot fleet requests.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-default-user-data-file&#x00A0;</span><span class="textit">/full/path/to/file</span> </dt><dd 
class="description">Set the instance user data to the contents of the file
     <span class="textit">/full/path/to/file</span>, if it&#8217;s not already set. Only applies to spot fleet requests.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-instance-type&#x00A0;</span><span class="textit">instance-type</span> </dt><dd 
class="description">This annex will requests instances of type <span class="textit">instance-type</span>.
     The default for v8.7.1 is &#8216;m4.large&#8217;.<br 
class="newline" />
                                                                                         

                                                                                         
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-ami-id&#x00A0;</span><span class="textit">ami-id</span> </dt><dd 
class="description">This annex will start instances of the AMI <span class="textit">ami-id</span>. The default for
     v8.7.1 is &#8216;ami-35b13223&#8217;, a GPU-compatible Amazon Linux image with HTCondor pre-installed.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-security-group-ids&#x00A0;</span><span class="textit">group-id[,group-id]</span> </dt><dd 
class="description">This  annex  will  start  instances  with  the
     listed security group IDs. The default is the security group created by <span class="textbf">-setup</span>.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-key-name&#x00A0;</span><span class="textit">key-name</span> </dt><dd 
class="description">This  annex  will  start  instances  with  the  key  pair  named
     <span class="textit">key-name</span>. The default is the key pair created by <span class="textbf">-setup</span>.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-spot-fleet-config-file&#x00A0;</span><span class="textit">/full/path/to/file</span> </dt><dd 
class="description">Use the JSON blob in <span class="textit">/full/path/to/file</span> for the spot fleet
     request.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-access-key-file&#x00A0;</span><span class="textit">/full/path/to/access-key-file</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-secret-key-file&#x00A0;</span><span class="textit">/full/path/to/secret-key-file</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-ec2-url&#x00A0;</span><span class="textit">https://ec2.&#x003C;region&#x003E;.amazonaws.com</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-events-url&#x00A0;</span><span class="textit">https://events.&#x003C;region&#x003E;.amazonaws.com</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-lambda-url&#x00A0;</span><span class="textit">https://lambda.&#x003C;region&#x003E;.amazonaws.com</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-s3-url&#x00A0;</span><span class="textit">https://s3.&#x003C;region&#x003E;.amazonaws.com</span> </dt><dd 
class="description">Experts only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-spot-fleet-lease-function-arn&#x00A0;</span><span class="textit">sfr-lease-function-arn</span> </dt><dd 
class="description">Developers only.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-lease-function-arn&#x00A0;</span><span class="textit">odi-lease-function-arn</span> </dt><dd 
class="description">Developers only.<br 
class="newline" />
                                                                                         

                                                                                         
     </dd><dt class="description">
<span class="textbf">-aws-on-demand-instance-profile-arn&#x00A0;</span><span class="textit">instance-profile-arn</span> </dt><dd 
class="description">Developers only.<br 
class="newline" /></dd></dl>
<!--l. 145--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-68900012"></a>General Remarks</h4>
<!--l. 147--><p class="noindent" >Currently, only AWS is supported. The AMI configured by setup runs HTCondor v8.6.10 on Amazon Linux 2016.09,
and the default instance type is &#8220;m4.large&#8221;. The default AMI has the appropriate drivers for AWS&#8217; GPU instance
types.
<!--l. 152--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-69000012"></a>Examples</h4>
<!--l. 154--><p class="noindent" >To start an on-demand annex named &#8216;MyFirstAnnex&#8217; with one core, using the default AMI and instance type,
run
                                                                                         

                                                                                         
<div class="verbatim" id="verbatim-995">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_annex</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-count</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;1</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-annex-name</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;MyFirstAnnex</tspan>
</div>
<!--l. 159--><p class="nopar" >
<!--l. 161--><p class="noindent" >You will be asked to confirm that the defaults are what you want.
<!--l. 163--><p class="noindent" >As of 2017-04-17, the following example will cost a minimum of $90.
<!--l. 165--><p class="noindent" >To start an on-demand annex with 100 GPUs that job owners &#8216;big&#8217; and &#8216;little&#8217; may use (be sure to include
yourself!), run
                                                                                         

                                                                                         
<div class="verbatim" id="verbatim-996">
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;condor_annex</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-count</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;100</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-annex-name</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;MySecondAnnex</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;\</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-aws-on-demand-instance-type</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;p2.xlarge</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;-owner</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"big,</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;little"</tspan>
</div>
<!--l. 171--><p class="nopar" >
<!--l. 173--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-69100012"></a>Exit Status</h4>
<!--l. 175--><p class="noindent" ><span class="textit">condor_annex</span> will exit with a status value of 0 (zero) on success.
<!--l. 177--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x99-69200012"></a>Author</h4>
<!--l. 177--><p class="noindent" >Center for High Throughput Computing, University of Wisconsin&#8211;Madison
<h4 class="likesubsectionHead"><a 
 id="x99-69300012"></a>Copyright</h4>
<!--l. 177--><p class="noindent" >Copyright ©&#x00A0;1990-2019 Center for High Throughput Computing, Computer Sciences Department, University of
Wisconsin-Madison, Madison, WI. All Rights Reserved. Licensed under the Apache License, Version 2.0.
                                                                                         

                                                                                         
                                                                                         

                                                                                         
<!--l. 2--><p class="noindent" ><span style="font-size: 200%;"><a 
href="Condoradvertise.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condoradvertise.html#tailCondoradvertise.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condorannex.html" >&#x2191;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="CommandReferenceManualmanpages.html#Condorannex.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condorcheckuserlogs.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><a 
 id="tailCondorannex.html"></a>  
</body></html> 
