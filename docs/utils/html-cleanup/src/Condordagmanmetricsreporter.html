<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>condor_dagman_metrics_reporter</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- 3,sec-filename,next,info,NoFonts,fonts,html --> 
<meta name="src" content="ref.tex"> 
<link rel="stylesheet" type="text/css" href="ref.css"> 
</head><body 
>
<span style="font-size: 200%;"><a 
href="Condordagman.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condordagman.html#tailCondordagman.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="#tailCondordagmanmetricsreporter.html">&#x2193;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="CommandReferenceManualmanpages.html#Condordagmanmetricsreporter.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condordrain.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><h3 class="sectionHead"><a 
 id="x110-76900012"></a><span class="textit">condor_dagman_metrics_reporter</span></h3>
<div class="sectionTOCS">
</div>
<!--l. 2--><p class="noindent" >Report the statistics of a DAGMan run to a central HTTP server
<a 
 id="dx110-769001"></a>
<a 
 id="dx110-769002"></a>
<!--l. 7--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x110-77000012"></a>Synopsis</h4>
<!--l. 7--><p class="noindent" ><span class="textbf"><span class="textit">condor_dagman_metrics_reporter</span></span> [<span class="textbf">-s</span>] [<span class="textbf">-u&#x00A0;&#x00A0;</span><span class="textit">URL</span>] [<span class="textbf">-t&#x00A0;&#x00A0;</span><span class="textit">maxtime</span>] <span class="textbf">-f&#x00A0;</span><span class="textit">/path/to/metrics/file</span>
<!--l. 13--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x110-77100012"></a>Description</h4>
<!--l. 15--><p class="noindent" ><span class="textit">condor_dagman_metrics_reporter</span> anonymously reports metrics from a DAGMan workflow to a central server. The reporting
of workflow metrics is only enabled for DAGMan workflows run under Pegasus; metrics reporting has been requested by
Pegasus&#8217; funding sources: see <a 
href="http://pegasus.isi.edu/wms/docs/latest/funding_citing_usage.php#usage_statistics" >http://pegasus.isi.edu/wms/docs/latest/funding_citing_usage.php#usage_statistics</a>
and <a 
href="https://confluence.pegasus.isi.edu/display/pegasus/DAGMan+Metrics+Reporting" >https://confluence.pegasus.isi.edu/display/pegasus/DAGMan+Metrics+Reporting</a> for the requirements to
collect this data.
<!--l. 23--><p class="noindent" >The data sent to the server is in JSON format. Here is an example of what is sent:
                                                                                         

                                                                                         
<div class="verbatim" id="verbatim-1030">
<tspan font-family="ectt" font-size="1000">{</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"client":"condor_dagman",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"version":"8.1.0",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"planner":"/lfs1/devel/Pegasus/pegasus/bin/pegasus-plan",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"planner_version":"4.3.0cvs",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"type":"metrics",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"wf_uuid":"htcondor-test-job_dagman_metrics-A-subdag",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"root_wf_uuid":"htcondor-test-job_dagman_metrics-A",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"start_time":1375313459.603,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"end_time":1375313491.498,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"duration":31.895,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"exitcode":1,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"dagman_id":"26",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"parent_dagman_id":"11",</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"rescue_dag_number":0,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"jobs":4,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"jobs_failed":1,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"jobs_succeeded":3,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"dag_jobs":0,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"dag_jobs_failed":0,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"dag_jobs_succeeded":0,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"total_jobs":4,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"total_jobs_run":4,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"total_job_time":0.000,</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><tspan font-family="ectt" font-size="1000">&#x00A0;"dag_status":2</tspan>
<tspan font-family="ectt" font-size="1000">&#x00A0;</tspan><br /><tspan font-family="ectt" font-size="1000">}</tspan>
</div>
<!--l. 52--><p class="nopar" >
<!--l. 54--><p class="noindent" >Metrics are sent only if the <span class="textit">condor_dagman</span> process has <span class="texttt">PEGASUS_METRICS</span> set to <span class="texttt">True</span> in its environment, and the
<span class="texttt">CONDOR_DEVELOPERS</span> <a 
 id="dx110-771001"></a><a 
 id="dx110-771002"></a> configuration variable does <span class="emph">not</span> have the value <span class="texttt">NONE</span>.
<!--l. 59--><p class="noindent" >Ordinarily, this program will be run by <span class="textit">condor_dagman</span>, and users do not need to interact with it. This program
uses the following environment variables:
     <dl class="description"><dt class="description">
<span class="texttt">PEGASUS_USER_METRICS_DEFAULT_SERVER</span> </dt><dd 
class="description">The URL of the default server to which to send the data. It
     defaults to <span class="texttt">http://metrics.pegasus.isi.edu/metrics</span>. It can be overridden at the command line
     with the <span class="textbf">-u</span> option.
     </dd><dt class="description">
<span class="texttt">PEGASUS_USER_METRICS_SERVER</span> </dt><dd 
class="description">A comma separated list of URLs of servers that will receive the data, in
     addition to the default server.</dd></dl>
                                                                                         

                                                                                         
<!--l. 72--><p class="noindent" >The <span class="textit">-f </span> argument specifies the metrics file to be sent to the HTTP server.
<!--l. 75--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x110-77200012"></a>Options</h4>
     <dl class="description"><dt class="description">
<span class="textbf">-s</span> </dt><dd 
class="description">Sleep for a random number of seconds between 1 and 10, before attempting to send data. This option is
     used to space out the reporting from any sub-DAGs when a DAG is removed.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-u&#x00A0;</span><span class="textit">URL</span> </dt><dd 
class="description">Overrides  setting  of  the  environment  variable  <span class="texttt">PEGASUS_USER_METRICS_DEFAULT_SERVER</span>.  This
     option is unused by <span class="textit">condor_dagman</span>; it is for testing by developers.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-t&#x00A0;</span><span class="textit">maxtime</span> </dt><dd 
class="description">A maximum time in seconds that defaults to 100 seconds, setting a limit on the amount of
     time this program will wait for communication from the server. A setting of zero will result in a single
     attempt per server. <span class="textit">condor_dagman</span> retrieves this value from the <span class="texttt">DAGMAN_PEGASUS_REPORT_TIMEOUT</span> <a 
 id="dx110-772001"></a><a 
 id="dx110-772002"></a>
     configuration variable.<br 
class="newline" />
     </dd><dt class="description">
<span class="textbf">-f&#x00A0;</span><span class="textit">metrics_file</span> </dt><dd 
class="description">The name of the file containing the metrics values to be reported.<br 
class="newline" /></dd></dl>
<!--l. 95--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x110-77300012"></a>Exit Status</h4>
<!--l. 97--><p class="noindent" ><span class="textit">condor_dagman_metrics_reporter</span> will exit with a status value of 0 (zero) upon success, and it will exit with a
value of 1 (one) upon failure.
<!--l. 101--><p class="noindent" >
<h4 class="likesubsectionHead"><a 
 id="x110-77400012"></a>Author</h4>
<!--l. 101--><p class="noindent" >Center for High Throughput Computing, University of Wisconsin&#8211;Madison
                                                                                         

                                                                                         
<h4 class="likesubsectionHead"><a 
 id="x110-77500012"></a>Copyright</h4>
<!--l. 101--><p class="noindent" >Copyright ©&#x00A0;1990-2019 Center for High Throughput Computing, Computer Sciences Department, University of
Wisconsin-Madison, Madison, WI. All Rights Reserved. Licensed under the Apache License, Version 2.0.
<!--l. 2--><p class="noindent" >
                                                                                         

                                                                                         
                                                                                         

                                                                                         
<!--l. 2--><p class="noindent" ><span style="font-size: 200%;"><a 
href="Condordagman.html" >&#x21D0;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condordagman.html#tailCondordagman.html" >&#x2199;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condordagmanmetricsreporter.html" >&#x2191;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="CommandReferenceManualmanpages.html#Condordagmanmetricsreporter.html" >&#x21D1;</a></span>&nbsp;<span style="font-size: 200%;"><a 
href="Condordrain.html" >&#x21D2;</a></span>&nbsp;<a href="contentsname.html">Contents</a>&nbsp;<a href="indexname.html">Index</a><a 
 id="tailCondordagmanmetricsreporter.html"></a>  
</body></html> 
