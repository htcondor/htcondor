%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-6-7}Development Release Series 6.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of Condor.
The details of each version are described below.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.18}Version 6.7.18}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added a new clipped port of Condor to the SLES 9 distribution of
Linux running on the PPC64 architecture.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug which caused the update proxy command to the
\Condor{schedd} to fail if the job was running and Condor was started
as root.

\item Fixed a bug which was causing jobs to never leave the "run"
state if the \Condor{schedd}'s cron/hawkeye feature is enabled.  This
bug was introduced with the addition of the cron logic to the
\Condor{schedd} in 6.7.8.

\item Improved how the \Condor{gridmanager} reacts to proxy delegation
commands failing for grid-type gt4 jobs. Before, it could end up retrying
the commands every couple seconds. Now, it retries them every 5 minutes.

\item Fixed Condor's code for automatically starting a gridftp server for
grid-type gt4 jobs to work when Condor is started as root.

\item Scheduler universe jobs no longer inherit the environment of the
\Condor{schedd}.

\item Fixed a bug causing jobs to fail to run when submitted from a
6.7.15+ \Condor{schedd} to an older \Condor{starter}.  This problem
only affected jobs with no argument specification in the submit file
or jobs with arguments specified in the new syntax (surrounded by
double quotes).

\item When running grid-type gt4 jobs with an automatically-started
gridftp server, a restart of Condor could cause all of the gt4 jobs to
be canceled and resubmitted due to the gridftp server's port changing.
Now, the old port will be reused when possible.

\item Fixed a bug that could cause the \Condor{gridmanager} to crash
when running grid-type gt4 jobs with an automatically-started gridftp
server.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.17}Version 6.7.17}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The history file, which is a flat file for each submitting
computer that stores information about all jobs completed on that
computer is now rotated automatically. By default, the file will be
rotated when it is more than 20MB and two backup files will be allowed
(for a total of three history files with 60MB of data). This means
that older history will be lost once it is rotated out. You can
disable the history file rotation if you like, and you can change the
number and size of the backup files. \Condor{history} has been updated
to understand these backup history files. 

\item Added parallel universe support to \Condor{dagman} (\Condor{dagman}
can now handle submit files that submit more than one Condor job proc).

\item Added a \Opt{-format} option to the \Condor{history} command which
behaves just like the -format option to \Condor{status} and \Condor{q}
commands.

\item Added remove and get\_job\_attr options to the \Condor{chirp}
command line tool.  Changed parallel universe script to use them.

\item When the Grid Monitor encounters problems, Condor no longer tries
to restart the Globus JobManagers for all of the affected grid universe
jobs. Restarting the JobManagers can easily bring down a remote headnode.
Condor will attempt to restart the Grid Monitor, but there will be
no update of job status in the mean time. 

\item When started as root on a Linux 32-bit x86 machine, Condor daemons will
leave core files in the log directory when they crash.  Recent changes to the
Linux kernel default to blocking these core files.  This change means
Condor behaves more consistently across different Unix-like operating systems.

\item Made several changes to make Condor-G much less likely to overload a
pre-WS GRAM server for grid-type gt2 jobs. Added configuration parameter
GRIDMANAGER\_MAX\_JOBMANAGERS\_PER\_RESOURCE, which limits the number of
globus-job-manager processes Condor will let run on the server at a time.
Streaming of output for gt2 jobs is disabled if
GRIDMANAGER\_MAX\_JOBMANAGERS\_PER\_RESOURCE isn't set to unlimited.
If the Grid Monitor encounters problems, the \Condor{gridmanager} doesn't
restart the globus-job-managers of the affected jobs. Fixed a couple bugs
in the Grid Monitor that could cause it to spawn extra polling processes
on the server.

\item Added support for Parallel scheduling groups for the parallel
universe.  This is useful if you have machines connected by infiniband
switches, and want to constrain your parallel jobs to never run across
two different switches.

\item Added a new suite of tools to dynamically deploy Condor.  The
most important of these tools are \Condor{cold\_start} and
\Condor{cold\_stop}. Another significant subset of this suite are
tools to determine whether a process is alive or dead.  The most
advanced of which are the \Prog{uniq\_pid\_midwife} and
\Prog{uniq\_pid\_undertaker}.  Currently these programs are only
supported on Linux.

\item Added \Macro{MAX\_JOB\_QUEUE\_LOG\_ROTATIONS} to control how
many historical job queue logs are kept when the job queue log is
rotated.  These historical logs are used by Quill to avoid missing
information in Quill's job history information when the schedd rotates
to a new log.  The default value for this configuration setting is 1,
so one old copy of the job queue log file will be kept.

\item Added support for DRMAA on the Mac OSX platform.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Previously, the \Condor{startd} would not recompute the
  \Attr{CurrentRank} attribute each time a new job was spawned, but
  only computed it whenever a new claim was made.
  Now, the \Condor{startd} correctly recomputes \Attr{CurrentRank}
  each time a new job starts running.

\item When running a gridftp server for grid-type gt4 jobs, Condor will now
start the server so as to ignore /etc/grid-security/gridftp.conf and
\$GLOBUS\_LOCATION/etc/gridftp.conf. These files may contain options that
would cause the gridftp server to fail when not run as root.

\item Fixed a bug where jobs using the grid (or globus) universe that specified
an AccountingGroup would never run because the \Condor{gridmanager} would fail
to start.

\item Fixed a bug introduced in 6.7.14 where the job attributes RemoteUserCpu 
and RemoteSysCpu were incorrectly reported as 0 in the history file and the job queue
for non-standard universe jobs.

\item Fixed a physical memory reporting bug for the Mac OSX port of Condor.

\item Since the addition of the ``new'' cron syntax (introduced in
version 6.7.11), the \Condor{startd} has (silently) ignored any jobs
defined with the ``old'' syntax if any jobs are defined with the
``new'' syntax.  Now, the \Condor{startd} will honor both definitions,
but will log a warning to it's log file if any jobs with the ``old''
syntax are found (whether or not any new jobs are found).
The \Condor{schedd} (which also has the ``cron'' logic) will behave in
the same way.

\item The bug which was causing the ``Cron'' job command lines to have
the name added each invocation has been fixed.

\item Fixed some messages about keyboard and mouse idle time had been logged
too often in the \Condor{startd} logs under certain conditions to be logged
less often.

% Gnats PR 589
\item Fixed the \Opt{-dag} option to \Condor{q}.  Previously, this did not
print DAG node names as it should have.  (This bug has existed since
approximately v6.7.11.)

\item Enabled COLLECTOR\_QUERY\_WORKERS in the default
\Condor{collector} configuration, and set this value to 16.  Note this
COLLECTOR\_QUERY\_WORKERS has no effect on non-UNIX systems (Windows).

\item Fixed a bug that could cause the \Condor{gridmanager} to crash
if the GridJobId attribute for a gt2 job became mangled. The cause of
mangling seen by some users is still unknown.

\item Submission from 6.7.15 or 6.7.16 \Condor{submit} to a 6.7.14 or
earlier \Condor{schedd} was not working unless the submit file
explicitly set both arguments and environment using the old syntax.
Now \Condor{submit} automatically converts the environment and
argument syntax when necessary.  If the conversion is not possible,
due to limitations in the old syntax, \Condor{submit} will generate
an error message and refuse to complete the submission.

\item \Condor{submit} now returns an error if the executable file
specified in the submit file exists but is zero length.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

% Gnats PR 617.
\item Multi-cluster condor submits will cause \Condor{dagman} to hang.
This bug was introduced by the implementation of parallel universe
support.  Prior to version 6.7.17, any Condor submit file creating
more than one Condor process would be treated as an error by
\Condor{dagman}.  Now this is not the case, because a single cluster
with multiple processes will work; but \Condor{dagman} does
not deal properly with multi-cluster submits (e.g., a submit file
queuing jobs with different executables).
(Bug introduced in version 6.7.17.)

% Gnats PR 618.
\item The \Opt{-maxjobs} and \Opt{-maxidle} settings for \Condor{dagman} are
inconsistent: maxjobs applies to job clusters, but maxidle applies
to individual processes.  Note that this only makes any difference
in the case of node submit files that queue more than one process,
which has only been supported since version 6.7.17.
(Bug introduced in version 6.7.17.)

% Gnats PR 619.
\item \Condor{dagman} does not properly handle failures when removing
jobs for a failed node.  Note that this only makes any difference
in the case of node submit files that queue more than one process,
which has only been supported since version 6.7.17.  If one process
for a node fails, the entire cluster is considered failed, and any
other processes in that cluster are removed.  If removing the processes
fails, \Condor{dagman} may hang, waiting for those processes to abort.
(Bug introduced in version 6.7.17.)

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.16}Version 6.7.16}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Support for running a personal Condor on Windows using
\Condor{master} \Opt{-f}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Support for NorduGrid jobs was accidentally left out of the
\Condor{gridmanager} in previous releases. This has been corrected.

\item The \Condor{starter} was refusing to run jobs if it could not
perform a reverse-DNS lookup of the submit-host.  Now that this is
fixed, when the reverse-DNS lookup fails, the job can still run, but
Condor will not be able to verify the authenticity of the
submit-hosts's uid domain.  In this case, if you enable
\Macro{TRUST\_UID\_DOMAIN}, everything will function as normal, minus
the verification of the domain; if you do not enable
\Macro{TRUST\_UID\_DOMAIN}, the starter will treat the job as being
from a different uid domain, regardless of what uid domain the job
advertises.

\item Fixed a few bugs with \AdAttr{transfer\_output\_remaps} that caused
files to be remapped while in a temporary sandbox. Now, the remapping
occurs only when the files are returned to the job submitter.

\item Fixed some minor memory leaks in the \Condor{gridmanager}.

\item Fixed a bug in 6.7.15 that was causing startd cron jobs to fail to run
if the old-style configuration setting \Macro{STARTD\_CRON\_JOBS} was used
instead of the new-style configuration setting \Macro{STARTD\_CRON\_JOBLIST}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The command line string used in starting \Prog{cron} jobs is correct
the first time the job is run,
but incorrect each subsequent time the job is run.
The error is that the job's name is incorrectly appended to the
previous run's command line.
As an example, the first time the job is run with the correct command line
\begin{verbatim}
/path/to/job jobname
\end{verbatim}
The second time, this job is run with the incorrect command line 
\begin{verbatim}
/path/to/job jobname jobname
\end{verbatim}
And, the third time, this job is run with the incorrect command line
\begin{verbatim}
/path/to/job jobname jobname jobname
\end{verbatim}

% Gnats PR 607/admin RUST 13153.
\item On Windows only (as far as we know) a \Condor{rm} of a scheduler
universe job after a \Condor{qedit} may cause the schedd to crash.
(This bug has existed at least since 6.7.12.)

% Gnats PR 612/admin RUST 13153
\item On Windows only (as far as we know) a \Condor{hold} followed by a
\Condor{release} on a job sometimes results in the job being removed
instead of going into the idle state.  (This bug has existed at
least since 6.7.12.)

% Gnats PR 608/admin RUST 13231.
\item On Windows only, \Condor{dagman} may fail with a "DLL not
initialized" error (exit code -1073741502).  (This bug has existed at
least since 6.7.12.)

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.15}Version 6.7.15}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item If you have not used the undocumented configuration setting
\Macro{SIGNIFICANT\_ATTRIBUTES}, there is no need to read the rest of
this paragraph.  For sites that have been using
\Macro{SIGNIFICANT\_ATTRIBUTES} in the config file, we suggest
removing that setting, because Condor now automatically selects the
list of attributes that are used to cluster job ClassAds into distinct
ads for negotiation.  In 6.7.15, any setting of
\Macro{SIGNIFICANT\_ATTRIBUTES} will be combined with the automated
list of attributes that Condor produces.  In the future, this behavior
may change (e.g. it might override the automated behavior rather than
combining with it).  If you know in advance that your use of Condor
heavily depends on \Macro{SIGNIFICANT\_ATTRIBUTES} \emph{not}
including some attributes that \emph{are} used in requirements
expressions (e.g.  ImageSize), then you should be aware that 6.7.15
provides \emph{no} way for you to suppress such attributes.  In
that case, we recommend that you wait for this issue to be addressed
before upgrading.
This should not concern most users--especially anyone who is not even
using \Macro{SIGNIFICANT\_ATTRIBUTES}, or who has defined
\Macro{SIGNIFICANT\_ATTRIBUTES} to include all attributes that are
used in requirements expressions (which is the normal usage case).

\item Added a clipped port of Condor to YellowDog Linux 3.0 on the
PowerPC architecture.

\item ``Cron'' jobs defined with the ``old'' configuration syntax
(usually through ``STARTD\_CRON\_JOBS'' or ``HAWKEYE\_CRON\_JOBS'' --
see the \Condor{startd} manual section for more details) are broken.
Using the ``new'' syntax (``STARTD\_CRON\_JOBLIST'') will work around
this problem.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item For those platforms which support it, libcondorapi.so is now
produced and available in the lib/ directory after installing Condor.

\item The negotiation protocol between the \Condor{schedd} and
the \Condor{negotiator} daemons has been improved for both scalability and
correctness.  In general, most sites will see faster negotiation 
cycles when many jobs are submitted after upgrading both the negotiator
and all schedd daemons to version 6.7.15.  This means the scheduling overhead
per job is reduced.  If you have used the undocumented macro
\Macro{SIGNIFICANT\_ATTRIBUTES}, please read the note above in the release
notes, because this new automated behavior affects the use of that
configuration setting--in most cases making it unnecessary.

\item Due to kernel bugs between the Linux 2.4.x and 2.6.x kernels,
Condor now implements "checkpointing signatures" which allow more fine
grained and automatic control over whether or not a particular machine
is willing to resume a previously created checkpoint. This functionality
is homogenized across all platforms which provide the standard universe
feature set.

\item Grid matchmaking ads are now aged and replaced by the negotiator 
based on a configurable classad expression from the condor config file. This
configuration parameter is called \Macro{STARTD\_AD\_REEVAL\_EXPR}.  
In previous versions, this was done strictly based on the 
UpdateSequenceNumber field in the ad.  The default value for the new 
parameter behaves the same as the older, hard-coded algorithm.

\item Condor can now dynamically start its own gridftp server to handle
file transfers for grid-type gt4 jobs. The gridftp server appears
as a job in the queue and disappears when it's no longer needed.

\item Automatic renewal of job proxies from a MyProxy server now works for
all grid universe jobs. Before, it only worked for grid-type gt2 jobs.

\item \Condor{dagman} now reports to its POST scripts uniquely
distinguishable return codes for non-exe job failures (e.g.,
\Condor{dagman}, batch-system, or other external errors such as failed
batch job submission, or batch job removal).  In the past these errors
were reported as various signals (e.g., SIGABRT for job removal or
SIGUSR1 for failed job submission), making it impossible to
distinguish them from the real signals as which they were
masquerading.  We now represent these errors using the
previously-unused return-code space below -64 (we start below -1000,
in fact).  As before, 0-255 reflect normal exe return codes, and -1 to
-64 represent signals 1 to 64 -- but now -1000 and below represent
DAGMan, batch-system, or other external errors.

\item Added the \Macro{DAGMAN\_RETRY\_NODE\_FIRST} configuration macro to
\Condor{dagman} to control whether failed nodes are retried before
or after other ready nodes.  The default is FALSE (\Condor{dagman}'s
previous behavior), which means that failed nodes will be retried
after other ready nodes.

\item Added a new (backward compatible) syntax for job arguments and
environment, allowing special characters to be escaped in a uniform
way.  The old limit of 4096 characters in the job arguments has also
been removed.  See \Condor{submit} manual for details of the new
syntax.

\item Added more configuration parameters to the \Condor{master}'s
restart / backoff mechanism.  You can now configure the initial value
of the backoff time (via \Macro{MASTER\_BACKOFF\_CONSTANT}).
Additionally, you can now set daemon specific values for all of these
parameters.  See the \Condor{master} entry in the manual for more
details.

\item \Condor{userprio} now supports \Opt{-setaccum} \Opt{-setbegin} 
\Opt{-setlast}  options to set the Accumulated Usage, Begin Usage Time, and
Last Usage time of a submitter. This is in addition to the existing
\Opt{-setprio} and \Opt{-setfactor} options.
These options can be used to safely reconstruct priority information if
the only backup data available is the output from \Condor{userprio} \Opt{-l}

\item An updated DRMAA version is available on supported platforms.  The 
previous DRMAA implementation has been removed.

% Gnats PR 248, new per-job Stork user logs.
% Implicitly added PR 278, which requires Stork user logs to
% be owned by user, and not Stork server daemon.  Implicitly added PR 572, now
% Stork user logs use standard Condor user log API.
\item Added new per-job Stork user logs.  Stork user logs are now optional, and
specified in the job submit file.  Stork now uses Condor user log output
format, including optional XML format.  Previous, per-server Stork user log in
\File{LOG/Stork.user\_log} is now deprecated, and will be removed in a future
release.

\item \Condor{dagman} now supports the new, per-job Stork user logs.
"Old-style" Stork logs (specified with \Opt{-Storklog} on the
\Condor{submit\_dag} command line) are supported for now, but this
support will probably be eliminated in the 6.7.16 release.

% Gnats PR 600.
\item Added new per-job Stork input, output and error output file
specifications.  Stork job output is now optional, and
specified in the job submit file.  Previous, per-server Stork user log in 
\File{LOG/Stork-module.stderr} and \File{LOG/Stork-module.stdout} has been
removed.

\item The Condor installer for Windows is now MSI compliant.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Configuration parameters \Macro{LOWPORT} and \Macro{HIGHPORT} are
now respected for ports created for interaction with Globus GRAM servers.

\item \Condor{status} \Opt{-any} now reports quill ads when quill is enabled.

\item \Condor{restart} \Opt{-peaceful} was causing \Condor{master} to only
do a graceful shutdown, rather than a peaceful one.  This means that
\Macro{GRACEFUL\_SHUTDOWN\_TIMEOUT} would come into effect if jobs running
under the startd took too long to finish.  However, \Opt{-peaceful} restart
did work in the case where a specific subsystem (e.g. \Opt{-startd}) was
specified.

% Gnats PR 588
\item When run from a privileged (root) Stork server, modules lose
\Macro{LD\_LIBRARY\_PATH} and other key environments, for security
reasons.  This is not actually a Stork bug, but a feature of glibc.
When run with a dynamically linked \File{globus-url-copy}, the
contributed modules for the HTTP, FTP and GSIFTP transfer protocols
will fail.  To compensate, these modules can now restore their
environment via the pre-existing \Macro{STORK\_ENVIRONMENT}
configuration macro.  Unprivileged (user level) Storks are not
affected by this behavior.

\item  Jobs that are are placed on held because of \AdAttr{on\_exit\_hold}
evaluated to TRUE or jobs that stay in the queue after finishing because
\AdAttr{on\_exit\_remove} evaluated to FALSE again correctly report the
expression as being a "job attribute", not "UNKNOWN (never set)".

\item \Condor{glidein} was creating a default configuration with
\Macro{UPDATE\_INTERVAL}=20, which causes unnecessary scaling problems in large
glidein pools.  It now simply leaves this value undefined so that
the default behavior may be assumed.

\item Fixed a bug that could cause the \Condor{gridmanager} to crash when
a grid-type condor grid universe job left the queue.

\item When using job leases with the condor grid-type, a completed job will
now leave the remote \Condor{schedd}'s queue when the lease expires.

\item Fixed a bug in the \Code{fullpath()} function that tests whether
a file path is a full path -- paths of the form \File{"c:/"} were not
recognized as full paths, which could lead to something being prepended
to what was already a full path, thereby creating an invalid path.

\item Fixed a problem with \AdAttr{WhenToTransferOutput}=ALWAYS.  The
bug affected jobs that were evicted after producing one or more
intermediate files that were removed by the job before finally running
to completion in a subsequent run.  Condor was treating the missing
intermediate files as an error and the job would typically keep
running and failing until the user intervened.  In addition to fixing
this bug, file transfer error messages are now propagated back to the
shadow log and the user log, making it easier to debug problems
related to file-transfers.

\item \Condor{submit} was not paying attention to
\AdAttr{transfer\_output\_remaps} when doing permissions checks on
output files.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The command line string used in starting \Prog{cron} jobs is correct
the first time the job is run,
but incorrect each subsequent time the job is run.
The error is that the job's name is incorrectly appended to the 
previous run's command line.
As an example, the first time the job is run with the correct command line
\begin{verbatim}
/path/to/job jobname
\end{verbatim}
The second time, this job is run with the incorrect command line
\begin{verbatim}
/path/to/job jobname jobname
\end{verbatim}
And, the third time, this job is run with the incorrect command line
\begin{verbatim}
/path/to/job jobname jobname jobname
\end{verbatim}


\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.14}Version 6.7.14}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The Condor grid universe can now be used to submit jobs to
Nordugrid and Unicore resources.

\item The Condor daemons now automatically restart when the
system clock jumps more than 20 minutes in either
direction.  This may happen if the machine running Condor entered
a "sleep" state.  This resolves a variety of minor problems.

\item Added a \Arg{-direct} debugging option to \Condor{q} which, when
using or querying a quill installation, allows talking directly to the
rdbms, the quill daemon, or the schedd without performing the queue
location discovery algorithm.

\item \Condor{schedd} provides more flexibility in how local and
scheduler universe jobs are started. The new configuration macros
\Macro{START\_LOCAL\_UNIVERSE} and \Macro{START\_SCHEDULER\_UNIVERSE}
allow administrators to control whether \Condor{schedd} will start
an idle local or scheduler universe job. If a job's respective universe
macro evaluates to true, \Condor{schedd} will then evaluate the 
\Macro{Requirements} expression for the job. Only if both conditions are
met will a job be allowed to begin execution.

\item \Condor{schedd} advertises how many local and scheduler
universe jobs are currently running or idle in its ClassAd. The
total number of running jobs is denoted by the
\Attr{TotalLocalJobsRunning} and \Attr{TotalSchedulerJobsRunning}
attributes. The total number of idle jobs is denoted by the
\Attr{TotalLocalJobsIdle} and \Attr{TotalSchedulerJobsIdle}.

\item A job submission can now specify the exact time that it should be
executed at using the \Attr{DeferralTime} attribute. The time is specified
as the number seconds since the Unix epoch (00:00:00 UTC, Jan 1, 1970).
An additional attribute \Attr{DeferralWindow} can be specified along with
the deferral time that will allow a job to run even if it misses the
execution time. The window is the number of seconds in the past that
Condor will allow for a missed job to execute. This feature is not 
supported for scheduler universe jobs.

\item Added the concept of a ``controlling'' daemon to the
\Condor{master}.  This feature is currently used only for ``High
Availability'' (HA) configurations involving the \Condor{had} daemon.
To properly use these Condor HA features you must set this macro.  

To configure the \Condor{negotiator} daemon to be controlled by the
\Condor{had}, you should add an entry to your condor\_config:

\begin{verbatim}
MASTER_NEGOTIATOR_CONTROLLER = HAD
\end{verbatim}

This will cause the \Condor{master} to treat the \Condor{had} as the
``controller'' of the \Condor{negotiator}.

\item Grid-type condor grid universe jobs now respect configuration
parameters \Macro{GRIDMANAGER\_MAX\_PENDING\_SUBMIT\_PER\_RESOURCE} and
\Macro{GRIDMANAGER\_MAX\_SUBMITTED\_JOBS\_PER\_RESOURCE}.

\item Grid universe jobs can now determine their \SubmitCmd{grid\_type}
via matchmaking,
in addition to which resource they will be submitted to.
A \SubmitCmd{grid} universe job may become any \SubmitCmd{grid\_type} job,
depending on what resource ad it is matched with.

\item Added support for a new configuration value,
  \Macro{STARTD\_CRON\_AUTOPUBLISH}.
  This setting can be used to tell the \Condor{startd} to
  automatically publish a new update to the \Condor{collector}
  whenever any of the \Term{cron} modules it is configured to run have
  produced output.
  For more information, see the description of
  \MacroNI{STARTD\_CRON\_AUTOPUBLISH} in
  section~\ref{param:StartdCronAutopublish} on
  page~\pageref{param:StartdCronAutopublish}. 

\item Reduced delay in negotiation when a job is released.  A reschedule
request is sent to the negotiator when a job is released from hold.  This
reduces the delay in several cases, most notably when using Condor-C or
"condor\_submit -s".  Previously the negotiator would not be notified and
would normally wait until the next scheduled negotiation cycle.

\item Added three new user log events: GridResourceUp, GridResourceDown,
and GridSubmit. They are equivalent to the existing Globus-specific log
events, but are used for all grid universe jobs.

\item When known, CPU-usage information will be reflected in the Terminated
user log event for grid universe jobs.

\item Changed ClassAd expression evaluation so that logical and and
logical or are short-circuited. This means that an expression like
\verb@TARGET.foo && TARGET.bar@ will not evaluate \verb@TARGET.bar@
if \verb@TARGET.foo@ evaluates to false. This will speed up some
expressions, particularly those involving user-defined
functions. Although this was thoroughly tested, this is the sort of
change that could have subtle, unexpected behavior, so please be on
the lookout for problems that might be caused by it. 

\item Added the \Condor{check\_userlogs} command, which checks user log
files for "illegal" events.

\item New settings
\Macro{SYSTEM\_PERIODIC\_HOLD},
\Macro{SYSTEM\_PERIODIC\_RELEASE}, and
\Macro{SYSTEM\_PERIODIC\_REMOVE}.
These expressions behave identically to the job expressions
\AdAttr{periodic\_hold},
\AdAttr{periodic\_release}, and
\AdAttr{periodic\_remove}, but are evaluated for all jobs in the
queue.  If not present, they default to FALSE.

\item An improved version of the DRMAA C library is available for download from
\URL{http://prdownloads.sourceforge.net/condor-ext/condor\_drmaa\_6\_7\_14\_src.tgz}

\item Added \Macro{CLAIM\_WORKLIFE} configuration option.  The startd
will not allow claims older than the specified number of seconds to
run more jobs.  Any existing job that is running when the worklife expires,
however, is allowed to continue to run as normal.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed the following problems with the Condor SOAP interface: a) placing a
job on hold now stops the job as expected, b) fixed potential schedd segfaults
when sending NULL buffers via SOAP, c) fixed compatibility problems with .NET
clients

\item Fixed a potential security problem where any machine in the pool
  could advertise an additional \Condor{negotiator} in the pool.
  Now, the \Condor{collector} will only accept negotiator classads
  from machines listed in the \Macro{HOSTALLOW\_NEGOTIATOR} variable.
  This bug has been in Condor since version 6.7.4.

\item Fixed bug in the dedicated scheduler where on busy pools
running mixed parallel and sequential jobs, it would incorrectly 
try to preempt dedicated jobs.

\item Fixed some problems when Microsoft .NET clients communicate with Condor
via SOAP. The issues were resolved by upgrading the version of gsoap included
inside of Condor to gsoap ver 2.7.6c.

\item Fixed the bug in the \Condor{ckpt\_server} from version 6.7.13
  where it would give clients the wrong IP address and no
  checkpointing was possible.
  This would result in the following sorts of errors in the log file
  generated by the \Condor{shadow} (by default, \File{ShadowLog}):
\footnotesize
\begin{verbatim}
Read: connect() failed - errno = 111
Read: open_tcp_stream() failed
Read: ERROR:open_ckpt_file failed, aborting ckpt
\end{verbatim}
\normalsize
  Version 6.7.14 of the \Condor{ckpt\_server} is working properly once
  again. 

\item Fixed bugs in Condor's Generic Connection Broker (GCB) support.
  Condor version 6.7.14 is linked with a new version of the GCB
  library (1.3.1) that fixes a major bug in how GCB handles UDP
  messages.
  Previous versions of GCB had a UDP receive buffer that was far too
  small, resulting in many dropped UDP packets.
  Now, GCB will dynamically allocate more buffer space as needed.
  The new version of GCB also adds support for comments (any line
  beginning with \verb@#@) in the GCB routing table.
  For more information about GCB, see section~\ref{sec:GCB} on
  page~\pageref{sec:GCB}. 

\item Update job information such as ImageSize, RemoteUserCpu and RemoteSysCpu 
at job completion.  Previously this was only done periodically.

\item Fixed a bug that could cause the \Condor{gridmanager} to crash when
a job using job leases left the queue.

\item Fixed a bug that could cause the \Condor{schedd} to repeatedly start
the \Condor{gridmanager} to manage jobs that were complete. This would
happen when LeaveJobInQueue evaluated to True.

\item When \Macro{GSI\_DAEMON\_TRUSTED\_CA\_DIR} is set, pass the setting
down to the gt4 gahp server.

% Gnats PR 518
\item Fixed a bug in \Condor{dagman} that caused the UNLESS-EXIT
feature to not work with POST scripts (the return value from a POST
script was not tested against the UNLESS-EXIT value).

% Gnats PR 469
\item Fixed a bug in \Condor{dagman} that caused POST scripts to work
incorrectly with node retries:  if the node job failed for a node
with retries, the POST script was only run on the last retry.

% Gnats PR 582
\item Fixed a bug in \Condor{dagman} that caused rescue DAGs to fail
if the original DAG was run with the \Opt{-UseDagDir} command-line flag.
(This bug was introduced at some point after version 6.7.10 and before
version 6.7.13.)

\item Improved usage of uid caching introduced in 6.6.0.  This will
further reduce load on NIS servers.  See the discussion of
\MacroNI{PASSWD\_CACHE\_REFRESH} in
section~\ref{param:PasswdCacheRefresh} on
page~\pageref{param:PasswdCacheRefresh} for more details.

\item Fixed a bug in 6.7.13 for Windows causing incorrect handling of
absolute paths in the job's output/error if the path began with a
forward slash rather than a backslash.

\item Fixed a bug in the \Condor{master} that caused ``condor\_off
-subsystem'' (and similar commands) to fail if the daemon name wasn't
hard-coded into the \Condor{master}.  The \Condor{master} now handle
any daemon listed in the \Macro{DAEMON\_LIST} for these commands.

\item Fixed a bug in the \condor{gridmanager} that caused it to undercount
already-submitted jobs at start-up for purposes of job throttling to Globus
grid resources.

\item Improved the handling of job leases for grid-type condor jobs. There
was a race condition between the lease expiring and the
\Condor{gridmanager} attempting to extend the lease. Also, a lease could
be set and not extended well before the job was actually submitted. In
certain cases, the forwarded lease could exceed \Attr{JobLeaseDuration}.

\item The startd no longer advertises itself as available to run jobs
when it is in shutdown mode (e.g. waiting for jobs to finish).  This
was a noticeable problem when using large values for
\Macro{MaxJobRetirementTime} on multi-VM startds; while waiting for
one of its VMs to finish running a job, the startd would be available
for matching to jobs, but it would reject them when the schedd tried
to start them, possibly causing an endless cycle of matching, attempting
to run, and failing.

\item Fixed some minor typos and formatting bugs in some of the log
  messages generated by the \Condor{ckpt\_server}.

\item For grid-type condor jobs, the \Condor{gridmanager} now notices
when a job disappears from the remote \Condor{schedd} unexpectedly.

\item When getting ``connection refused'', Condor command-line tools
and daemons no longer continuously retry the connection attempt until
timing out.  These retries were causing 10 second or longer delays
when trying to connect to Condor services which, for one reason or
another, were no longer listening on the expected TCP port.

\item Fixed a bug in the \Condor{c-gahp} that could cause it to crash
if it fails to connect to a remote \Condor{schedd} when submitting a
job.

\item Minor memory leaks have been fixed.

\item Fixed a bug in Quill that could result in an infinite loop in
\Condor{q} when querying Quill.

\end{itemize}

\noindent Changes:

\begin{itemize}

\item The \Condor{dagman} log file path is converted to an absolute
path inside \Condor{dagman} itself, so that the logging works for
multi-directory rescue DAGs (which it didn't before), but the
\File{.condor.sub} files are still portable.

\item Added the Stork log file (if any) to the list of log files that
\Condor{dagman} lists in the dagman.out file.

\item \Condor{dagman} now reports the node return value for all failed
nodes.

\item Attributes names forced into the job ad via '+' are no longer
converted to lower-case. This conversion was a side-effect of a bug-fix
in 6.7.11 and caused problems with code that assumed that Condor would
preserve the case of attribute names.

\item Job policy expressions are now evaluated on COMPLETED and REMOVED
jobs in the schedd.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The \Macro{NEGOTIATOR\_MATCHLIST\_CACHING} setting is broken.
  It should not be used.
  This setting is \verb@FALSE@ by default, but if set to \verb@TRUE@,
  the \Condor{negotiator} will crash.  

\item Jobs that are are placed on held because of \AdAttr{on\_exit\_hold}
evaluated to TRUE or jobs that stay in the queue after finishing because
\AdAttr{on\_exit\_remove} evaluated to FALSE will erroneously report the reason
as "UNKNOWN (never set)".

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.13}Version 6.7.13}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Added a new natively compiled clipped port for the Red Hat
Enterprise Linux 3 IA64 distribution.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added support complete support for Quill on Windows, so job queues can
now be accessed via a relation database.  Quill is now available on all Condor
supported platforms.  See page~\pageref{sec:Quill} for more information.

\item Added support in Condor for the Generic Connection Broker
  (GCB).
  This is a system for managing network connections across public and
  private networks.
  More information about GCB can be found in section~\ref{sec:GCB} on
  page~\pageref{sec:GCB}.

\item Added a new configuration option, \Macro{BIND\_ALL\_INTERFACES}
  This is a boolean value that controls if Condor should bind and
  listen to all the network interfaces on a multi-homed machine.
  If set to TRUE, the value of \Macro{NETWORK\_INTERFACE} will only
  control what IP address is published by Condor daemons, even though
  they will still be listening on all interfaces.
  The default is FALSE.

\item Added a \Opt{-pool} option to \Condor{submit}. It lets you submit
jobs to a \Condor{schedd} in a different pool. The other options to
\Condor{submit} now have long names, but the single-character versions
still work.

\item ``grid\_resource'' can now be used to directly set the new grid
universe job attribute ``GridResource.'' The old attributes still work,
but they will be ignored if ``grid\_resource'' is present. As a
side-effect, ``stream\_output'' and ``stream\_error'' will default to
``False'' for all jobs.

\item X509 user proxies are now updated for vanilla universe jobs.   If
a job specifically sets x509userproxy and is using file transfer, when
the proxy file is updated, it will be transfered to the running job.

\item If a  cycle is detected in the DAG while 
running, \Condor{dagman} now prints (in the \File{dagman.out} file)
the status of all DAG nodes.

\item BeginTransaction call in \Condor{schedd}'s SOAP interface now
  notifies the caller if too many transactions are currently running
  via an error code of FAIL. Previous behavior was to abort a running
  transaction in order to allow the BeginTransaction call to succeed.
  
\item \Macro{MAX\_SOAP\_TRANSACTION\_DURATION} config option added so that a
  single transaction cannot take up too many \Condor{schedd}
  resourced. This option specifies an optional maximum duration
  between SOAP calls in a single transaction.

\item If a machine is acting as both a submit and an execute node, and it
  cannot communicate with the central manager, it will attempt to run jobs
  locally.  If Condor specific terms, if the \Condor{schedd} fails to hear
  from the central manager, it will attempt to run jobs on a locally running
  \Condor{startd}.  The \Condor{SCHEDD\_ASSUME\_NEGOTIATOR\_GONE} config
  macro was added to support this feature; see
  page~\pageref{param:ScheddAssumeNegotiatorGone} for details.

\item You can now specify per-subsystem entries in your condor\_config file
by prepending the subsystem name and a period to the normal name.  The
per-subsystem settings take precedence over the regular settings.

\item \Condor{dagman} now recovers automatically after being abruptly
killed by something other than Condor itself (e.g., by Unix initd
during a ``fast'' system shutdown).  This is accomplished through the
use of a default \Attr{OnExitRemove} expression inserted by
\Condor{submit\_dag} which instructs the \Condor{schedd} not to treat
death by SIGKILL as a valid exit condition for \Condor{dagman}.

\item Added submit attribute \SubmitCmd{globus\_xml}, for use with grid-type
gt4 jobs. The given XML text will be inserted at the end of the XML job
description written by Condor for submission to the WS-GRAM server.

\item For grid-type gt4 jobs, if a URL scheme is missing from the resource
name, ``https://'' will be inserted automatically.

\item Added submit attribute \SubmitCmd{transfer\_output\_remaps}.
This specifies the name (and optionally path) to use when downloading output
files from the completed job.  Normally output files are transferred back
to the initial working directory with the same name they had in the execution
directory.  This gives you the option to save them with a different path
or name.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug concerning backslash escaping in classad attribute values
	when \Condor{q} was using quill.

\item Fixed a bug where \Condor{q} could not accept multiple jobids
	on the command line.

\item Fixed parallel universe ssh script to now clean up all
temporary files it creates.

\item Fixed a bug in the dedicated scheduler that caused it to request
resources it could not use, resulting in longer job startup times.

\item Fixed a bug in the \Condor{schedd} that caused grid-type gt2 jobs
submitted by an older \Condor{submit} or in the queue during an upgrade
(version 6.7.10 or earlier) to go
on hold if the grid\_type was ``globus''.

\item Fixed a bug in \Condor{submit} that caused it to not set 
\Attr{JobGridType} in the job ad for grid universe jobs when submitting
to a \Condor{schedd} older than version 6.7.11.

\item When using file transfer, transferring the results back to
the submit machine could silently fail for Condor releases 6.7.0
though 6.7.12.  This was relatively rare through 6.7.10.  For
6.7.11 and 6.7.12, the bug would be easily triggered if a vanilla
job had an X509 user proxy associated with it.  This is now
fixed.

\item Fixed a logic bug in the \Condor{schedd}.
  Previously, if there was an error expanding any \verb@$$(attribute)@
  references in a job classad when trying to spawn a \Condor{shadow},
  the \Condor{schedd} would die with the fatal exception ``Impossible:
  GetJobAd() returned NULL for X.Y but that job is already known to
  exist''.
  Now, the \Condor{schedd} correctly distinguishes between a non-fatal
  error expanding \verb@$$(attribute)@ and the fatal error of the job
  already being gone (which is, in fact, impossible).
  This bug was first introduced in Condor version 6.7.1.

\item The reason strings generated when a user job policy expression fires
are now consistent for grid universe jobs.

\item The \Condor{gridmanager} now evaluates the periodic job policy
expressions at the interval set by \Macro{PERIODIC\_EXPR\_INTERVAL}.

\item Fixed a bug which prevented standard universe from working on a linux 
kernel post 2.6.12.2.


\item The \Condor{schedd} used to crash in certain cases if a given
  job was vacated using \Condor{vacate\_job}, then put on hold and
  released.
  The bug only appeared if a specific job id was given to
  \Condor{vacate\_job}, as opposed to specifying a username or another
  constraint.
  Now, the use of \Condor{vacate\_job} for individual job identifiers
  is safe and the \Condor{schedd} will not crash.
  This bug has been in Condor since support for \Condor{vacate\_job}
  was first added in version 6.7.0.

\item Fixed a bug that caused the \Condor{gridmanager} to crash if a
grid-type condor job ad contained the attribute \Attr{remote\_}.

\item Fixed a bug with the FS\_REMOTE authentication mechanism that caused
it to fail occasionally when using NFS.

% Gnats PR 553:
\item Fixed a bug in which a double terminated event in a DAG node with
a POST script could cause \Condor{dagman} to abort the DAG and claim
that a cycle exists in the DAG.

% Also related to Gnats PR 553:
\item In the DAG status messages in \File{dagman.out} files,
\Condor{dagman} now shows nodes with queued PRE or POST scripts
in the Pre or Post columns.  Previously, these nodes were shown
in the Un-Ready column.

\item Fixed the GetFile SOAP call on the \Condor{schedd} so that it
  behaves more like POSIX read() and does not report errors when
  trying to read more data than is available.

% Gnats PR 557:
\item Fixed a hash function bug that could cause \Condor{dagman}
to crash.

\item \Attr{JobCurrentStartDate} and \Attr{JobLastStartDate} are no longer
changed in the job ad when the \Condor{schedd} and \Condor{shadow} reconnect
to a running job after a crash.

% Gnats PR 554:
\item \Condor{dagman} now allows POST scripts to be used with DATA
nodes in a DAG (previously this caused the DAG to hang).

\item Using the new \SubmitCmd{Remote\_} simplified syntax no longer
generates unnecessary debug messages.

% Quill
\item Fixed a bug in estimating the size of attribute value buffers that
caused quill to crash.  This arose when job ads had variables with very
large values (more than 3KB).  

\item Fixed a bug in the \Condor{gridmanager} that could cause it to crash
when the \Attr{Rematch} attribute evaluates to True.

% http://bugzilla.globus.org/globus/show_bug.cgi?id=3802
% http://bugzilla.globus.org/globus/show_bug.cgi?id=3803
\item The default base scratch directory for WS-GRAM doesn't exist on most
server machines. Added a work-around to create the directory as part of the
job submission.

\item Starting in version 6.7.11, the execute host reported for grid jobs
in the user log execute event can contain spaces. The C++ user log reading
code now properly reads the entire string for these events.

\item Fixed a bug that caused the \Condor{gridmanager} to die when it 
tried to renew the job lease of a grid-type condor job.

\item Fixed a bug that was causing the \Condor{schedd} to crash on Solaris
if the cron macros aren't defined.

\item Fixed a bug where output may be lost when spooling (with the -s option to
\Condor{submit} or implicitly with Condor-C).  This bug could only happen if
the job terminated within one second of starting.

\item Fixed a bug affecting transferral of output and error files where the
file specified in the submit file contains path information.  The file
was being staged back into the initial working directory and then it was
copied to the final path specified.  The bug is that if there was an error
copying the file to the final location, the intermediate copy would not
be deleted and the job would still exit successfully, as though it had
succeeded.  Now, no intermediate copy of the file is made, and errors
in transferring the file will be treated as a failure to run the job,
which will typically cause the job to return to idle state and run again.

\end{itemize}

\noindent Changes:

\begin{itemize}

\item Added a couple missing parameters to the example configuration file
\File{condor\_config.generic}.

\item Slightly cleaned up event checking error messages in \Condor{dagman}.

\item Fixed a bug in the \Condor{c-gahp} that caused it to crash when
handling grid-type condor jobs with job leases.

\item Starting in 6.7.11, the ``JM-Contact'' field of the ``Job submitted
to Globus'' user log event was mis-printed. This has been corrected.

% Gnats 565
\item Fixed bug that prevented Stork detection of hung jobs.

% Gnats 562
\item Fixed an obscure bug that incorrectly quoted the status of completed
jobs, visible via \Stork{status}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item The \Condor{ckpt\_server} is broken in version 6.7.13.
Please do not attempt to use it.
It is safe to use the 6.7.12 \Condor{ckpt\_server} in a pool running
6.7.13 until the 6.7.14 release is out.
Of course, the 6.7.12 \Condor{ckpt\_server} will not work with GCB, so
sites wishing to use both GCB and a \Condor{ckpt\_server} will have to
wait for 6.7.14.

% Gnats PR 582:
\item Rescue DAGs generated from DAGs run with the
\Opt{-UseDagDir} command-line flag no longer work.
(The original run with \Opt{-UseDagDir} should work,
but if it fails and generates a rescue DAG, the
rescue DAG will \emph{always} fail.)

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.12}Version 6.7.12}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item 6.7.12 addresses several critical bugs in 6.7.11.  6.7.11 should 
not be used.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a serious bug introduced in 6.7.11 which prevented \Condor 
{dagman} from successfully removing its own jobs from the Condor  
queue after receiving a \Condor{rm} request from the \Condor{schedd}.

\item Fixed a serious bug introduced in 6.7.11 where the \Condor{master} 
on Windows would not properly shut down.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7.11}Version 6.7.11}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor is now linked against GSI from Globus 4.0.1.

\item GSI security and the grid universe should now work in the Alpha 
Linux port.

\item All Condor release packages are now compressed with GNU's
  \Prog{gzip}.
  We no longer ship releases compressed with the vendor's
  \Prog{compress} utility.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added a new feature called \Bold{Quill} to Condor which allows an
        SQL server to mirror the job queue in order to speed up queries about
        the job queue via \Condor{q} and \Condor{history}. Please see 
        page~\pageref{sec:Quill} for the description of this feature.

\item \Condor{dagman} has a new \Opt{-maxidle} command-line argument
that can be used to throttle DAG job submissions according to the number
of idle jobs in the DAG.

\item \Stork{submit} is now able to search for X.509 credentials in the
standard locations.

\item The \Condor{negotiator} can now limit how long it negotiates with a 
single submitter before moving on to the next one. 

\item On platforms and filesystems that support files larger than 2
GB, the history file can now be larger than 2 GB.

\item Added two options to \Condor{q}: \Opt{-jobads} and
  \Opt{-machineads}. They will take ads from files instead of the
  schedd and collector, respectively. These options are mostly useful
  for debugging. 

\item Added a new, hopefully less confusing, Cron (Hawkeye)
configuration syntax.  The old syntax is still supported, but should
be considered deprecated, and will eventually go away.  The new syntax
splits the old colon separated ``name:prefix:executable:period''
string into separate macros.

\item Improved support for job leases. ``job\_lease\_duration''  now works for
grid-type condor jobs. New job ad attribute ``TimerRemove'' specifies a
specific time at which a job should be removed. These attributes will be 
passed through multiple layers of grid-type condor jobs.

\item Grid universe jobs now use a unified pair of attributes 
(``GridResource'' and ``GridJobId'') to identify the remote resource. This
will make it possible to match jobs to multiple types of resources. The
submit file syntax remains the same for now, except that ``remote\_pool'' is
now required for grid-type condor jobs.

\item Significantly improved response time for \Condor{q} when job classads
are larger than 4 kbytes (by disabling TCP Nagle algorithm as appropriate).

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

% posting that belongs in 6.7.12 manual
%\item Fixed a bug which prevented standard universe from working on a linux 
%kernel post 2.6.12.2.

\item Fixed bug in the dedicated scheduler where if the \Condor{startd} 
rejected a match, the \Condor{schedd} would never retry new matches 
for that machine.  This would result in MPI and parallel jobs sticking 
in the Idle state, and the message "DedicatedScheduler::negotiate sent 
match for machine, but we've already got it".

\item Fixed problem with the parallel universe to allow for LAM jobs
to get SIGTERM on exit so they can exit cleanly.

% condor-support #1419
\item Fixed a bug that was visible to the end user as file transfer
  failures on a busy system.
  The root problem was that if the \Condor{negotiator} gave out the
  same match twice (due to having stale info in the \Condor{collector}
  when trying to negotiate), the \Condor{schedd} would be confused,
  attempt to re-use the match, fail to do so, and then kill the
  previous (legitimate) use of the match.
  This bug was introduced in version 6.7.4.

\item Fixed bug in the parallel universe that caused the schedd to
crash when reconnecting to jobs that couldn't be reconnected to.

\item Fixed bug in parallel shadow which caused Shadow Exceptions
in parallel jobs when the components exited in the wrong order.

% Gnats PR 534.
\item Fixed a bug in \Condor{dagman} that caused it to fail on Windows
for DAGs with nodes having absolute paths to their log files.  (This bug
was introduced in version 6.7.10.)

% Gnats PR 492.
\item Fixed a bug whereby \Condor{dagman} could crash after executing
the POST script of a node whose Condor job had never been successfully
submitted due to repeated \Condor{submit} failures.  (This bug was
introduced in 6.7.7 or earlier.)

\item Fixed a bug in a debug message.  If an error occurred during file
transfer, Condor would print the wrong expected filesize in the error message
on some platforms.

\item Fixed bug where \Stork{submit} was corrupting log notes passed from the
command line.  This bug also had the effect of disabling Stork jobs running
from DAGMan versions v6.7.10, and later.

% Gnats PR 525.
\item If you have DATA nodes in your DAG but no Stork log specified
(with the \Opt{-Storklog} argument),
\Condor{dagman} now fails with an explanatory message when parsing
the DAG file(s). (Previously, it would just wait forever for the Stork
jobs to finish, because it wouldn't see the relevant events.)

\item In \Condor{dagman}, argument quoting for \Stork{submit} now matches
argument quoting for \Condor{submit}.

\item Corrected how \Condor{submit} handles attributes forced into the
job ad with '+'. Now, the attribute names are case-insensitive, they 
are not treated as normal submit attributes, and they always over-ride 
normal submit attributes.

\item Fixed bugs that would cause a segfault when reading a classad from
a file. Triggered by consecutive blank lines and lines containing only
white-space.

\item Fixed a bug that could cause duplicated output when a gt4 grid job 
is executed more than once.

\item Fixed a bug that could cause the \Condor{gridmanager} to assert if 
it tried to delegate credentials for gt4 grid jobs before the gahp server 
was started.

\item Fixed a race condition that could cause condor grid-type jobs to be
held with hold reason ``Spooling input data files''.

\item \Condor{glidein} now correctly handles extracting necessary
information from modern Condor configurations where
\MacroNI{NEGOTIATOR\_HOST} is not defined.

% Programmer explanation:
% MANAGED is no longer boolean in the job ad, it's
% a string of complex state.  This enables the gridmanager
% to no longer erroneously take control of jobs that are
% done but haven't left the queue.
\item Refinements in how grid universe components track jobs.  Grid universe
jobs are less likely to generate multiple terminate events in the job's user
log.  There will also be slight performance improvements are redundant work 
is no longer done.

% Gnats PR 542
\item Fixed a bug in \Condor{dagman} that caused it to core dump on
a 'job reconnected' event from a node job.

\item \Condor{submit} will now exit zero as long as the submission succeeds.  Debugging output will still be printed if the internal reschedule fails.

% RUST condor-support #1402
\item On Windows, exited child processes of the Condor services
will be handled in order of termination.  This fixes the problem where jobs
submitted from a Windows machine appear to run much longer than normal
because the \Condor{schedd} fails to notice that a \Condor{shadow} exits
when the system is very busy.

% Gnats PR 532
\item Fixed a bug that caused scheduler universe jobs to often wait five
minutes (or whatever \MacroNI{SCHEDD\_INTERVAL} is set to) before running.

\item Fixed a bug that prevented the \Condor{starter} from running on a
Win32 machine with a FAT32 filesystem.

\item A reschedule command will now be sent to the \Condor{schedd} whenever
a job is released from held state. This should make grid-type condor jobs
start much faster.

\item Config parameters \MacroNI{GAHP} and \MacroNI{GAHP\_ARGS} have been
deprecated. \MacroNI{GT2\_GAHP} should be used instead.

\end{itemize}

\noindent Changes:

\begin{itemize}

\item \Condor{configure} no longer creates a
\begin{verbatim} $(LOCAL_DIR)/ViewHist \end{verbatim}
directory, which was begun in version 6.7.10.  This directory was of limited
value for most users.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-10}Version 6.7.10}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.10.

\item The Mac OS X binaries shipped with this release were built on OS
  10.3.  Previous versions of Condor for OS X were built with version
  10.2.  Condor is officially dropping support for Mac OS 10.2 with
  this release (though it is possible the 10.3 binaries still work, we
  have not verified it either way).  These binaries are known to work
  with Mac OS 10.4 (``Tiger''), as well.

\item There is a minor bug in version 6.7.10's \Condor{configure}
  script.
  It will create a directory called \File{ViewHist} in the local
  directory (next to \File{log}, \File{spool}, etc).
  This directory is not used by Condor at all, except in the case of a
  \Condor{view} collector (which is optional, and not enabled by
  default). 
  This behavior will be removed in version 6.7.11, and
  \Condor{configure} will go back to not creating the \File{ViewHist}
  directory.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item \Condor{dagman} can now run multiple DAGs in separate directories.


\item Added \Macro{DAGMAN\_CONDOR\_SUBMIT\_EXE},
\Macro{DAGMAN\_STORK\_SUBMIT\_EXE}, \Macro{DAGMAN\_CONDOR\_RM\_EXE},
and \Macro{DAGMAN\_STORK\_RM\_EXE} configuration settings to specify
the \Condor{submit}, \Stork{submit}, \Condor{rm}, and \Stork{rm}
executables used by \Condor{dagman}.  If unset (which they are by
default), \Condor{dagman} looks for each in the PATH.

\item For Condor-C jobs, the \Condor{gridmanager} will retry and delay
  failed connections to a remote \Condor{schedd} like it does for
  Condor-G jobs. The same configuration settings apply 
  (\Macro{GRIDMANAGER\_CONNECT\_FAILURE\_RETRY\_COUNT} and
  \Macro{GRIDMANAGER\_RESOURCE\_PROBE\_INTERVAL}).

\item \SubmitCmd{remote\_initialdir} is now supported in all universes except
for standard universe.  Previously, it was only supported in the grid universe.

\item \SubmitCmd{+Remote\_} syntax for Condor-C jobs has been
simplified for the specific commands of
\SubmitCmd{universe}, \SubmitCmd{remote\_schedd}, \SubmitCmd{remote\_pool}, \SubmitCmd{globus\_rsl}, and \SubmitCmd{globus\_scheduler}.

\item Added default user priority factors for accounting groups.  More on
        accounting groups will be available in future versions of the manual.

\item The \Condor{startd} can now be configured to write out the
  \Attr{ClaimId} of the next available claim for each virtual machine
  to separate files.
  This functionality will enable enhanced fault tolerance in future
  versions of Condor.
  For more information, see section~\ref{param:StartdClaimIdFile} for
  details on \Macro{STARTD\_SHOULD\_WRITE\_CLAIM\_ID\_FILE} and
  \Macro{STARTD\_CLAIM\_ID\_FILE}, the two configuration settings that
  control this behavior.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed bugs on the Win32 platform in the \Condor{schedd} that could
cause jobs to never complete when the \Condor{schedd} is busy with many jobs
running at once.

\item Fixed a bug on Windows where if lots of jobs submitted were from
  the same \Condor{schedd}, some of the \Condor{shadow} processes
  would block for an extremely long time trying to get a lock for
  writing to the \File{ShadowLog} file.
  Now, log writing happens more fairly, and no \Condor{shadow}
  processes can be delayed indefinitely.

\item \Condor{submit} \Opt{-name} formerly had no effect on Windows and
did not work properly. This is now fixed.

\item Significantly sped up the removal of large groups of jobs by
changing the default value of \MacroNI{JOB\_IS\_FINISHED\_INTERVAL} from 1
to 0 (see section~\ref{param:JobIsFinishedInterval} for details on this
setting).

\item Improved performance of the \Condor{schedd} when not running as
  root.
  In version 6.7.7, the new code to support the scheduler universe
  with Condor-C involved adding some additional overhead to the
  \Condor{schedd}.
  However, this overhead is not needed unless the \Condor{schedd} is
  running as root.
  In version 6.7.10, the \Condor{schedd} notices if it is not root and
  does an optimization to avoid the overhead.

\item Fixed a bug that caused the gridmanager to crash if a gt2, gt3, or
gt4 grid job had a proxy that couldn't be read properly. Now the job gets
put on hold.

\item The Condor-C GAHP now performs file staging in a 
separate process, allowing remote grid jobs to be started earlier.

\item When contacting the embedded web server on Condor daemons,
  authentication is no longer requested.
  The previous authentication requirement didn't provide any
  additional security, and could confuse users.

\item Fixed rare bug that could cause \Condor{submit} to crash when
  both getenv=true and environment=... were in a submit file and when
  very large variable names were in the environment. 

\item Fixed a rare bug where the \Condor{schedd} would die with a
  fatal exception under extremely heavy load on the machine.
  The error message was:
\begin{verbatim}  
  ERROR ``Impossible: Create_Thread child_errno (xxx) is not
  ERRNO_PID_COLLISION!'' at line 6181 in file daemon_core.C
\end{verbatim}  

\item Fixed a rare bug where certain attributes in a job description
  file could cause the \Condor{schedd} to crash when restarting and
  parsing the \File{job\_queue.log} file.

\item Improved performance of standard universe jobs when
  \Attr{WantRemoteIO} is set to false in the job ClassAd.  
  In this case, Condor's checkpointing libraries now avoid some
  additional communication with the \Condor{shadow} which are not
  required if there's no remote IO.

\item Fixed some messages in the Condor log files that were improperly
  formatted, or contained incomplete information.

\item Improved some user-log-reading error messages in \Condor{dagman}.

\item Removed support for deprecated \Opt{-NoPostFail} option from
\Condor{dagman}.  (The same functionality can be achieved through the
use of a simple POST script.)

\item Fixed bug in dedicated scheduler, where under heavy load, the
  schedd would occasionally try to start the same job twice, and
  subsequently exit with the message:
\begin{verbatim}  
  ERROR ``Trying to run job x.x, but already marked RUNNING!''
\end{verbatim}  

\item Fixed bug in dedicated scheduler, so that it now creates a 
  spool directory for each condor proc of a parallel or MPI job
  with multiple requirements.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

% Gnats PR 534.
\item On Windows only, \Condor{dagman} fails for DAGs with
nodes having absolute log file paths in their submit files.

% Gnats PR 492.
\item \Condor{dagman} does not correctly handle the case where all
submit attempts for a node job fail, and the node has a POST script.
If this happens for a single node in a DAG, it is usually okay,
but if it happens for a second node, \Condor{dagman} will crash.

\item The Condor-C GAHP now performs file staging in a 
separate process, allowing remote grid jobs to be started earlier.

\item Using the new \SubmitCmd{Remote\_} syntax simplification causes
\Condor{submit} to display debug messages to standard output, possibly
confusing programs that parse \Condor{submit}'s output.  Fixed in 6.7.13.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-9}Version 6.7.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.10.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The Parallel Universe has been added.
  For more information, see section~\ref{sec:Parallel} on
  page~\pageref{sec:Parallel}.


\item 
\index{environment variables!X509\_USER\_PROXY}
\index{X509\_USER\_PROXY}
The environment variable \Env{X509\_USER\_PROXY} is set to the
full path of the proxy if a proxy is associated with the job.
This is usually done using \SubmitCmd{x509userproxy} in the submit file.
This currently works in the local, java, and vanilla universes.

\item \Condor{submit} generates more precise error messages in 
some failure cases.

\item \Condor{hold}, \Condor{release} and \Condor{rm} now allow the user
to change the HoldReason, ReleaseReason or RemoveReason with the -reason
flag.

\item \Condor{dagman} no longer does a one-second sleep before each
submit if all node jobs have the same log file.  (The sleep is still
needed if there are multiple log files, for unambiguous ordering of
events during bootstrapping.)  Note that if \MacroNI{DAGMAN\_SUBMIT\_DELAY}
is specified, the specified delay takes effect whether or not all
jobs have the same log file.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Many crashes related to running the Dedicated Scheduler have
been fixed.

\item Setting COLLECTOR\_HOST or NEGOTIATOR\_HOST with a port but without
a hostname no longer causes the \Condor{master} to crash.

\item The Condor-G Grid Monitor now works with Globus 4.0 pre-Web Services
GRAM.

\item Several deadlocks in the Condor-C GAHP server have been fixed.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-8}Version 6.7.8}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Controlling whether or not a standard universe job asks the
\Condor{shadow} about how/where to open every single file can be better
controlled with the \Attr{want\_remote\_io} attribute in the submit
description file.
This attribute can be set to true or false and it is true be default.
If set to false, then this attribute forces a standard universe job in 
Condor to always look to the local file system when opening files and not
to contact the shadow. 
This increases performance of user jobs where the jobs open a very large
amount of files in a small space of time.
However, the user jobs must be matched to machines that have the same
UID\_DOMAIN and FILESYSTEM\_DOMAIN, as per vanilla universe jobs with a 
homogeneous file system.

\item \Condor{dagman} now has the capability to run more than one
independent DAG in a single \Condor{dagman} process.

\item User policy expressions (on\_exit\_remove and on\_exit\_hold)
now work for scheduler universe jobs.

\item TotalCpus and TotalMemory are now set in machine ads.

\item \Condor{dagman} now tolerates the "two terminated events for
a single job" bug by default.  There is a new bit in
\MacroNI{DAGMAN\_ALLOW\_EVENTS} to control whether this bug is considered
a fatal error in a \Condor{dagman} run.

\item Added a new debug formatting flag, \Dflag{PID}, that prints out
  the process id (PID) of the process writing a given entry to a log
  file.
  This is useful in Condor daemons (such as the \Condor{schedd}) where 
  the daemon can fork() multiple processes to perform various tasks
  and it is helpful to see what log messages are coming from forked
  process versus the main thread of execution.
  The default \Macro{SCHEDD\_DEBUG} in the sample configuration files
  shipped with Condor now includes this flag.

\item When \Condor{dagman} writes rescue files, each node is now
specified with the same number of retries as was specified in the
original DAG, rather than with only the ``remaining'' number of
retries based on the failed run.  The latter behavior can be restored
by setting \Macro{DAGMAN\_RESET\_RETRIES\_UPON\_RESCUE} to false.

\item Added ``Hawkeye'' capabilities to \Condor{schedd}.  It's
configured identically to that of \Condor{startd}, but using 
``SCHEDD'' in place of ``STARTD'', in particular for the
``SCHEDD\_CRON\_NAME'' macro.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

% See Gnats PRs 297 and 430.
\item Fixed a bug in \Condor{dagman} that prevented POST scripts
from being used with jobs that write XML-format logs.

\item The event-checking code used by \Condor{dagman} now defaults
to allowing an execute event before the submit event for the same
job; if this happens, there will be a warning, but the DAG will
continue.  See section~\ref{param:DAGManAllowEvents} for more info.

\item \Condor{userprio} option \Opt{-pool} was failing with ``Can't
find address for negotiator'' since version 6.7.5.

\item Fixed a bug the prevented SOAP clients from being able to access
a job's spooled data files if the \Condor{schedd} restarted.

\item Fixed a bug that caused the \Condor{gridmanager} to panic when
trying to retire a job from the queue that was already gone. This
could cause multiple terminate events to be logged for some jobs.

\item Fixed a bug that caused match-making to not work for Condor-C
jobs.

\item Added workaround for a Globus bug that can cause re-execution of
a completed GT2 job in the correct failure case (Globus bugzilla ticket
3411).

\item Properly extend the lifetime of GT4 jobs and credentials on the
remote server.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-7}Version 6.7.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The \Expr{STARTD\_EXPRS} list can now be on a per-VM basis, and
entries on the list can also be specific to a VM. 
See ~\ref{sec:SMP-exprs} for more details.

\item The \Macro{LOCAL\_CONFIG\_FILE} can now be overridden. 
This now allows files to include other local config files. 
See ~\ref{param:LocalConfigFile} for more info.

\item Resources that are claimed but suspended can now optionally 
not be charged for at the accountant. 
When the resource is unsuspended, the accountant will resume charging
for usage. 
This is controlled by the \Expr{NEGOTIATOR\_DISCOUNT\_SUSPENDED\_RESOURCES}
config file entry, and it defaults to false.

\item The \Attr{DAGManJobID} attribute which \condor{dagman} inserts
into the classad of every job it submits now contains only its cluster
ID (instead of a cluster.proc ID pair), so that it may be referenced
as an integer in DAG job submit files.  This allows, for example, a
user to automatically set the relative local queue priority of jobs
based on the \condor{dagman} job that submitted them, so that jobs
submitted by ``older'' DAGs will start before jobs submitted by
``newer'' DAGs (assuming they are otherwise identical).

\item GSI authentication can now be used when Condor-C jobs are submitted
from one \condor{schedd} to another.

\item File permissions are now preserved when a job's data files are
transferred between unix machines. File transfers that involve a windows
machine or older version of Condor remain as before.

\item Condor-C now supports the scheduler remote universe.

\item \condor{advertise} now publishes a ``MyAddress'' if none is provided
in the source ClassAd.  This will prevent the collector from throwing out
ads with no address (see Bugs Fixed).

\item Added a new \Condor{dagman} parameter \MacroNI{DAGMAN\_ALLOW\_EVENTS}
controlling which ``bad'' events are not considered fatal errors;
the \Opt{-NoEventChecks} command-line argument is deprecated and has no effect.

\item \Condor{fetchlog} now takes an optional log file extension in order to
select logs such as ``StarterLog.vm2''.

\end{itemize}


\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a throughput performance bottle neck when standard universe
        jobs vacate when the user has specified \Attr{WantCheckpoint} equal to
        False in the submit file.

\item Added initial support for the \Syscall{getdents},
        \Syscall{getdents64}, \Syscall{glob}, and the family of functions
        \Syscall{opendir}, \Syscall{readdir}, \Syscall{closedir} for the
        standard universe.  

        It is recommended that you do not directly invoke \Syscall{getdents} 
        or \Syscall{getdents64}, but instead use the other POSIX functions
        specified above.

        There are two caveats: these calls will not work in heterogeneous
        contexts, and you may not call \Syscall{getdents} directly when 
        \Condor{compile}ing a 32-bit program while specifying the 64-bit
        interfaces for the Unix API.

\item In versions 6.7.4 through 6.7.6, Computing On Demand (COD)
  support was broken due to a bug in how Condor daemons parsed their
  command line arguments.
  The bug was introduced with the changes to provide a web services
  (SOAP) interface to Condor.
  This bug has been fixed and COD support is now working again.

\item In version 6.7.6, the \MacroNI{DAGParentNodeNames} attribute
which \Condor{dagman} adds to all DAG job classads could grow too long
and cause job submission to fail.  Now, if the
\MacroNI{DAGParentNodeNames} value would be too long to add to the job
classad, the attribute is instead left undefined and a warning is
emitted in the DAGMan debugging log.  This behavior means that such a
node can be reliably distinguished from a node with no parents, as the
latter will have a \MacroNI{DAGParentNodeNames} attribute defined but
empty.

\item In version 6.7.3, the value of the X509UserProxySubject job attribute
was changed in such a way that Condor-G jobs submitted by a newer
\condor{submit} to an older \condor{schedd} could fail to run. Now,
\condor{submit} reverts to the old behavior when talking to an old
\condor{schedd}.

\item Bug-fixes and improvements to grid\_type gt4:

  \begin{itemize}

  \item Condor will now delegate a single proxy to the GT4 server for
  multiple. If the local proxy is refreshed, Condor will forward the
  refreshed copy to the server.

  \item Exit codes are now recorded properly.

  \item \Macro{JAVA\_EXTRA\_ARGUMENTS} now used when invoking the GT4 GAHP
  server (which is written in java).

  \item If \Macro{LOWPORT} and \Macro{HIGHPORT} are set in the config file,
  the GT4 GAHP server will now obey the port restriction.

  \item Fixed a bug that caused Condor not to notice when some GT4 jobs
  completed.

  \item Fixed a bug in handling the job's environment for GT4 jobs. Condor
  incorrectly used ``<name>=<value>'' for each variable's name.

  \item Improved hold reason in certain cases when a GT4 job goes on hold.

  \item \condor{q} -globus now works properly for GT4 jobs. Also, the resource
  name in the user log execute event is printed properly for GT4 jobs.

  \item Fixed a bug that could cause Condor to not detect when a GT4 job
  completes. This was triggered by Condor not properly recognizing the
  StageOut Globus job state.

  \end{itemize}

\item Fixed a bug that can cause the \condor{gridmanager} to abort if
\Attr{PeriodicRelease} evaluates to true while it's putting a job on hold.

% See Gnats PR 470
\item Fixed a bug in \Condor{dagman} that
caused the DAG to be aborted if a job generated an executable error
event.

\item Fixed a bug in \Condor{dagman} on Windows that would cause it to
hang or crash on exit.

\item MPI universe jobs now honor the \Attr{JOB\_START\_DELAY}
configuration setting.

\item The \Condor{collector} now throws out startd, schedd, and License
ClassAds that don't have a valid IP address (used in it's hashing).  The
collector now correctly will fall back to ``MyAddress'' if it's provided.

% See Gnats PR 479.
\item Fixed a bug in \Condor{dagman} that could cause \Condor{dagman}
to fail an assertion if PRE or POST scripts are throttled with the
\Opt{-maxpre} or \Opt{-maxpost} \Condor{submit\_dag} command line flags.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-6}Version 6.7.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.6 contains all the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added support for libc's \Syscall(system) function for standard
        universe executables. This call is not checkpoint-safe in that
        the standard universe job could call it twice or more times
        in the event of a resumption from an earlier checkpoint. The
        invocation of this call by the shadow on behalf of the user
        job is controlled by a configuration file parameter called
        \Attr{SHADOW\_ALLOW\_UNSAFE\_REMOTE\_EXEC} and is off by default.
        The full environment of the user job is preserved during the
        invocation of \Syscall(system) and this might cause problems in 
        heterogeneous submission contexts of the user is not careful.

\item Added support for a web services (SOAP) interface to Condor.
  For more information, see and section~\ref{API-WebService} on
  page~\pageref{API-WebService}.

  \Note Due to a bug in gSOAP, the SOAP support in Condor 6.7.6 does
  not work with all SOAP toolkits.
  Some of the responses that gSOAP generates contain unqualified tags.
  Therefore, SOAP toolkits that are strict (such as gSOAP or .Net)
  will not accept these poorly formed responses.
  SOAP toolkits that are more lax in the responses they accept (such
  as Axis, SOAP::Lite, or ZSI) will work with version 6.7.6.
  This problem has already been fixed and the solution will be
  released in Condor version 6.7.7.

\item Added support for the GT4 grid\_type in Condor's grid universe.
  This new grid type supports jobs submitted to grid resources
  controlled by Globus Toolkit version 4 (GT4).

  New configuration settings are required to support jobs
  submitted for the GT4 grid type.
  These settings have been added to the default configuration files
  shipped with Condor, but sites that are upgrading an existing
  installation and choosing to keep their old configuration files must
  add these settings to allow GT4 jobs to work:
\begin{verbatim}
## The location of the wrapper for invoking GT4 GAHP server
GT4_GAHP = $(SBIN)/gt4_gahp
 
## The location of GT4 files. This should normally be lib/gt4
GT4_LOCATION = $(LIB)/gt4

## gt4-gahp requires gridftp server. This should be the address of gridftp
## server to use
GRIDFTP_URL_BASE = gsiftp://$(FULL_HOSTNAME)
\end{verbatim}

\item Condor version 6.7.6 includes the Stork data movement system, 
  the Condor Credential Daemon (\Condor{credd}), and support for using
  MyProxy for credential management.
  However, currently these are only supported in our release for Linux
  using the 2.4 kernel with glibc version 2.3 (RedHat 9, etc).
  All of these features require changes to the Condor configuration
  files to function properly.
  The default configuration files shipped with Condor already include
  all the new settings, but sites upgrading an existing installation
  must add these new settings to their Condor configuration.
  For a list of settings and more information, see
  section~\ref{sec:Stork-Config-File-Entries} on 
  page~\pageref{sec:Stork-Config-File-Entries} for Stork,
  section~\ref{sec:Credd-Config-File-Entries} on
  page~\pageref{sec:Credd-Config-File-Entries} for \Condor{credd},
  and section~\ref{sec:MyProxy-Config-File-Entries} on
  page~\pageref{sec:MyProxy-Config-File-Entries} for MyProxy.
  For more information about MyProxy, you can also see  
  \URL{http://grid.ncsa.uiuc.edu/myproxy}

\item Added preliminary support for the High Availability Daemon (HAD).

\item Added a new \MacroNI{SCHED\_UNIV\_RENICE\_INCREMENT}
configuration variable used by the \Condor{schedd} for scheduler
universe jobs, analogous to the existing
\MacroNI{JOB\_RENICE\_INCREMENT} variable used by the \Condor{startd}
for other job universes.  The \MacroNI{SCHED\_UNIV\_RENICE\_INCREMENT}
variable is undefined by default, and when undefined, defaults to 0
internally.

\item The relative priority of a user's own jobs in the local
\condor{schedd} queue is no longer limited to the range -20 to +20,
but can be any integer value.

\item DAGMan Improvements:

\begin{itemize}

  \item \Condor{dagman} now inserts a \MacroNI{DAGParentNodeNames}
  attribute into classad of all Condor jobs it submits, containing the
  names of the job's parents in the DAG.  The list is in the form of a
  comma-delimited string.

  \item Added the \Condor{dagman} arguments \Opt{-noeventchecks} and
  \Opt{-allowlogerror} to \Condor{submit\_dag}.

\end{itemize}

\item \Condor{glidein} Improvements:

\begin{itemize}

  \item Added \Condor{glidein} options for setting up GSI authentication.

  \item Added \Condor{glidein} option {-run\_here} for direct
  execution of Glidein, instead of submitting it for remote execution.
  You may also save a script for doing this and then run the script
  through whatever mechanism you want (like some batch system
  interface not supported by Condor-G).

\end{itemize}

\item Added support for the \Macro{NEGOTIATOR\_CYCLE\_DELAY}
  configuration setting, which is only intended for expert
  administrators.
  For more information, see section~\ref{param:NegotiatorCycleDelay}
  on page~\pageref{param:NegotiatorCycleDelay}.


\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Previous versions of the \Condor{master} had a bug where if the
  administrator attempted to use \Macro{SUBSYS\_ARGS} to pass \Opt{-p}
  to any Condor daemon to have it listen on a specific, fixed port,
  the underlying daemon would not honor the flag.
  Now, the \Condor{master} correctly supports using
  \Macro{SUBSYS\_ARGS} to define a port using \Opt{-p}.
  For more information about \Macro{SUBSYS\_ARGS}, see
  section~\ref{param:SubsysArgs} on page~\pageref{param:SubsysArgs}.

\item Removed case-sensitivity of command-line argument names in
\Condor{submit\_dag}.

\item Fixed the {-r} (remote schedd) option in \Condor{submit\_dag}.

\item Condor versions 6.7.1 through 6.7.5 exhibit a bug in
  which the commands \Condor{off}, \Condor{restart}, and
  \Condor{vacate} did not handle the \Opt{-pool} command-line option
  correctly.
  The bug caused these commands to correctly query the central manager
  of the remote pool,
  and to incorrectly send the command to the central manager machine.
  This bug has now been fixed, and these tools no longer send
  the command to the central manager machine.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-5}Version 6.7.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  This was 6.7.4, but we took 6.7.4 away and replaced it quickly
%  with 6.7.5
\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added DAG aborting feature -- a DAG can be configured to
abort immediately if a node exits with a given exit value.

\item The dedicated scheduler can now preempt running MPI jobs from 
appropriately configured machines. See 
~\ref{sec:Configure-Dedicated-Preemption} for details.

\item The MPI universe now supports submit files with multiple procs (queue 
commands), each with distinct requirements.  This is useful for placing
the head node of an MPI job on a specific machine, and the rest of the 
nodes elsewhere. See ~\ref{sec:MPI} for details.

\item The \Condor{negotiator} now publishes its own ClassAd to the
  \Condor{collector} which includes the IP address and port where it
  is listening.
  This negotiator ClassAd can be viewed using the new
  \Opt{-negotiator} option with \Condor{status}.
  In addition to removing an unnecessary fixed port for the
  \Condor{negotiator}, this change corrects some problems with
  commands that attempted to communicate directly with the
  \Condor{negotiator}.
  These bugs were first listed in the Known Bugs section of the 6.6.0
  version history.

  To enable this feature and have the \Condor{negotiator} listen on a
  dynamic port, you must comment out the \Macro{NEGOTIATOR\_HOST}
  setting in your configuration file.
  The new example configuration files shipped with version 6.7.4 and
  later will already have this setting undefined.
  However, if you upgrade your binaries and retain an older copy of
  your configuration files, you should consider commenting out 
  \MacroNI{NEGOTIATOR\_HOST}.

  To disable this feature and have the \Condor{negotiator} still
  listen on a well-known port, you can uncomment the
  \MacroNI{NEGOTIATOR\_HOST} setting in the default configuration. 
  For example:
\begin{verbatim}
NEGOTIATOR_HOST = $(CONDOR_HOST)
\end{verbatim}

  Pools that are comprised of older versions of Condor and a 6.7.4 or
  later central manager machine should either continue to use their
  old \File{condor\_config} file (which will still have
  \MacroNI{NEGOTIATOR\_HOST} defined) or they should re-define the
  \MacroNI{NEGOTIATOR\_HOST} setting in the new example configuration
  files which are used during the installation process.

\item Added optional \Expr{DAGMAN\_RETRY\_SUBMIT\_FIRST} configuration
parameter that tells \Condor{dagman} whether to immediately retry
the submit if a node submit fails, or to put that job at the end of
the ready jobs queue.  The default is TRUE, which retries the failed
submit before trying to submit any other jobs.

\item The schedd now uses non-blocking connection attempts when contacting
startds.  This prevents the long (typically 40 second) hang of all schedd
operations when the connection attempt does not complete, due to
network problems.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a performance problem with the standard universe when
\Syscall{gettimeofday} is called in a very tight loop by the application.

\item Fixed the default value of \Macro{OPSYS} in the MacOSX version
  of Condor.
  Once again, Condor reports \verb@OSX@ for all versions of MacOSX.
  This bug was introduced in version 6.7.3 of Condor.

\item Fixed a bug in \Condor{dagman} that caused it to be killed if
the \Expr{DAGMAN\_MAX\_SUBMIT\_ATTEMPTS} parameter was set to too
high a value.

\item Fixed a bug in \Condor{gridmanager} that caused it to crash if
the grid\_monitor was activated.

\item Fixed support for the getdents64() system call inside the
  standard universe on Linux and Solaris.

% Gnats PR 467
\item Fixed a bug in \Condor{dagman} that dealt
incorrectly with the problem of Condor sometimes writing both a
terminated and an aborted event for the same job. The spurious
aborted event is now ignored.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-3}Version 6.7.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all the bug fixes from the 6.6 stable
  series up to and including version 6.6.7, and some of the fixes that
  will be included in version 6.6.8.
  The bug fixes in version 6.6.8 that were not included in version
  6.7.3 are listed in a separate section of the 6.6.8 version
  history. 

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added Full Ports of Condor to Redhat Fedora Core 1, 2 and 3 on
the 32-bit x86 architecture. 
Please read the Linux platform specific
section~\ref{sec:platform-linux-fed} in this manual for more information
on caveats with this port.

\item Added a feature to \Condor{dagman} that will allow VARS names to include
numerics and underscores.

\item Added optional \Expr{COLLECTOR\_HOST\_FOR\_NEGOTIATOR} configuration parameter to indicate which \Condor{collector} the  \Condor{negotiator} on this (local) host should query first. This is designed to improve negotiation performance.

\item Added a new \Condor{dagman} capability to allow the DAG to continue
if it encounters a double run of the same node job (set the
\Expr{DAGMAN\_IGNORE\_DUPLICATE\_JOB\_EXECUTION} parameter to true to do this).

\item Added Condor-C: the "condor" grid\_type.  Condor-C allows jobs to be handed from one \Condor{schedd} to another \Condor{schedd}.

\item Added \Opt{setup\_here} option to \Condor{glidein} for cases where
direct installation is desired instead of submitting a setup job to the
remote gatekeeper.  (For example, this is useful when doing an installation
onto AFS.)

\item If \Attr{RemoteOwner} is exported via \Expr{STARTER\_VM\_EXPRS} into the
ad of other virtual machines, the \Condor{negotiator} automatically inserts
\Attr{RemoteUserPrio} into the ad as well, so policy expressions can now take
into account the priority of jobs running on other virtual machines on the
same host.

\item Linux 2.6 kernels do not update the access time for console devices,
so Condor was unable to detect if there has been activity at the keyboard
or mouse. As a work-around, Condor now polls /proc/interrupts to detect
if the keyboard has requested attention. This does not work for USB keyboards
or pseudo TTYs, so \Attr{ConsoleIdle} on 2.6 kernels will be wrong for some
devices. Future versions of Condor or Linux may correct this.

\item \Condor{dagman} no longer removes the X509\_USER\_PROXY environment 
variable.
This should allow users to set the environment variable before invoking 
\Condor{submit\_dag} and have the jobs submitted by \Condor{dagman} correctly
find the proxy file.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a \Condor{dagman} bug that could cause it to leave jobs running
when aborting a DAG.

\item Fixed a \Condor{dagman} bug which, if its debug level was set to
zero (silent), could cause it to to improperly recognize persistent
\Condor{submit} failures.

\item Fixed a bug in Condor's file transfer mechanism that showed up
  when users tried to use streaming output for either STDOUT or
  STDERR.
  There were situations where Condor would attempt to transfer back
  the STDOUT or STDERR file from the execution host, even though these
  files didn't exist and all the data was already streamed back to the
  submit host.
  Now, if either \Attr{stream\_output} or \Attr{stream\_error} are set
  to true in the job submit description file, Condor will transfer any
  other output but will not attempt to transfer back STDOUT or STDERR.

\item The Condor user log library (libcondorapi) now correctly handles
  execute events that lack a hostname.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item Unfortunately, the default \Macro{OPSYS} value for the MacOSX
  version of Condor was incorrectly changed in version 6.7.3.
  Condor used to always report \verb@OSX@, but in version 6.7.3 it
  will report either \verb@OSX10_2@, \verb@OSX10_3@, or
  \verb@OSX_UNK@.
  This is wrong, since Condor jobs submitted to any version of OSX
  should be able to run on any other version of OSX, and the above
  change needlessly partitions resources and complicates things for
  end-users.
  Therefore, anyone running version 6.7.3 on MacOSX is encouraged to
  add the following line to their global \File{condor\_config} file:
\begin{verbatim}
OPSYS = OSX
\end{verbatim}

  If your pool is already running the new release, you can cause the
  above change to take effect by running the following command on your
  pool's central manager machine (or any machine listed in the
  \MacroNI{HOSTALLOW\_ADMINISTRATOR} list) after you have changed the
  \MacroNI{OPSYS} value in your configuration:
\begin{verbatim}
condor_reconfig -all
\end{verbatim}

  However, if you have already submitted jobs to your pool with the
  old \MacroNI{OPSYS} value, the \Attr{Requirements} expression in
  those jobs will still refer to the incorrect value.
  In this case, you should either a) wait for the jobs to complete
  before making the above change, b) remove the jobs and resubmit
  them after you've made the change, or c) manually run \Condor{qedit}
  on the jobs to change their \Attr{Requirements} expressions.

\item When running in recovery mode on a DAG that has PRE scripts,
\Condor{dagman} may attempt more than the specified number of retries
of a node (counting retries attempted during the first run of the
DAG).  This is because if a node fails because of the PRE script
failing, that fact is not recorded in the log, so that retry is missed
in recovery mode.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-2}Version 6.7.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor Version 6.7.2 includes some bug fixes from Version 6.6.7,
but none from Version 6.6.8.

\item MPI users who are upgrading from previous versions of Condor
to version 6.7.2 will need to modify the 
\Macro{MPI\_CONDOR\_RSH\_PATH} configuration macro of their dedicated
resource to be \MacroU{LIBEXEC} instead of \MacroUNI{SBIN}.
Users who are installing Condor version 6.7.2
for the first time will not need to make any changes.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added an \Macro{INCLUDE} configuration file variable
   to define the location of header files shipped with Condor
   that are currently needed to be included when compiling
   Condor APIs.
   When \MacroNI{INCLUDE} is defined,
   \Condor{config\_val} can be used to list header files.


\item A Condor pool can now support multiple Collectors. This should
  improve stability due to automatic failover. All daemons will now
  send updates to ALL of the specified collectors. All daemons/tools
  will query the Collectors in sequence, until an appropriate 
  response is received. Thus if one (or more) of the Collectors are 
  down, the pool will continue to function normally, as long as 
  there is at least one functioning Collector. 
  You can specify multiple (comma-separated) collector host (and port) 
  addresses in the \Expr{COLLECTOR\_HOST} entry in the configuration
  file. A given \Condor{master} can only run one Collector.

\item When the \Condor{master} is started with the \Opt{-r} option to
  indicate that it should quite after a period of time, the
  \Condor{startd} will now indicate how much time is remaining before it
  exits. It does this by advertising TimeToLive in the machine
  ClassAd.

\item Added new macro \Macro{JOB\_START\_COUNT} that works in
conjunction with existing macro \Macro{JOB\_START\_DELAY} to 
throttle job starts.
Together, this macro pair provides greater flexibility
tuning job start rate given available \Condor{schedd} performance.

\item Added a \MacroNI{LIBEXEC} directory to the install process.
Support commands that
the Condor system needs will be added to this directory in future releases.
This directory should not be added to a user or system-wide path.  

\item Added the ability to decide for each file that condor transfers whether
it should be encrypted or not, using encrypt\_input\_files, 
dont\_encrypt\_input\_files, encrypt output files, and
        dont\_encrypt\_output\_files in the job's submit file.

\item Added DISABLE\_AUTHENTICATION\_IP\_CHECK which will work around problems
on dual-homed machines where the IP address is reported incorrectly to condor.
This is particularly a problem when using Kerberos on multi-homed machines.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug on Linux systems caused by both 
      Condor and the Linux distribution having a library file 
      called \File{libc.a}.
      The problem caused the link step to fail on Condor API
      programs.
      The evaluation order to determine the location of library
      files caused use of the wrong file, given the duplicate naming.
      The bug is fixed by renaming the Condor library files.

\item When the \Condor{startd} is evaluating the state of each virtual
  machine (VM), it now refreshes any ClassAd attributes which are
  shared from other virtual machines (using \Expr{STARTD\_VM\_EXPRS})
  before it tries to evaluate.
  This way, if a given VM changes its state, all other VMs will
  immediately see this state change.

\item Fixed a bug where you couldn't transfer input files larger than 2 gigabytes.

\item Condor can now detect the size of memory on a Linux machine with the 2.6
kernel.

\item JAR files specified in the submit file were not being transfered
along with the job unless they were also explicitly placed in the list
of input files to transfer. Now, the JAR files are implicitly added to the
list of input files to transfer.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-1}Version 6.7.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.1 contains all of the features, ports, and bug fixes
  from the previous stable series, up to and including version 6.6.6.
  There are a few additional bugs that have been fixed in the 6.6.x
  stable series which have not yet been released, but which will
  appear in version 6.6.7.
  These bug fixes have been included in version 6.7.1, and appear in
  the ``Bugs fixes included from version 6.6.7'' list below.
  In addition, a number of new features and some bug fixes have been
  made, which are described below in more detail.

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added an option to DAGMan's retry ability. If a DAG specifies
  something like ``RETRY job 10 unless-exit 9'', then the retries will
  only happen if the node doesn't exit with a value of 9. 

\item Condor-G can now submit jobs to Globus 3.2 (WS) (for jobs with 
  \Expr{universe = grid}, \Expr{grid\_type = gt3}). Submitting to Globus 
  3.0 (as in Condor 6.7.0) is no longer supported. Submitting to pre-WS 
  Globus (2.x) is still supported (\Expr{grid\_type = gt2}).

\item Added new startd policy expression MaxJobRetirementTime.  This
specifies the maximum amount of time (in seconds) that the startd
is willing to wait for a job to finish on its own when the startd
needs to preempt the job (for owner preemption, negotiator preemption,
or graceful startd shutdown).

\item Added -peaceful shutdown/restart mode.  This will shut down the
startd without killing any jobs, effectively treating both
\Expr{MaxJobRetirementTime} and \Expr{GRACEFUL\_SHUTDOWN\_TIMEOUT} as
infinite.  The default shutdown/restart mode is still -graceful, which
behaves according to whatever \Expr{MaxJobRetirementTime} and
\Expr{GRACEFUL\_SHUTDOWN\_TIMEOUT} are.  The behavior of -fast mode
is unchanged; it kills jobs immediately, regardless of the other
timeout settings.

\item Jobs can now be submitted as ``noop'' jobs. Jobs submitted with
  \Expr{noop\_job = true} will not be executed by Condor, and instead will
   immediately have a terminate event written to the job log file and 
   removed from the queue. This is useful for DAGs where the pre-script
   determines the job should not run.

\item Added preliminary support for the Tool Daemon Protocol (TDP)
  into Condor.
  This protocol is still under development, but the goal is to provide
  a generic way for scheduling systems (daemons) to interact with
  monitoring tools.
  Assuming this protocol is adopted by other scheduling systems and by
  various monitoring tools, it would allow arbitrary combinations of
  tools and schedulers to co-exist, function properly, and provide
  monitoring services for jobs running under the schedulers.
  This initial support allows users to specify a ``tool'' that should
  be spawned along-side their regular Condor job.
  On Linux, the ability to have the batch Condor job suspend
  immediately upon start-up is also implemented, which allows a
  monitoring tool to attach with ptrace() before the job's main()
  function is called.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a significant memory leak in the \Condor{schedd} that was
  introduced in version 6.7.0.
  In 6.7.0, the \Condor{schedd} would leak a copy of ClassAd for every
  job it tried to spawn (on average, around 2000 bytes per job).

\item Fixed the bugs in Condor's MPI support that were introduced in
  version 6.7.0.
  Condor now supports MPI jobs linked with MPICH 1.2.4 and older.
  Improved Condor's log messages and email notifications when MPI jobs
  run on multiple virtual machines (the messages now include the
  appropriate ``vmX'' identifier, not just the hostname).
  Unfortunately, due to changes in MPICH between version 1.2.4 and
  1.2.5, Condor's MPI support is not compatible with MPICH 1.2.5.
  We will be addressing this problem in a future release.

\end{itemize}

\noindent Bugs fixes included from version 6.6.7:

\begin{itemize}

\item Fixed an important bug in the low-level code that Condor uses to
  transfer files across a network.
  There were certain temporary failure cases that were being treated
  as permanent, fatal errors.
  This resulted in file transfers that aborted prematurely, causing
  jobs to needlessly re-run.
  The code now gracefully recovers from these temporary errors.
  This should significantly help throughput for some sites,
  particularly ones that transfer very large files as output from
  their jobs.

\item Fixed a number of bugs in the \Opt{-format} option to \Condor{q}
  and \Condor{status}.
  Now, these tools will properly handle printing boolean expressions
  in all cases.
  Previously, depending on how the boolean evaluated, either the
  expression was printed, or the tool could crash.
  Furthermore, the tools do a better job of handling the different 
  types of format conversion strings and printing out the appropriate
  value.
  For example, if a user tries to print out a boolean attribute with
  \verb@condor_status -format "%d\n" HasFileTransfer@, the
  \Condor{status} tool will evaluate \Attr{HasFiletransfer} and print
  either a 0 or a 1 (FALSE or TRUE).
  If, on the other hand, a user tries to print out a boolean attribute
  with \verb@condor_status -format "%s\n" HasFileTransfer@, the
  \Condor{status} tool will print out the string ``FALSE'' or ``TRUE''
  as appropriate.

\item The ClassAd attribute scope resolution prefixes, \texttt{MY.}
  and \texttt{TARGET.}, are no longer case sensitive.

\item \Condor{dagman} now does better checking for inconsistent events
(such as getting multiple terminate events for a single job).  This
checking can be disabled with the \Opt{-NoEventChecks} command-line
option.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-6-7-0}Version 6.7.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.0 contains all of the features, ports, and bug fixes
  from the previous stable series, up to and including version 6.6.4.
  In addition, a number of new features and some bug fixes have been
  made, which are described below in more detail.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added support for vanilla and Java jobs to reconnect when the
  connection between the submitting and execution nodes is lost for
  any reason.
  Possible reasons for this disconnect include: network outages,
  rebooting the submit machine, restarting the Condor daemons on the
  submit machine, etc.
  If the execution machine is rebooted or the Condor daemons are
  restarted, reconnection is not possible.
  To take advantage of this reconnect feature, jobs must be submitted
  with a \Attr{JobLeaseDuration}.
  There are new events in the UserLog related to disconnect and
  reconnect.

\item Added a new Condor tool, \Condor{vacate\_job}.
  This command is similar to \Condor{vacate}, except the kinds of
  arguments it takes define jobs in a job queue, not machines to
  vacate.
  For example, a user can vacate a specific job id, all the jobs in a
  given cluster, all the jobs matching a job queue constraint, or even
  all jobs owned by that user.
  The owner of a job can always vacate their own jobs, regardless of
  the pool security policy controlling \Condor{vacate} (which is an
  administrative command which acts directly on machines).
  See the new command reference, section~\ref{man-condor-vacate-job}
  on page~\pageref{man-condor-vacate-job} for details.
  
\item Added a new ``High Availability'' service to the \Condor{master}.
   You can now specify a daemon which can have ``fail over'' capabilities
   (i.e. the master on another machine can start a matching daemon if the
   first one fails).  Currently, this is only available over a shared
   file system (i.e. NFS), and has only been tested for the \Condor{schedd}.

\item Scheduler universe jobs on UNIX can now specify a
  \Attr{HoldKillSig}, the signal that should be sent when the job is
  put on hold.
  If not specified, the default is to use the \Attr{KillSig}, and if
  that is not defined, the job will be sent a SIGTERM.
  The submit file keyword to use for defining this signal is
  \AdAttr{hold\_kill\_sig}, for example,
  \verb@hold_kill_sig = SIGUSR1@.

\item The \Condor{startd} can now support policies on SMP machines
  where each virtual machine (VM) has knowledge of the other VMs on
  the same host.
  For example, if a job starts running on one of the VMs, a job
  running on another VM could immediately be suspended.
  This is accomplished by using the new configuration variable
  \Macro{STARTD\_VM\_EXPRS}, which is a list of ClassAd attribute
  names that should be shared across all VMs on the machine.
  For each VM on the machine, every attribute in this list is looked
  up in the VM-specific machine ClassAd, the attribute name is given a
  prefix indicating what VM it came from, and then inserted into the
  machine ClassAds of all the other VMs.

\item The \Condor{startd} publishes four new attributes into the
  machine ClassAds it generates when it is in the Claimed state:
  \Attr{TotalJobRunTime}, \Attr{TotalJobSuspendTime},
  \Attr{TotalClaimRunTime}, \Attr{TotalClaimSuspendTime}.
  These attributes keep track of the total time the resource was
  either running a job (in the Busy activity) or had a job suspended,
  regardless of how many suspend/resume cycles the job went through.
  The first two attributes (with ``Job'' in the name) keep track for a
  single job (i.e. since the last time the resource was
  Claimed/Idle). 
  The last two attributes (with ``Claim'' in the name) keep track of
  these totals across all jobs that ran under the same claim
  (i.e. since the last state change into the Claimed state).

\item Added a \Opt{-num} option to the \Condor{wait} tool to wait for
   a specified number of jobs to finish.

\item Added a configuration option \Macro{STARTER\_JOB\_ENVIRONMENT}
   so the admin can configure the default environment inherited by
   user jobs.

\item Added a (configurable, defaults to off) feature to the \Condor{schedd}
   to allow backup the spool file before doing anything else.

\item The "Continuous" option of the \Condor{startd} ``cron'' jobs is
being deprecated.   It's being replaced by two new options which
control separate aspects of it's behavior:
\begin{itemize}
\item "WaitForExit" specifies the "exit timing" mode
\item "ReConfig" specifies that the job can handle SIGHUPs, and it should 
be sent a SIGHUP when the \Condor{startd} is reconfigured.
\end{itemize}

\item A lot of the items logged by the \Condor{startd} ``cron'' logic,
changed to D\_FULLDEBUG (from D\_ALWAYS), etc.

\item Added \Macro{NEGOTIATOR\_PRE\_JOB\_RANK} and
\Macro{NEGOTIATOR\_POST\_JOB\_RANK}.  These expressions are applied
respectively before and after the user-supplied job rank when deciding
which of the possible matches to choose.  (The existing expression
\Macro{PREEMPTION\_RANK} is applied after
\Macro{NEGOTIATOR\_POST\_JOB\_RANK}.)  The pool administrator may use
these expressions to steer jobs in ways that improve the overall
performance of the pool.  For example, using the pre job rank,
preemption may be avoided as long as there are idle machines, even
when the user-supplied rank expression prefers a machine that happens
to be busy.  Using the post job rank, one could steer jobs towards
machines that are known to be dedicated to batch jobs, or one could
enforce breadth-first instead of depth-first filling of a cluster of
multi-processor machines.

\item Added the ability for Condor to transfer files larger than 2G on
platforms that support large files.  This works automatically for
transferred executables, input files and output files.

\item Added the ability for jobs to stream back standard input, output, and
error files while running.  This is activated by the \Opt{stream\_input},
\Opt{stream\_output}, and \Opt{stream\_error} options to \Condor{submit}.
Note that this feature is incompatible with the new feature described
above where the shadow and starter can reconnect in certain
circumstances. 

\item Added support for vanilla jobs to be mirrored on a second
  \Condor{schedd}. The jobs are submitted to the second \Condor{schedd}
  on hold and will be released if the second \Condor{schedd} hasn't
  heard from the first \Condor{schedd} (actually, a \Condor{gridmanager}
  running under the first \Condor{schedd}) for a configurable amount of
  time. Once the second \Condor{schedd} releases the jobs, the first
  \Condor{schedd} acts as a mirror, reflecting the state of the jobs on
  the second \Condor{schedd}.
  To use this mirroring feature, jobs must be submitted
  with a \Attr{mirror\_schedd} parameter in the submit file and require
  no file transfer.

\end{itemize}


\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in the \Condor{startd} ``cron'' logic which caused the
\Condor{startd} to except when trying to delete a job that could never
be run (i.e. invalid executable, etc).

\item Fixed a bug in \Condor{startd} ``cron'' logic which caused it to
not detect when the starting of a ``job'' failed.

\item Fixed several bugs in the reconfiguration handling of the
\Condor{startd} ``cron'' logic.  In particular, even if the job has
the "reconfig" option set (or "continuous"), the job(s) won't be sent
a SIGHUP when the startd first starts, or when the job itself is first
run (until it outputs its first output block, defined by the "-"
separator).

\end{itemize}


\noindent Known Bugs:

\begin{itemize}

\item Condor's MPI support (for MPICH 1.2.4) was broken by other
  changes in version 6.7.0.
  Support for MPI jobs will return in Condor version 6.7.1.

\end{itemize}
\begin{center}
\begin{table}[hbt]
\begin{tabular}{|ll|} \hline
\emph{Architecture} & \emph{Operating System} \\ \hline \hline
Hewlett Packard PA-RISC (both PA7000 and PA8000 series) & HPUX 10.20 \\ \hline
Sun SPARC Sun4m,Sun4c, Sun UltraSPARC & Solaris 2.6, 2.7, 8, 9 \\ \hline
Silicon Graphics MIPS (R5000, R8000, R10000) & IRIX 6.5 (clipped) \\ \hline
Intel x86 & Red Hat Linux 7.1, 7.2, 7.3, 8.0 \\
 & Red Hat Linux 9 \\
 & Windows 2000 Professional and Server, 2003 Server (clipped) \\
 & Windows XP Professional (clipped) \\ \hline
ALPHA & Digital Unix 4.0 \\
 & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\
 & Tru64 5.1 (clipped) \\ \hline
PowerPC & Macintosh OS X (clipped) \\
 & AIX 5.2L (clipped) \\ \hline
Itanium & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\
 & SuSE Linux Enterprise 8.1 (clipped) \\ \hline
\end{tabular}
\caption{\label{supported-platforms}Condor 6.7.0 supported platforms}
\end{table}
\end{center}
