%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-6-7}Development Release Series 6.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of Condor.
The details of each version are described below.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7.13}Version 6.7.13}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added a new natively compiled clipped port for the Red Hat
Enterprise Linux 3 IA64 distribution.

\item Added a \Opt{-pool} option to \Condor{submit}. It lets you submit
jobs to a \Condor{schedd} in a different pool. The other options to
\Condor{submit} now have long names, but the single-character verions
still work.

\item ``grid\_resource'' can now be used to directly set the new grid
universe job attribute ``GridResource.'' The old attributes still work,
but they will be ignored if ``grid\_resource'' is present. As a
side-effect, ``stream\_output'' and ``stream\_error'' will default to
``False'' for all jobs.

\item X509 user proxies are now updated for vanilla universe jobs.   If
a job specifically sets x509userproxy and is using file transfer, when
the proxy file is updated, it will be transfered to the running job.

\item If a  cycle is detected in the DAG while 
running, \Condor{dagman} now prints (in the \File{dagman.out} file)
the status of all DAG nodes.

\item Addition of SOAP SSL code. Daemons can now require clients to
  authenticate using SSL.

\item BeginTransaction call in \Condor{schedd}'s SOAP interface now
  notifies the caller if too many transactions are currently running
  via an error code of FAIL. Pervious behavior was to abort a running
  transaction in order to allow the BeginTransaction call to succeed.
  
\item MAX\_SOAP\_TRANSACTION\_DURATION config option added so that a
  single transaction cannot take up too many \Condor{schedd}
  resourced. This option specifies an optional maximum duration
  between SOAP calls in a single transaction.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item When using file transfer, transfering the results back to
the submit machine could silently fail for Condor releases 6.7.0
though 6.7.12.  This was relatively rare through 6.7.10.  For
6.7.11 and 6.7.12, the bug would be easily triggered if a vanilla
job had an X509 user proxy associated with it.  This is now
fixed.

\item Fixed a logic bug in the \Condor{schedd}.
  Previously, if there was an error expanding any \verb@$$(attribute)@
  references in a job classad when trying to spawn a \Condor{shadow},
  the \Condor{schedd} would die with the fatal exception ``Impossible:
  GetJobAd() returned NULL for X.Y but that job is already known to
  exist''.
  Now, the \Condor{schedd} correctly distinguishes between a non-fatal
  error expanding \verb@$$(attribute)@ and the fatal error of the job
  already being gone (which is, in fact, impossible).
  This bug was first introduced in Condor version 6.7.1.

\item The reason strings generated when a user job policy expression fires
are now consistent for grid universe jobs.

\item The \Condor{gridmanager} now evaluates the periodic job policy
expressions at the interval set by \Macro{PERIODIC\_EXPR\_INTERVAL}.

\item Fixed a bug which prevented standard universe from working on a linux 
kernel post 2.6.12.2.

\item Fixed a bug that caused the \Condor{gridmanager} to crash if a
grid-type condor job ad contained the attribute \Attr{remote\_}.

\item Fixed a bug with the FS\_REMOTE authentication mechanism that caused
it to fail occasionally when using NFS.

% Gnats PR 553:
\item Fixed a bug in which a double terminated event in a DAG node with
a POST script could cause \Condor{dagman} to abort the DAG and claim
that a cycle exists in the DAG.

% Also related to Gnats PR 553:
\item In the DAG status messages in \File{dagman.out} files,
\Condor{dagman} now shows nodes with queued PRE or POST scripts
in the Pre or Post columns.  Previously, these nodes were shown
in the Un-Ready column.

\item Fixed the GetFile SOAP call on the \Condor{schedd} so that it
  behaves more like POSIX read() and does not report errors when
  trying to read more data than is available.

% Gnats PR 557:
\item Fixed a hash function bug that could cause \Condor{dagman}
to crash.

\item \Attr{JobCurrentStartDate} and \Attr{JobLastStartDate} are no longer
changed in the job ad when the \Condor{schedd} and \Condor{shadow} reconnect
to a running job after a crash.

\end{itemize}

\noindent Changes:

\begin{itemize}

\item Added a couple missing parameters to the example configuration file
\File{condor\_config.generic}.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7.12}Version 6.7.12}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item None.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item None.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7.11}Version 6.7.11}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor is now linked against GSI from Globus 4.0.1.

\item GSI security and the grid universe should now work in the Alpha 
Linux port.

\item All Condor release packages are now compressed with GNU's
  \Prog{gzip}.
  We no longer ship releases compressed with the vendor's
  \Prog{compress} utility.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added a new feature called \Bold{Quill} to Condor which allows an
        SQL server to mirror the job queue in order to speed up queries about
        the job queue via \Condor{q} and \Condor{history}. Please see 
        page~\pageref{sec:Quill} for the description of this feature.

\item \Condor{dagman} has a new \Opt{-maxidle} command-line argument
that can be used to throttle DAG job submissions according to the number
of idle jobs in the DAG.

\item \Stork{submit} is now able to search for X.509 credentials in the
standard locations.

\item The \Condor{negotiator} can now limit how long it negotiates with a 
single submitter before moving on to the next one. 

\item On platforms and filesystems that support files larger than 2
GB, the history file can now be larger than 2 GB.

\item Added two options to \Condor{q}: \Opt{-jobads} and
  \Opt{-machineads}. They will take ads from files instead of the
  schedd and collector, respectively. These options are mostly useful
  for debugging. 

\item Added a new, hopefully less confusing, Cron (Hawkeye)
configuration syntax.  The old syntax is still supported, but should
be considered deprecated, and will eventually go away.  The new syntax
splits the old colon separated ``name:prefix:executable:period''
string into separate macros.

\item Improved support for job leases. ``job\_lease\_duration''  now works for
grid-type condor jobs. New job ad attribute ``TimerRemove'' specifies a
specific time at which a job should be removed. These attributes will be 
passed through multiple layers of grid-type condor jobs.

\item Grid universe jobs now use a unified pair of attributes 
(``GridResource'' and ``GridJobId'') to identify the remote resource. This
will make it possible to match jobs to multiple types of resources. The
submit file syntax remains the same for now, except that ``remote\_pool'' is
now required for grid-type condor jobs.

\item Significantly improved response time for \Condor{q} when job classads
are larger than 4 kbytes (by disabling TCP Nagle algorithm as appropriate).

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed bug in the dedicated scheduler where if the \Condor{startd} 
rejected a match, the \Condor{schedd} would never retry new matches 
for that machine.  This would result in MPI and parallel jobs sticking 
in the Idle state, and the message "DedicatedScheduler::negotiate sent 
match for machine, but we've already got it".

\item Fixed problem with the parallel universe to allow for LAM jobs
to get SIGTERM on exit so they can exit cleanly.

% condor-support #1419
\item Fixed a bug that was visible to the end user as file transfer
  failures on a busy system.
  The root problem was that if the \Condor{negotiator} gave out the
  same match twice (due to having stale info in the \Condor{collector}
  when trying to negotiate), the \Condor{schedd} would be confused,
  attempt to re-use the match, fail to do so, and then kill the
  previous (legitimate) use of the match.
  This bug was introduced in verison 6.7.4.

\item Fixed bug in the parallel universe that caused the schedd to
crash when reconnecting to jobs that couldn't be reconnected to.

\item Fixed bug in parallel shadow which caused Shadow Exceptions
in parallel jobs when the components exited in the wrong order.

% Gnats PR 534.
\item Fixed a bug in \Condor{dagman} that caused it to fail on Windows
for DAGs with nodes having absolute paths to their log files.  (This bug
was introduced in version 6.7.10.)

% Gnats PR 492.
\item Fixed a bug whereby \Condor{dagman} could crash after executing
the POST script of a node whose Condor job had never been successfully
submitted due to repeated \Condor{submit} failures.  (This bug was
introduced in 6.7.7 or earlier.)

\item Fixed a bug in a debug message.  If an error occurred during file
transfer, Condor would print the wrong expected filesize in the error message
on some platforms.

\item Fixed bug where \Stork{submit} was corrupting log notes passed from the
command line.  This bug also had the effect of disabling Stork jobs running
from DAGMan versions v6.7.10, and later.

% Gnats PR 525.
\item If you have DATA nodes in your DAG but no Stork log specified
(with the \Opt{-Storklog} argument),
\Condor{dagman} now fails with an explanatory message when parsing
the DAG file(s). (Previously, it would just wait forever for the Stork
jobs to finish, because it wouldn't see the relevant events.)

\item In \Condor{dagman}, argument quoting for \Stork{submit} now matches
argument quoting for \Condor{submit}.

\item Corrected how \Condor{submit} handles attributes forced into the
job ad with '+'. Now, the attribute names are case-insensitive, they 
are not treated as normal submit attributes, and they always over-ride 
normal submit attributes.

\item Fixed bugs that would cause a segfault when reading a classad from
a file. Triggered by consecutive blank lines and lines containing only
white-space.

\item Fixed a bug that could cause duplicated output when a gt4 grid job 
is executed more than once.

\item Fixed a bug that could cause the \Condor{gridmanager} to assert if 
it tried to delegate credentials for gt4 grid jobs before the gahp server 
was started.

\item Fixed a race condition that could cause condor grid-type jobs to be
held with hold reason ``Spooling input data files''.

\item \Condor{glidein} now correctly handles extracting necessary
information from modern Condor configurations where
\MacroNI{NEGOTIATOR\_HOST} is not defined.

% Programmer explanation:
% MANAGED is no longer boolean in the job ad, it's
% a string of complex state.  This enables the gridmanager
% to no longer erroneously take control of jobs that are
% done but haven't left the queue.
\item Refinements in how grid universe components track jobs.  Grid universe
jobs are less likely to generate multiple terminate events in the job's user
log.  There will also be slight performance improvements are redundant work 
is no longer done.

% Gnats PR 542
\item Fixed a bug in \Condor{dagman} that caused it to core dump on
a 'job reconnected' event from a node job.

\item \Condor{submit} will now exit zero as long as the submission succeeds.  Debugging output will still be printed if the internal reschedule fails.

% RUST condor-support #1402
\item On Windows, exited child processes of the Condor services
will be handled in order of termination.  This fixes the problem where jobs
submitted from a Windows machine appear to run much longer than normal
because the \Condor{schedd} fails to notice that a \Condor{shadow} exits
when the system is very busy.

% Gnats PR 532
\item Fixed a bug that caused scheduler universe jobs to often wait five
minutes (or whatever \MacroNI{SCHEDD\_INTERVAL} is set to) before running.

\item Fixed a bug that prevented the \Condor{starter} from running on a
Win32 machine with a FAT32 filesystem.

\item A reschedule command will now be sent to the \Condor{schedd} whenever
a job is released from held state. This should make grid-type condor jobs
start much faster.

\item Config parameters \MacroNI{GAHP} and \MacroNI{GAHP\_ARGS} have been
deprecated. \MacroNI{GT2\_GAHP} should be used instead.

\end{itemize}

\noindent Changes:

\begin{itemize}

\item \Condor{configure} no longer creates a
\begin{verbatim} $(LOCAL_DIR)/ViewHist \end{verbatim}
directory, which was begun in verion 6.7.10.  This directory was of limited
value for most users.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-10}Version 6.7.10}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.10.

\item The Mac OS X binaries shipped with this release were built on OS
  10.3.  Previous versions of Condor for OS X were built with version
  10.2.  Condor is officially dropping support for Mac OS 10.2 with
  this release (though it is possible the 10.3 binaries still work, we
  have not verified it either way).  These binaries are known to work
  with Mac OS 10.4 (``Tiger''), as well.

\item There is a minor bug in version 6.7.10's \Condor{configure}
  script.
  It will create a directory called \File{ViewHist} in the local
  directory (next to \File{log}, \File{spool}, etc).
  This directory is not used by Condor at all, except in the case of a
  \Condor{view} collector (which is optional, and not enabled by
  default). 
  This behavior will be removed in version 6.7.11, and
  \Condor{configure} will go back to not creating the \File{ViewHist}
  directory.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item \Condor{dagman} can now run multiple DAGs in separate directories.


\item Added \Macro{DAGMAN\_CONDOR\_SUBMIT\_EXE},
\Macro{DAGMAN\_STORK\_SUBMIT\_EXE}, \Macro{DAGMAN\_CONDOR\_RM\_EXE},
and \Macro{DAGMAN\_STORK\_RM\_EXE} configuration settings to specify
the \Condor{submit}, \Stork{submit}, \Condor{rm}, and \Stork{rm}
executables used by \Condor{dagman}.  If unset (which they are by
default), \Condor{dagman} looks for each in the PATH.

\item For Condor-C jobs, the \Condor{gridmanager} will retry and delay
  failed connections to a remote \Condor{schedd} like it does for
  Condor-G jobs. The same configuration settings apply 
  (\Macro{GRIDMANAGER\_CONNECT\_FAILURE\_RETRY\_COUNT} and
  \Macro{GRIDMANAGER\_RESOURCE\_PROBE\_INTERVAL}).

\item \SubmitCmd{remote\_initialdir} is now supported in all universes except
for standard universe.  Previously, it was only supported in the grid universe.

\item \SubmitCmd{+Remote\_} syntax for Condor-C jobs has been
simplified for the specific commands of
\SubmitCmd{universe}, \SubmitCmd{remote\_schedd}, \SubmitCmd{remote\_pool}, \SubmitCmd{globus\_rsl}, and \SubmitCmd{globus\_scheduler}.

\item Added default user priority factors for accounting groups.  More on
        accounting groups will be available in future versions of the manual.

\item The \Condor{startd} can now be configured to write out the
  \Attr{ClaimId} of the next available claim for each virtual machine
  to seperate files.
  This functionality will enable enhanced fault tolerance in future
  versions of Condor.
  For more information, see section~\ref{param:StartdClaimIdFile} for
  details on \Macro{STARTD\_SHOULD\_WRITE\_CLAIM\_ID\_FILE} and
  \Macro{STARTD\_CLAIM\_ID\_FILE}, the two configuration settings that
  control this behavior.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed bugs on the Win32 platform in the \Condor{schedd} that could
cause jobs to never complete when the \Condor{schedd} is busy with many jobs
running at once.

\item Fixed a bug on Windows where if lots of jobs submitted were from
  the same \Condor{schedd}, some of the \Condor{shadow} processes
  would block for an extremely long time trying to get a lock for
  writing to the \File{ShadowLog} file.
  Now, log writing happens more fairly, and no \Condor{shadow}
  processes can be delayed indefinitely.

\item \Condor{submit} \Opt{-name} formerly had no effect on Windows and
did not work properly. This is now fixed.

\item Significantly sped up the removal of large groups of jobs by
changing the default value of \MacroNI{JOB\_IS\_FINISHED\_INTERVAL} from 1
to 0 (see section~\ref{param:JobIsFinishedInterval} for details on this
setting).

\item Improved performance of the \Condor{schedd} when not running as
  root.
  In version 6.7.7, the new code to support the scheduler universe
  with Condor-C involved adding some additional overhead to the
  \Condor{schedd}.
  However, this overhead is not needed unless the \Condor{schedd} is
  running as root.
  In version 6.7.10, the \Condor{schedd} notices if it is not root and
  does an optimization to avoid the overhead.

\item Fixed a bug that caused the gridmanager to crash if a gt2, gt3, or
gt4 grid job had a proxy that couldn't be read properly. Now the job gets
put on hold.

\item The Condor-C GAHP now performs file staging in a 
separate process, allowing remote grid jobs to be started earlier.

\item When contacting the embedded web server on Condor daemons,
  authentication is no longer requested.
  The previous authentication requirement didn't provide any
  additional security, and could confuse users.

\item Fixed rare bug that could cause \Condor{submit} to crash when
  both getenv=true and environment=... were in a submit file and when
  very large variable names were in the environment. 

\item Fixed a rare bug where the \Condor{schedd} would die with a
  fatal exception under extremely heavy load on the machine.
  The error message was:
\begin{verbatim}  
  ERROR ``Impossible: Create_Thread child_errno (xxx) is not
  ERRNO_PID_COLLISION!'' at line 6181 in file daemon_core.C
\end{verbatim}  

\item Fixed a rare bug where certain attributes in a job description
  file could cause the \Condor{schedd} to crash when restarting and
  parsing the \File{job\_queue.log} file.

\item Improved performance of standard universe jobs when
  \Attr{WantRemoteIO} is set to false in the job ClassAd.  
  In this case, Condor's checkpointing libraries now avoid some
  additional communication with the \Condor{shadow} which are not
  required if there's no remote IO.

\item Fixed some messages in the Condor log files that were improperly
  formatted, or contained incomplete information.

\item Improved some user-log-reading error messages in \Condor{dagman}.

\item Removed support for deprecated \Opt{-NoPostFail} option from
\Condor{dagman}.  (The same functionality can be achieved through the
use of a simple POST script.)

\item Fixed bug in dedicated scheduler, where under heavy load, the
  schedd would occasionally try to start the same job twice, and
  subsequently exit with the message:
\begin{verbatim}  
  ERROR ``Trying to run job x.x, but already marked RUNNING!''
\end{verbatim}  

\item Fixed bug in dedicated scheduler, so that it now creates a 
  spool directory for each condor proc of a parallel or MPI job
  with multiple requirements.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

% Gnats PR 534.
\item On Windows only, \Condor{dagman} fails for DAGs with
nodes having absolute log file paths in their submit files.

% Gnats PR 492.
\item \Condor{dagman} does not correctly handle the case where all
submit attempts for a node job fail, and the node has a POST script.
If this happens for a single node in a DAG, it is usually okay,
but if it happens for a second node, \Condor{dagman} will crash.

\item The Condor-C GAHP now performs file staging in a 
separate process, allowing remote grid jobs to be started earlier.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-9}Version 6.7.9}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.10.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The Parallel Universe has been added.
  For more information, see section~\ref{sec:Parallel} on
  page~\pageref{sec:Parallel}.


\item 
\index{environment variables!X509\_USER\_PROXY}
\index{X509\_USER\_PROXY}
The environment variable \Env{X509\_USER\_PROXY} is set to the
full path of the proxy if a proxy is associated with the job.
This is usually done using \SubmitCmd{x509userproxy} in the submit file.
This currently works in the local, java, and vanilla universes.

\item \Condor{submit} generates more precise error messages in 
some failure cases.

\item \Condor{hold}, \Condor{release} and \Condor{rm} now allow the user
to change the HoldReason, ReleaseReason or RemoveReason with the -reason
flag.

\item \Condor{dagman} no longer does a one-second sleep before each
submit if all node jobs have the same log file.  (The sleep is still
needed if there are multiple log files, for unambiguous ordering of
events during bootstrapping.)  Note that if \MacroNI{DAGMAN\_SUBMIT\_DELAY}
is specified, the specified delay takes effect whether or not all
jobs have the same log file.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Many crashes related to running the Dedicated Scheduler have
been fixed.

\item Setting COLLECTOR\_HOST or NEGOTIATOR\_HOST with a port but without
a hostname no longer causes the \Condor{master} to crash.

\item The Condor-G Grid Monitor now works with Globus 4.0 pre-Web Services
GRAM.

\item Several deadlocks in the Condor-C GAHP server have been fixed.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-8}Version 6.7.8}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Controlling whether or not a standard universe job asks the
\Condor{shadow} about how/where to open every single file can be better
controlled with the \Attr{want\_remote\_io} attribute in the submit
description file.
This attribute can be set to true or false and it is true be default.
If set to false, then this attribute forces a standard universe job in 
Condor to always look to the local file system when opening files and not
to contact the shadow. 
This increases performance of user jobs where the jobs open a very large
amount of files in a small space of time.
However, the user jobs must be matched to machines that have the same
UID\_DOMAIN and FILESYSTEM\_DOMAIN, as per vanilla universe jobs with a 
homogeneous file system.

\item \Condor{dagman} now has the capability to run more than one
independent DAG in a single \Condor{dagman} process.

\item User policy expressions (on\_exit\_remove and on\_exit\_hold)
now work for scheduler universe jobs.

\item TotalCpus and TotalMemory are now set in machine ads.

\item \Condor{dagman} now tolerates the "two terminated events for
a single job" bug by default.  There is a new bit in
\MacroNI{DAGMAN\_ALLOW\_EVENTS} to control whether this bug is considered
a fatal error in a \Condor{dagman} run.

\item Added a new debug formatting flag, \Dflag{PID}, that prints out
  the process id (PID) of the process writing a given entry to a log
  file.
  This is useful in Condor daemons (such as the \Condor{schedd}) where 
  the daemon can fork() multiple processes to perform various tasks
  and it is helpful to see what log messages are coming from forked
  process versus the main thread of execution.
  The default \Macro{SCHEDD\_DEBUG} in the sample configuration files
  shipped with Condor now includes this flag.

\item When \Condor{dagman} writes rescue files, each node is now
specified with the same number of retries as was specified in the
original DAG, rather than with only the ``remaining'' number of
retries based on the failed run.  The latter behavior can be restored
by setting \Macro{DAGMAN\_RESET\_RETRIES\_UPON\_RESCUE} to false.

\item Added ``Hawkeye'' capabilities to \Condor{schedd}.  It's
configured identically to that of \Condor{startd}, but using 
``SCHEDD'' in place of ``STARTD'', in particular for the
``SCHEDD\_CRON\_NAME'' macro.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

% See Gnats PRs 297 and 430.
\item Fixed a bug in \Condor{dagman} that prevented POST scripts
from being used with jobs that write XML-format logs.

\item The event-checking code used by \Condor{dagman} now defaults
to allowing an execute event before the submit event for the same
job; if this happens, there will be a warning, but the DAG will
continue.  See section~\ref{param:DAGManAllowEvents} for more info.

\item \Condor{userprio} option \Opt{-pool} was failing with ``Can't
find address for negotiator'' since version 6.7.5.

\item Fixed a bug the prevented SOAP clients from being able to access
a job's spooled data files if the \Condor{schedd} restarted.

\item Fixed a bug that caused the \Condor{gridmanager} to panic when
trying to retire a job from the queue that was already gone. This
could cause multiple terminate events to be logged for some jobs.

\item Fixed a bug that caused match-making to not work for Condor-C
jobs.

\item Added workaround for a Globus bug that can cause re-execution of
a completed GT2 job in the correct failure case (Globus bugzilla ticket
3411).

\item Properly extend the lifetime of GT4 jobs and credentials on the
remote server.

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-7}Version 6.7.7}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all of the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item The \Expr{STARTD\_EXPRS} list can now be on a per-VM basis, and
entries on the list can also be specific to a VM. 
See ~\ref{sec:SMP-exps} for more details.

\item The \Macro{LOCAL\_CONFIG\_FILE} can now be overridden. 
This now allows files to include other local config files. 
See ~\ref{param:LocalConfigFile} for more info.

\item Resources that are claimed but suspended can now optionally 
not be charged for at the accountant. 
When the resource is unsuspended, the accountant will resume charging
for usage. 
This is controlled by the \Expr{NEGOTIATOR\_DISCOUNT\_SUSPENDED\_RESOURCES}
config file entry, and it defaults to false.

\item The \Attr{DAGManJobID} attribute which \condor{dagman} inserts
into the classad of every job it submits now contains only its cluster
ID (instead of a cluster.proc ID pair), so that it may be referenced
as an integer in DAG job submit files.  This allows, for example, a
user to automatically set the relative local queue priority of jobs
based on the \condor{dagman} job that submitted them, so that jobs
submitted by ``older'' DAGs will start before jobs submitted by
``newer'' DAGs (assuming they are otherwise identical).

\item GSI authentication can now be used when Condor-C jobs are submitted
from one \condor{schedd} to another.

\item File permissions are now preserved when a job's data files are
transferred between unix machines. File transfers that involve a windows
machine or older version of Condor remain as before.

\item Condor-C now supports the scheduler remote universe.

\item \condor{advertise} now publishes a ``MyAddress'' if none is provided
in the source ClassAd.  This will prevent the collector from throwing out
ads with no address (see Bugs Fixed).

\item Added a new \Condor{dagman} parameter \MacroNI{DAGMAN\_ALLOW\_EVENTS}
controlling which ``bad'' events are not considered fatal errors;
the \Opt{-NoEventChecks} command-line argument is deprecated and has no effect.

\item \Condor{fetchlog} now takes an optional log file extension in order to
select logs such as ``StarterLog.vm2''.

\end{itemize}


\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a throughput performance bottle neck when standard universe
        jobs vacate when the user has specified \Attr{WantCheckpoint} equal to
        False in the submit file.

\item Added initial support for the \Syscall{getdents},
        \Syscall{getdents64}, \Syscall{glob}, and the family of functions
        \Syscall{opendir}, \Syscall{readdir}, \Syscall{closedir} for the
        standard universe.  

        It is recommended that you do not directly invoke \Syscall{getdents} 
        or \Syscall{getdents64}, but instead use the other POSIX functions
        specified above.

        There are two caveats: these calls will not work in heterogeneous
        contexts, and you may not call \Syscall{getdents} directly when 
        \Condor{compile}ing a 32-bit program while specifying the 64-bit
        interfaces for the Unix API.

\item In versions 6.7.4 through 6.7.6, Computing On Demand (COD)
  support was broken due to a bug in how Condor daemons parsed their
  command line arguments.
  The bug was introduced with the changes to provide a web services
  (SOAP) interface to Condor.
  This bug has been fixed and COD support is now working again.

\item In version 6.7.6, the \MacroNI{DAGParentNodeNames} attribute
which \Condor{dagman} adds to all DAG job classads could grow too long
and cause job submission to fail.  Now, if the
\MacroNI{DAGParentNodeNames} value would be too long to add to the job
classad, the attribute is instead left undefined and a warning is
emitted in the DAGMan debugging log.  This behavior means that such a
node can be reliably distinguished from a node with no parents, as the
latter will have a \MacroNI{DAGParentNodeNames} attribute defined but
empty.

\item In version 6.7.3, the value of the X509UserProxySubject job attribute
was changed in such a way that Condor-G jobs submitted by a newer
\condor{submit} to an older \condor{schedd} could fail to run. Now,
\condor{submit} reverts to the old behavior when talking to an old
\condor{schedd}.

\item Bug-fixes and improvements to grid\_type gt4:

  \begin{itemize}

  \item Condor will now delegate a single proxy to the GT4 server for
  multiple. If the local proxy is refreshed, Condor will forward the
  refreshed copy to the server.

  \item Exit codes are now recorded properly.

  \item \Macro{JAVA\_EXTRA\_ARGUMENTS} now used when invoking the GT4 GAHP
  server (which is written in java).

  \item If \Macro{LOWPORT} and \Macro{HIGHPORT} are set in the config file,
  the GT4 GAHP server will now obey the port restriction.

  \item Fixed a bug that caused Condor not to notice when some GT4 jobs
  completed.

  \item Fixed a bug in handling the job's environment for GT4 jobs. Condor
  incorrectly used ``<name>=<value>'' for each variable's name.

  \item Improved hold reason in certain cases when a GT4 job goes on hold.

  \item \condor{q} -globus now works properly for GT4 jobs. Also, the resource
  name in the user log execute event is printed properly for GT4 jobs.

  \item Fixed a bug that could cause Condor to not detect when a GT4 job
  completes. This was triggered by Condor not properly recognizing the
  StageOut Globus job state.

  \end{itemize}

\item Fixed a bug that can cause the \condor{gridmanager} to abort if
\Attr{PeriodicRelease} evaluates to true while it's putting a job on hold.

% See Gnats PR 470
\item Fixed a bug in \Condor{dagman} that
caused the DAG to be aborted if a job generated an executable error
event.

\item Fixed a bug in \Condor{dagman} on Windows that would cause it to
hang or crash on exit.

\item MPI universe jobs now honor the \Attr{JOB\_START\_DELAY}
configuration setting.

\item The \Condor{collector} now throws out startd, schedd, and License
ClassAds that don't have a valid IP address (used in it's hashing).  The
collector now correctly will fall back to ``MyAddress'' if it's provided.

% See Gnats PR 479.
\item Fixed a bug in \Condor{dagman} that could cause \Condor{dagman}
to fail an assertion if PRE or POST scripts are throttled with the
\Opt{-maxpre} or \Opt{-maxpost} \Condor{submit\_dag} command line flags.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-6}Version 6.7.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.6 contains all the bug fixes and improvements from
  the 6.6 stable series up to and including version 6.6.9.

\end{itemize}

\noindent New Features:

\begin{itemize}

\item Added support for libc's \Syscall(system) function for standard
        universe executables. This call is not checkpoint-safe in that
        the standard universe job could call it twice or more times
        in the event of a resumption from an earlier checkpoint. The
        invocation of this call by the shadow on behalf of the user
        job is controlled by a configuration file parameter called
        \Attr{SHADOW\_ALLOW\_UNSAFE\_REMOTE\_EXEC} and is off by default.
        The full environment of the user job is preserved during the
        invocation of \Syscall(system) and this might cause problems in 
        heterogeneous submission contexts of the user is not careful.

\item Added support for a web services (SOAP) interface to Condor.
  For more information, see and section~\ref{API-WebService} on
  page~\pageref{API-WebService}.

  \Note Due to a bug in gSOAP, the SOAP support in Condor 6.7.6 does
  not work with all SOAP toolkits.
  Some of the responses that gSOAP generates contain unqualified tags.
  Therefore, SOAP toolkits that are strict (such as gSOAP or .Net)
  will not accept these poorly formed responses.
  SOAP toolkits that are more lax in the responses they accept (such
  as Axis, SOAP::Lite, or ZSI) will work with version 6.7.6.
  This problem has already been fixed and the solution will be
  released in Condor version 6.7.7.

\item Added support for the GT4 grid\_type in Condor's grid universe.
  This new grid type supports jobs submitted to grid resources
  controlled by Globus Toolkit version 4 (GT4).

  New configuration settings are required to support jobs
  submitted for the GT4 grid type.
  These settings have been added to the default configuration files
  shipped with Condor, but sites that are upgrading an existing
  installation and choosing to keep their old configuration files must
  add these settings to allow GT4 jobs to work:
\begin{verbatim}
## The location of the wrapper for invoking GT4 GAHP server
GT4_GAHP = $(SBIN)/gt4_gahp
 
## The location of GT4 files. This should normally be lib/gt4
GT4_LOCATION = $(LIB)/gt4

## gt4-gahp requires gridftp server. This should be the address of gridftp
## server to use
GRIDFTP_URL_BASE = gsiftp://$(FULL_HOSTNAME)
\end{verbatim}

\item Condor version 6.7.6 includes the Stork data movement system, 
  the Condor Credential Daemon (\Condor{credd}), and support for using
  MyProxy for credential management.
  However, currently these are only supported in our release for Linux
  using the 2.4 kernel with glibc version 2.3 (RedHat 9, etc).
  All of these features require changes to the Condor configuration
  files to function properly.
  The default configuration files shipped with Condor already include
  all the new settings, but sites upgrading an existing installation
  must add these new settings to their Condor configuration.
  For a list of settings and more information, see
  section~\ref{sec:Stork-Config-File-Entries} on 
  page~\pageref{sec:Stork-Config-File-Entries} for Stork,
  section~\ref{sec:Credd-Config-File-Entries} on
  page~\pageref{sec:Credd-Config-File-Entries} for \Condor{credd},
  and section~\ref{sec:MyProxy-Config-File-Entries} on
  page~\pageref{sec:MyProxy-Config-File-Entries} for MyProxy.
  For more information about MyProxy, you can also see  
  \URL{http://grid.ncsa.uiuc.edu/myproxy}

\item Added preliminary support for the High Availability Daemon (HAD).

\item Added a new \MacroNI{SCHED\_UNIV\_RENICE\_INCREMENT}
configuration variable used by the \Condor{schedd} for scheduler
universe jobs, analogous to the existing
\MacroNI{JOB\_RENICE\_INCREMENT} variable used by the \Condor{startd}
for other job universes.  The \MacroNI{SCHED\_UNIV\_RENICE\_INCREMENT}
variable is undefined by default, and when undefined, defaults to 0
internally.

\item The relative priority of a user's own jobs in the local
\condor{schedd} queue is no longer limited to the range -20 to +20,
but can be any integer value.

\item DAGMan Improvements:

\begin{itemize}

  \item \Condor{dagman} now inserts a \MacroNI{DAGParentNodeNames}
  attribute into classad of all Condor jobs it submits, containing the
  names of the job's parents in the DAG.  The list is in the form of a
  comma-delimited string.

  \item Added the \Condor{dagman} arguments \Opt{-noeventchecks} and
  \Opt{-allowlogerror} to \Condor{submit\_dag}.

\end{itemize}

\item \Condor{glidein} Improvements:

\begin{itemize}

  \item Added \Condor{glidein} options for setting up GSI authentication.

  \item Added \Condor{glidein} option {-run\_here} for direct
  execution of Glidein, instead of submitting it for remote execution.
  You may also save a script for doing this and then run the script
  through whatever mechanism you want (like some batch system
  interface not supported by Condor-G).

\end{itemize}

\item Added support for the \Macro{NEGOTIATOR\_CYCLE\_DELAY}
  configuration setting, which is only intended for expert
  administrators.
  For more information, see section~\ref{param:NegotiatorCycleDelay}
  on page~\pageref{param:NegotiatorCycleDelay}.


\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Removed case-sensitivity of command-line argument names in
\Condor{submit\_dag}.

\item Fixed the {-r} (remote schedd) option in \Condor{submit\_dag}.

\item Condor versions 6.7.1 through 6.7.5 exhibit a bug in
  which the commands \Condor{off}, \Condor{restart}, and
  \Condor{vacate} did not handle the \Opt{-pool} command-line option
  correctly.
  The bug caused these commands to correctly query the central manager
  of the remote pool,
  and to incorrectly send the command to the central manager machine.
  This bug has now been fixed, and these tools no longer send
  the command to the central manager machine.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-5}Version 6.7.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  This was 6.7.4, but we took 6.7.4 away and replaced it quickly
%  with 6.7.5
\noindent Release Notes:

\begin{itemize}

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added DAG aborting feature -- a DAG can be configured to
abort immediately if a node exits with a given exit value.

\item The dedicated scheduler can now preempt running MPI jobs from 
appropriately configured machines. See 
~\ref{sec:Configure-Dedicated-Preemption} for details.

\item The MPI universe now supports submit files with multiple procs (queue 
commands), each with distinct requirements.  This is useful for placing
the head node of an MPI job on a specific machine, and the rest of the 
nodes elsewhere. See ~\ref{sec:MPI} for details.

\item The \Condor{negotiator} now publishes its own ClassAd to the
  \Condor{collector} which includes the IP address and port where it
  is listening.
  This negotiator ClassAd can be viewed using the new
  \Opt{-negotiator} option with \Condor{status}.
  In addition to removing an unnecessary fixed port for the
  \Condor{negotiator}, this change corrects some problems with
  commands that attempted to communicate directly with the
  \Condor{negotiator}.
  These bugs were first listed in the Known Bugs section of the 6.6.0
  version history.

  To enable this feature and have the \Condor{negotiator} listen on a
  dynamic port, you must comment out the \Macro{NEGOTIATOR\_HOST}
  setting in your configuration file.
  The new example configuration files shipped with version 6.7.4 and
  later will already have this setting undefined.
  However, if you upgrade your binaries and retain an older copy of
  your configuration files, you should consider commenting out 
  \MacroNI{NEGOTIATOR\_HOST}.

  To disable this feature and have the \Condor{negotiator} still
  listen on a well-known port, you can uncomment the
  \MacroNI{NEGOTIATOR\_HOST} setting in the default configuration. 
  For example:
\begin{verbatim}
NEGOTIATOR_HOST = $(CONDOR_HOST)
\end{verbatim}

  Pools that are comprised of older versions of Condor and a 6.7.4 or
  later central manager machine should either continue to use their
  old \File{condor\_config} file (which will still have
  \MacroNI{NEGOTIATOR\_HOST} defined) or they should re-define the
  \MacroNI{NEGOTIATOR\_HOST} setting in the new example configuration
  files which are used during the installation process.

\item Added optional \Expr{DAGMAN\_RETRY\_SUBMIT\_FIRST} configuration
parameter that tells \Condor{dagman} whether to immediately retry
the submit if a node submit fails, or to put that job at the end of
the ready jobs queue.  The default is TRUE, which retries the failed
submit before trying to submit any other jobs.

\item The schedd now uses non-blocking connection attempts when contacting
startds.  This prevents the long (typically 40 second) hang of all schedd
operations when the connection attempt does not complete, due to
network problems.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a performance problem with the standard universe when
\Syscall{gettimeofday} is called in a very tight loop by the application.

\item Fixed the default value of \Macro{OPSYS} in the MacOSX version
  of Condor.
  Once again, Condor reports \verb@OSX@ for all versions of MacOSX.
  This bug was introduced in version 6.7.3 of Condor.

\item Fixed a bug in \Condor{dagman} that caused it to be killed if
the \Expr{DAGMAN\_MAX\_SUBMIT\_ATTEMPTS} parameter was set to too
high a value.

\item Fixed a bug in \Condor{gridmanager} that caused it to crash if
the grid\_monitor was activated.

\item Fixed support for the getdents64() system call inside the
  standard universe on Linux and Solaris.

% Gnats PR 467
\item Fixed a bug in \Condor{dagman} that dealt
incorrectly with the problem of Condor sometimes writing both a
terminated and an aborted event for the same job. The spurious
aborted event is now ignored.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-3}Version 6.7.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item This release contains all the bug fixes from the 6.6 stable
  series up to and including version 6.6.7, and some of the fixes that
  will be included in version 6.6.8.
  The bug fixes in version 6.6.8 that were not included in version
  6.7.3 are listed in a separate section of the 6.6.8 version
  history. 

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added Full Ports of Condor to Redhat Fedora Core 1, 2 and 3 on
the 32-bit x86 architecture. 
Please read the Linux platform specific
section~\ref{sec:platform-linux-fed} in this manual for more information
on caveats with this port.

\item Added a feature to \Condor{dagman} that will allow VARS names to include
numerics and underscores.

\item Added optional \Expr{COLLECTOR\_HOST\_FOR\_NEGOTIATOR} configuration parameter to indicate which \Condor{collector} the  \Condor{negotiator} on this (local) host should query first. This is designed to improve negotiation performance.

\item Added a new \Condor{dagman} capability to allow the DAG to continue
if it encounters a double run of the same node job (set the
\Expr{DAGMAN\_IGNORE\_DUPLICATE\_JOB\_EXECUTION} parameter to true to do this).

\item Added Condor-C: the "condor" grid\_type.  Condor-C allows jobs to be handed from one \Condor{schedd} to another \Condor{schedd}.

\item Added \Opt{setup\_here} option to \Condor{glidein} for cases where
direct installation is desired instead of submitting a setup job to the
remote gatekeeper.  (For example, this is useful when doing an installation
onto AFS.)

\item If \Attr{RemoteOwner} is exported via \Expr{STARTER\_VM\_EXPRS} into the
ad of other virtual machines, the \Condor{negotiator} automatically inserts
\Attr{RemoteUserPrio} into the ad as well, so policy expressions can now take
into account the priority of jobs running on other virtual machines on the
same host.

\item Linux 2.6 kernels do not update the access time for console devices,
so Condor was unable to detect if there has been activity at the keyboard
or mouse. As a work-around, Condor now polls /proc/interrupts to detect
if the keyboard has requested attention. This does not work for USB keyboards
or pseudo TTYs, so \Attr{ConsoleIdle} on 2.6 kernels will be wrong for some
devices. Future versions of Condor or Linux may correct this.

\item \Condor{dagman} no longer removes the X509\_USER\_PROXY environment 
variable.
This should allow users to set the environment variable before invoking 
\Condor{submit\_dag} and have the jobs submitted by \Condor{dagman} correctly
find the proxy file.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a \Condor{dagman} bug that could cause it to leave jobs running
when aborting a DAG.

\item Fixed a \Condor{dagman} bug which, if its debug level was set to
zero (silent), could cause it to to improperly recognize persistent
\Condor{submit} failures.

\item Fixed a bug in Condor's file transfer mechanism that showed up
  when users tried to use streaming output for either STDOUT or
  STDERR.
  There were situations where Condor would attempt to transfer back
  the STDOUT or STDERR file from the execution host, even though these
  files didn't exist and all the data was already streamed back to the
  submit host.
  Now, if either \Attr{stream\_output} or \Attr{stream\_error} are set
  to true in the job submit description file, Condor will transfer any
  other output but will not attempt to transfer back STDOUT or STDERR.

\item The Condor user log library (libcondorapi) now correctly handles
  execute events that lack a hostname.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item Unfortunately, the default \Macro{OPSYS} value for the MacOSX
  version of Condor was incorrectly changed in version 6.7.3.
  Condor used to always report \verb@OSX@, but in version 6.7.3 it
  will report either \verb@OSX10_2@, \verb@OSX10_3@, or
  \verb@OSX_UNK@.
  This is wrong, since Condor jobs submitted to any version of OSX
  should be able to run on any other version of OSX, and the above
  change needlessly partitions resources and complicates things for
  end-users.
  Therefore, anyone running version 6.7.3 on MacOSX is encouraged to
  add the following line to their global \File{condor\_config} file:
\begin{verbatim}
OPSYS = OSX
\end{verbatim}

  If your pool is already running the new release, you can cause the
  above change to take effect by running the following command on your
  pool's central manager machine (or any machine listed in the
  \MacroNI{HOSTALLOW\_ADMINISTRATOR} list) after you have changed the
  \MacroNI{OPSYS} value in your configuration:
\begin{verbatim}
condor_reconfig -all
\end{verbatim}

  However, if you have already submitted jobs to your pool with the
  old \MacroNI{OPSYS} value, the \Attr{Requirements} expression in
  those jobs will still refer to the incorrect value.
  In this case, you should either a) wait for the jobs to complete
  before making the above change, b) remove the jobs and resubmit
  them after you've made the change, or c) manually run \Condor{qedit}
  on the jobs to change their \Attr{Requirements} expressions.

\item When running in recovery mode on a DAG that has PRE scripts,
\Condor{dagman} may attempt more than the specified number of retries
of a node (counting retries attempted during the first run of the
DAG).  This is because if a node fails because of the PRE script
failing, that fact is not recorded in the log, so that retry is missed
in recovery mode.

\end{itemize}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-2}Version 6.7.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Condor Version 6.7.2 includes some bug fixes from Version 6.6.7,
but none from Version 6.6.8.

\item MPI users who are upgrading from previous versions of Condor
to version 6.7.2 will need to modify the 
\Macro{MPI\_CONDOR\_RSH\_PATH} configuration macro of their dedicated
resource to be \MacroU{LIBEXEC} instead of \MacroUNI{SBIN}.
Users who are installing Condor version 6.7.2
for the first time will not need to make any changes.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added an \Macro{INCLUDE} configuration file variable
   to define the location of header files shipped with Condor
   that are currently needed to be included when compiling
   Condor APIs.
   When \MacroNI{INCLUDE} is defined,
   \Condor{config\_val} can be used to list header files.


\item A Condor pool can now support multiple Collectors. This should
  improve stability due to automatic failover. All daemons will now
  send updates to ALL of the specified collectors. All daemons/tools
  will query the Collectors in sequence, until an appropriate 
  response is received. Thus if one (or more) of the Collectors are 
  down, the pool will continue to function normally, as long as 
  there is at least one functioning Collector. 
  You can specify multiple (comma-separated) collector host (and port) 
  addresses in the \Expr{COLLECTOR\_HOST} entry in the configuration
  file. A given \Condor{master} can only run one Collector.

\item When the \Condor{master} is started with the \Opt{-r} option to
  indicate that it should quite after a period of time, the
  \Condor{startd} will now indicate how much time is remaining before it
  exits. It does this by advertising TimeToLive in the machine
  ClassAd.

\item Added new macro \Macro{JOB\_START\_COUNT} that works in
conjunction with existing macro \Macro{JOB\_START\_DELAY} to 
throttle job starts.
Together, this macro pair provides greater flexibility
tuning job start rate given available \Condor{schedd} performance.

\item Added a \MacroNI{LIBEXEC} directory to the install process.
Support commands that
the Condor system needs will be added to this directory in future releases.
This directory should not be added to a user or system-wide path.  

\item Added the ability to decide for each file that condor transfers whether
it should be encrypted or not, using encrypt\_input\_files, 
dont\_encrypt\_input\_files, encrypt output files, and
        dont\_encrypt\_output\_files in the job's submit file.

\item Added DISABLE\_AUTHENTICATION\_IP\_CHECK which will work around problems
on dual-homed machines where the IP address is reported incorrectly to condor.
This is particularly a problem when using Kerberos on multi-homed machines.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug on Linux systems caused by both 
      Condor and the Linux distribution having a library file 
      called \File{libc.a}.
      The problem caused the link step to fail on Condor API
      programs.
      The evaluation order to determine the location of library
      files caused use of the wrong file, given the duplicate naming.
      The bug is fixed by renaming the Condor library files.

\item When the \Condor{startd} is evaluating the state of each virtual
  machine (VM), it now refreshes any ClassAd attributes which are
  shared from other virtual machines (using \Expr{STARTD\_VM\_EXPRS})
  before it tries to evaluate.
  This way, if a given VM changes its state, all other VMs will
  immediately see this state change.

\item Fixed a bug where you couldn't transfer input files larger than 2 gigabytes.

\item Condor can now detect the size of memory on a Linux machine with the 2.6
kernel.

\item JAR files specified in the submit file were not being transfered
along with the job unless they were also explicitly placed in the list
of input files to transfer. Now, the JAR files are implicitly added to the
list of input files to transfer.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-1}Version 6.7.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.1 contains all of the features, ports, and bug fixes
  from the previous stable series, up to and including version 6.6.6.
  There are a few additional bugs that have been fixed in the 6.6.x
  stable series which have not yet been released, but which will
  appear in version 6.6.7.
  These bug fixes have been included in version 6.7.1, and appear in
  the ``Bugs fixes included from version 6.6.7'' list below.
  In addition, a number of new features and some bug fixes have been
  made, which are described below in more detail.

\item None.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added an option to DAGMan's retry ability. If a DAG specifies
  something like ``RETRY job 10 unless-exit 9'', then the retries will
  only happen if the node doesn't exit with a value of 9. 

\item Condor-G can now submit jobs to Globus 3.2 (WS) (for jobs with 
  \Expr{universe = grid}, \Expr{grid\_type = gt3}). Submitting to Globus 
  3.0 (as in Condor 6.7.0) is no longer supported. Submitting to pre-WS 
  Globus (2.x) is still supported (\Expr{grid\_type = gt2}).

\item Added new startd policy expression MaxJobRetirementTime.  This
specifies the maximum amount of time (in seconds) that the startd
is willing to wait for a job to finish on its own when the startd
needs to preempt the job (for owner preemption, negotiator preemption,
or graceful startd shutdown).

\item Added -peaceful shutdown/restart mode.  This will shut down the
startd without killing any jobs, effectively treating both
\Expr{MaxJobRetirementTime} and \Expr{GRACEFUL\_SHUTDOWN\_TIMEOUT} as
infinite.  The default shutdown/restart mode is still -graceful, which
behaves according to whatever \Expr{MaxJobRetirementTime} and
\Expr{GRACEFUL\_SHUTDOWN\_TIMEOUT} are.  The behavior of -fast mode
is unchanged; it kills jobs immediately, regardless of the other
timeout settings.

\item Jobs can now be submitted as ``noop'' jobs. Jobs submitted with
  \Expr{noop\_job = true} will not be executed by Condor, and instead will
   immediately have a terminate event written to the job log file and 
   removed from the queue. This is useful for DAGs where the pre-script
   determines the job should not run.

\item Added preliminary support for the Tool Daemon Protocol (TDP)
  into Condor.
  This protocol is still under development, but the goal is to provide
  a generic way for scheduling systems (daemons) to interact with
  monitoring tools.
  Assuming this protocol is adopted by other scheduling systems and by
  various monitoring tools, it would allow arbitrary combinations of
  tools and schedulers to co-exist, function properly, and provide
  monitoring services for jobs running under the schedulers.
  This initial support allows users to specify a ``tool'' that should
  be spawned along-side their regular Condor job.
  On Linux, the ability to have the batch Condor job suspend
  immediately upon start-up is also implemented, which allows a
  monitoring tool to attach with ptrace() before the job's main()
  function is called.

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a significant memory leak in the \Condor{schedd} that was
  introduced in version 6.7.0.
  In 6.7.0, the \Condor{schedd} would leak a copy of ClassAd for every
  job it tried to spawn (on average, around 2000 bytes per job).

\item Fixed the bugs in Condor's MPI support that were introduced in
  version 6.7.0.
  Condor now supports MPI jobs linked with MPICH 1.2.4 and older.
  Improved Condor's log messages and email notifications when MPI jobs
  run on multiple virtual machines (the messages now include the
  appropriate ``vmX'' identifier, not just the hostname).
  Unfortunately, due to changes in MPICH between version 1.2.4 and
  1.2.5, Condor's MPI support is not compatible with MPICH 1.2.5.
  We will be addressing this problem in a future release.

\end{itemize}

\noindent Bugs fixes included from version 6.6.7:

\begin{itemize}

\item Fixed an important bug in the low-level code that Condor uses to
  transfer files across a network.
  There were certain temporary failure cases that were being treated
  as permanent, fatal errors.
  This resulted in file transfers that aborted prematurely, causing
  jobs to needlessly re-run.
  The code now gracefully recovers from these temporary errors.
  This should significantly help throughput for some sites,
  particularly ones that transfer very large files as output from
  their jobs.

\item Fixed a number of bugs in the \Opt{-format} option to \Condor{q}
  and \Condor{status}.
  Now, these tools will properly handle printing boolean expressions
  in all cases.
  Previously, depending on how the boolean evaluated, either the
  expression was printed, or the tool could crash.
  Furthermore, the tools do a better job of handling the different 
  types of format conversion strings and printing out the appropriate
  value.
  For example, if a user tries to print out a boolean attribute with
  \verb@condor_status -format "%d\n" HasFileTransfer@, the
  \Condor{status} tool will evaluate \Attr{HasFiletransfer} and print
  either a 0 or a 1 (FALSE or TRUE).
  If, on the other hand, a user tries to print out a boolean attribute
  with \verb@condor_status -format "%s\n" HasFileTransfer@, the
  \Condor{status} tool will print out the string ``FALSE'' or ``TRUE''
  as appropriate.

\item The ClassAd attribute scope resolution prefixes, \texttt{MY.}
  and \texttt{TARGET.}, are no longer case sensitive.

\item \Condor{dagman} now does better checking for inconsistent events
(such as getting multiple terminate events for a single job).  This
checking can be disabled with the \Opt{-NoEventChecks} command-line
option.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{\label{sec:New-6-7-0}Version 6.7.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item Version 6.7.0 contains all of the features, ports, and bug fixes
  from the previous stable series, up to and including version 6.6.4.
  In addition, a number of new features and some bug fixes have been
  made, which are described below in more detail.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added support for vanilla and Java jobs to reconnect when the
  connection between the submitting and execution nodes is lost for
  any reason.
  Possible reasons for this disconnect include: network outages,
  rebooting the submit machine, restarting the Condor daemons on the
  submit machine, etc.
  If the execution machine is rebooted or the Condor daemons are
  restarted, reconnection is not possible.
  To take advantage of this reconnect feature, jobs must be submitted
  with a \Attr{JobLeaseDuration}.
  There are new events in the UserLog related to disconnect and
  reconnect.

\item Added a new Condor tool, \Condor{vacate\_job}.
  This command is similar to \Condor{vacate}, except the kinds of
  arguments it takes define jobs in a job queue, not machines to
  vacate.
  For example, a user can vacate a specific job id, all the jobs in a
  given cluster, all the jobs matching a job queue constraint, or even
  all jobs owned by that user.
  The owner of a job can always vacate their own jobs, regardless of
  the pool security policy controlling \Condor{vacate} (which is an
  administrative command which acts directly on machines).
  See the new command reference, section~\ref{man-condor-vacate-job}
  on page~\pageref{man-condor-vacate-job} for details.
  
\item Added a new ``High Availability'' service to the \Condor{master}.
   You can now specify a daemon which can have ``fail over'' capabilities
   (i.e. the master on another machine can start a matching daemon if the
   first one fails).  Currently, this is only available over a shared
   file system (i.e. NFS), and has only been tested for the \Condor{schedd}.

\item Scheduler universe jobs on UNIX can now specify a
  \Attr{HoldKillSig}, the signal that should be sent when the job is
  put on hold.
  If not specified, the default is to use the \Attr{KillSig}, and if
  that is not defined, the job will be sent a SIGTERM.
  The submit file keyword to use for defining this signal is
  \AdAttr{hold\_kill\_sig}, for example,
  \verb@hold_kill_sig = SIGUSR1@.

\item The \Condor{startd} can now support policies on SMP machines
  where each virtual machine (VM) has knowledge of the other VMs on
  the same host.
  For example, if a job starts running on one of the VMs, a job
  running on another VM could immediately be suspended.
  This is accomplished by using the new configuration variable
  \Macro{STARTD\_VM\_EXPRS}, which is a list of ClassAd attribute
  names that should be shared across all VMs on the machine.
  For each VM on the machine, every attribute in this list is looked
  up in the VM-specific machine ClassAd, the attribute name is given a
  prefix indicating what VM it came from, and then inserted into the
  machine ClassAds of all the other VMs.

\item The \Condor{startd} publishes four new attributes into the
  machine ClassAds it generates when it is in the Claimed state:
  \Attr{TotalJobRunTime}, \Attr{TotalJobSuspendTime},
  \Attr{TotalClaimRunTime}, \Attr{TotalClaimSuspendTime}.
  These attributes keep track of the total time the resource was
  either running a job (in the Busy activity) or had a job suspended,
  regardless of how many suspend/resume cycles the job went through.
  The first two attributes (with ``Job'' in the name) keep track for a
  single job (i.e. since the last time the resource was
  Claimed/Idle). 
  The last two attributes (with ``Claim'' in the name) keep track of
  these totals across all jobs that ran under the same claim
  (i.e. since the last state change into the Claimed state).

\item Added a \Opt{-num} option to the \Condor{wait} tool to wait for
   a specified number of jobs to finish.

\item Added a configuration option \Macro{STARTER\_JOB\_ENVIRONMENT}
   so the admin can configure the default environment inherited by
   user jobs.

\item Added a (configurable, defaults to off) feature to the \Condor{schedd}
   to allow backup the spool file before doing anything else.

\item The "Continuous" option of the \Condor{startd} ``cron'' jobs is
being deprecated.   It's being replaced by two new options which
control separate aspects of it's behavior:
\begin{itemize}
\item "WaitForExit" specifies the "exit timing" mode
\item "ReConfig" specifies that the job can handle SIGHUPs, and it should 
be sent a SIGHUP when the \Condor{startd} is reconfigured.
\end{itemize}

\item A lot of the items logged by the \Condor{startd} ``cron'' logic,
changed to D\_FULLDEBUG (from D\_ALWAYS), etc.

\item Added \Macro{NEGOTIATOR\_PRE\_JOB\_RANK} and
\Macro{NEGOTIATOR\_POST\_JOB\_RANK}.  These expressions are applied
respectively before and after the user-supplied job rank when deciding
which of the possible matches to choose.  (The existing expression
\Macro{PREEMPTION\_RANK} is applied after
\Macro{NEGOTIATOR\_POST\_JOB\_RANK}.)  The pool administrator may use
these expressions to steer jobs in ways that improve the overall
performance of the pool.  For example, using the pre job rank,
preemption may be avoided as long as there are idle machines, even
when the user-supplied rank expression prefers a machine that happens
to be busy.  Using the post job rank, one could steer jobs towards
machines that are known to be dedicated to batch jobs, or one could
enforce breadth-first instead of depth-first filling of a cluster of
multi-processor machines.

\item Added the ability for Condor to transfer files larger than 2G on
platforms that support large files.  This works automatically for
transferred executables, input files and output files.

\item Added the ability for jobs to stream back standard input, output, and
error files while running.  This is activated by the \Opt{stream\_input},
\Opt{stream\_output}, and \Opt{stream\_error} options to \Condor{submit}.
Note that this feature is incompatible with the new feature described
above where the shadow and starter can reconnect in certain
circumstances. 

\item Added support for vanilla jobs to be mirrored on a second
  \Condor{schedd}. The jobs are submitted to the second \Condor{schedd}
  on hold and will be released if the second \Condor{schedd} hasn't
  heard from the first \Condor{schedd} (actually, a \Condor{gridmanager}
  running under the first \Condor{schedd}) for a configurable amount of
  time. Once the second \Condor{schedd} releases the jobs, the first
  \Condor{schedd} acts as a mirror, reflecting the state of the jobs on
  the second \Condor{schedd}.
  To use this mirroring feature, jobs must be submitted
  with a \Attr{mirror\_schedd} parameter in the submit file and require
  no file transfer.

\end{itemize}


\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug in the \Condor{startd} ``cron'' logic which caused the
\Condor{startd} to except when trying to delete a job that could never
be run (i.e. invalid executable, etc).

\item Fixed a bug in \Condor{startd} ``cron'' logic which caused it to
not detect when the starting of a ``job'' failed.

\item Fixed several bugs in the reconfiguration handling of the
\Condor{startd} ``cron'' logic.  In particular, even if the job has
the "reconfig" option set (or "continuous"), the job(s) won't be sent
a SIGHUP when the startd first starts, or when the job itself is first
run (until it outputs its first output block, defined by the "-"
separator).

\end{itemize}


\noindent Known Bugs:

\begin{itemize}

\item Condor's MPI support (for MPICH 1.2.4) was broken by other
  changes in version 6.7.0.
  Support for MPI jobs will return in Condor version 6.7.1.

\end{itemize}
\begin{center}
\begin{table}[hbt]
\begin{tabular}{|ll|} \hline
\emph{Architecture} & \emph{Operating System} \\ \hline \hline
Hewlett Packard PA-RISC (both PA7000 and PA8000 series) & HPUX 10.20 \\ \hline
Sun SPARC Sun4m,Sun4c, Sun UltraSPARC & Solaris 2.6, 2.7, 8, 9 \\ \hline
Silicon Graphics MIPS (R5000, R8000, R10000) & IRIX 6.5 (clipped) \\ \hline
Intel x86 & Red Hat Linux 7.1, 7.2, 7.3, 8.0 \\
 & Red Hat Linux 9 \\
 & Windows 2000 Professional and Server, 2003 Server (clipped) \\
 & Windows XP Professional (clipped) \\ \hline
ALPHA & Digital Unix 4.0 \\
 & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\
 & Tru64 5.1 (clipped) \\ \hline
PowerPC & Macintosh OS X (clipped) \\
 & AIX 5.2L (clipped) \\ \hline
Itanium & Red Hat Linux 7.1, 7.2, 7.3 (clipped) \\
 & SuSE Linux Enterprise 8.1 (clipped) \\ \hline
\end{tabular}
\caption{\label{supported-platforms}Condor 6.7.0 supported platforms}
\end{table}
\end{center}
