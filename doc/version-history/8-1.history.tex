%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!
%%%      PLEASE RUN A SPELL CHECKER BEFORE COMMITTING YOUR CHANGES!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\label{sec:History-8-1}Development Release Series 8.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

This is the development release series of HTCondor.
The details of each version are described below.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-6}Version 8.1.6}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.6 released on May 22, 2014.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item HTCondor can discover, schedule, and manage GPUs in an
exceedingly simple way by inserting
\begin{verbatim}
  use feature : GPUs
\end{verbatim}
in the configuration file.
The HTCondor wiki page, 
\URL{https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=HowToManageGpus},
describes the capabilities.

\item The grid universe can now be used to submit and manage jobs on
a BOINC server, using the new grid type \SubmitCmdNI{boinc}.
\Ticket{3540}

\item Configuration has been enhanced in structure and with
newly implemented semantics describing configuration.
As part of this effort, most all configuration variables have
compile-time defaults specified and incorporated into the code.
Therefore, they no longer appear in the example, distributed
configuration file.
It is only when values change that these variables will be placed
into a configuration file.
For current installations wishing to transition to the new, stripped down
configurations files, 
the new \Opt{-writeconfig} option to \Condor{config\_val} will
help to identify values different from defaults.
New configuration semantics permit
\begin{itemize}
  \item the inclusion of configuration defined elsewhere.
  See section~\ref{sec:Config-Include} for a description.
  \item metaknobs, which incorporate predefined sets of configuration
  that are commonly used.
  See section~\ref{sec:Config-Metaknobs} for a description.
  \item a simple if/else syntax for conditional specification of 
  configuration. 
  See section~\ref{sec:Config-IfElse} for a description.
\end{itemize}
\Ticket{4325}
\Ticket{3894}
\Ticket{4319}
\Ticket{4031}
\Ticket{4211}

\item When hierarchical group quotas are used, and surplus
sharing is enabled, the quotas are now correctly computed
if slot weights are also enabled.
\Ticket{4324}

\item The default priority factor set for new users is now 1000.
This was changed from a default value of 1, because a value of 1 
leaves no room to boost the priority factor.
\Ticket{4282}

\item The \Condor{schedd} may now keep open a configurable number
of job event log files.
This improves performance over the previous behavior of
open, write, close done for each event.
New configuration variables \Macro{USERLOG\_FILE\_CACHE\_MAX} and 
\Macro{USERLOG\_FILE\_CACHE\_CLEAR\_INTERVAL} specify the number
of job event log files that may be kept open at the same time
and the periodic interval of time that passes
before the set of open files are closed.
\Ticket{4040}

\item The curl file transfer plug-in can now be used to transfer output
files in addition to input files.
\Ticket{4190}

\item New python bindings allow the user access to the same 
file locking protocol as HTCondor daemons.
\Ticket{4315}

\item The DAGMan node status file formatting has changed.
The format of the DAG node status file is now New ClassAds,
and the amount of information in the file has increased.
Section~\ref{sec:DAG-node-status} has details on node status files.
\Ticket{4115}

\item The new configuration variable \Macro{STARTER\_LOG\_NAME\_APPEND}
controls the file name extension of the log used by the \Condor{starter}.
\Ticket{4244}

\item The new configuration variable
 \Macro{ENVIRONMENT\_VALUE\_FOR\_UnAssigned<name>}
is intended for use with GPUs, where \texttt{<name>} is \texttt{GPUs}. 
It defines what GPU ID to assign to slots that have no assigned GPU.
Without this, the CUDA runtime would allow slots with no assigned GPU to use
all of the GPUs.
\Ticket{4320}

\item The batch system name \texttt{HTCondor} is now published in 
each job's environment.
\Ticket{4233}

\item New configuration variables \Macro{UDP\_NETWORK\_FRAGMENT\_SIZE} and
	\Macro{UDP\_LOOPBACK\_FRAGMENT\_SIZE} added to control UDP message
	fragmentation size over the network and loopback interface, 
	respectively.
\Ticket{4321}

\item The new \Condor{pool\_job\_report} tool for Linux platforms
composes and mails a report about all jobs run in the previous
24 hours on all execute machines within the pool. 
\Ticket{4267}

\item HTCondor now publishes more I/O statistics as job ClassAd attributes.
The new attributes are
\Attr{BlockReads},
\Attr{BlockWrites},
\Attr{RecentBlockReads},
\Attr{RecentBlockWrites},
\Attr{RecentBlockReadKbytes}, and
\Attr{RecentBlockWriteKbytes}.
\Ticket{3850}

\item The new job ClassAd attribute \Attr{SpoolOnEvict} facilitates
the debugging of failed jobs.
\Ticket{4292}

\item Memory corruption mitigation is enabled by additional linker flags,
when building HTCondor from source against system-shared
libraries installed by the distribution.
\Ticket{4153}

\item An experimental new feature to overlap the transfer of job output
with the execution of a subsequent job is documented with a link from
the HTCondor wiki page, 
\URL{https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=ExperimentalFeatures}.
\Ticket{4291}

\item An experimental new feature to provide custom output formatting
for \Condor{q} and \Condor{status} is documented with a link from
the HTCondor wiki page, 
\URL{https://htcondor-wiki.cs.wisc.edu/index.cgi/wiki?p=ExperimentalFeatures}.
\Ticket{4241}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item The \Condor{shared\_port} daemon no longer blocks
on a very unresponsive daemon.
\Ticket{4314}

\item vm universe jobs now report attribute \Attr{RemoteUserCPU} when
run on a KVM hypervisor.
CPU usage remains unreported by VMware hypervisors.
\Ticket{4337}

\item The \Condor{gridmanager} no longer assumes that a NorduGrid ARC job
with a reported exit code greater than 128 exited abnormally via a signal.
\Ticket{4342}

\item Many tools, including \Condor{off} and \Condor{restart} interpreted
the command line argument \Opt{-defrag} incorrectly as \Opt{-debug},
since both words start with the string \AdStr{de}.
The confusion has been fixed. 
Use of \Opt{-defrag} will now produce an error message, 
since it is not a valid option for these tools.
\Ticket{3717}

\item Fixed a crash by the \Condor{gpu\_discovery} tool,
when running on a 32-bit platform or on Windows and detecting via OpenCL.
\Ticket{4339}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-5}Version 8.1.5}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.5 released on April 15, 2014.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The default configuration now implements a policy 
that disables preemption.
\Ticket{4281}

\item The protocol for interaction between \Condor{q} and the 
\Condor{schedd} daemon has been rewritten.
The new protocol does not require the \Condor{schedd} to fork a child process 
and does not cause blocking; 
the result is that the \Condor{schedd} should be able to handle
many concurrent \Condor{q} requests with minimal resource usage.
\Ticket{4111}

\item The specification in configuration for the size or amount of time
that a log file may grow has changed.
An explicit size or amount of time may still be specified for any
individual log file.
However, any log files not explicitly specified have a default maximum
size specified by the new configuration variable 
\Macro{MAX\_DEFAULT\_LOG}.
\Ticket{4246}

\item The new \Condor{urlfetch} tool is enables the  acquisition of
configuration with a query to a URL.
\Ticket{4018}

\item The \Prog{cream\_gahp} and \Prog{nordugrid\_gahp} can now talk to
servers over IPv6.
\Ticket{4243}

\item The python bindings can now accept a list of \Condor{collector} hosts
in the constructor of the \texttt{Collector} object.  
This eases use of the bindings for high availability setups.
\Ticket{4245}

\item The new python binding \texttt{transaction} creates a transaction
with the \Condor{schedd},
providing a way to submit multiple clusters of jobs
or edit multiple attributes atomically.
\Ticket{4225}

\item New configuration variable \Macro{NEGOTIATOR\_MAX\_TIME\_PER\_CYCLE}
places an upper time limit on the time spent in each negotiation cycle.
\Ticket{4271}

\item The configuration variable \Macro{VALID\_SPOOL\_FILES} has been redefined
to list only files that the system administrator determines must not
be removed by \Condor{preen}.
The new configuration variable \Macro{SYSTEM\_VALID\_SPOOL\_FILES} contains 
a predetermined list of files that are known to be valid at 
the time HTCondor was built. 
\Condor{preen} will use the union of these two configuration variables 
as the set of valid files that should not be removed from the \MacroNI{SPOOL}
directory.
\Ticket{4257}

\item The new configuration variable \Macro{OFFLINE\_MACHINE\_RESOURCE\_<name>}
is used to identify a custom machine resource as offline,
so that the resource will not be allocated to any slot.
\Ticket{4177}

\item The default value of configuration variable 
\Macro{NEGOTIATOR\_USE\_WEIGHTED\_DEMAND} has been changed from 
\Expr{False} to \Expr{True}.
\Ticket{4238}

\item The new configuration variable 
\Macro{NEGOTIATOR\_TRIM\_SHUTDOWN\_THRESHOLD} can be used to avoid 
making matches to resources that are about to go away. 
It is primarily of interest to glidein pools.  
Section~\ref{param:NegotiatorTrimShutdownThreshold} details the new
configuration variable.
\Ticket{4266}

\item No user-visible changes result from reductions in the quantity of
unused memory within DaemonCore data structures.
\Ticket{4206}

\item The \Condor{negotiator} logs more information about its round robin
iteration to ease debugging.
\Ticket{3871}

\item Some communications between daemons will cause fewer network timeouts,
as the reading of commands no longer blocks while
waiting for completion of the command.
\Ticket{4237}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a bug that affected \Condor{on}, \Condor{off}, \Condor{restart},
\Condor{reconfig}, and \Condor{set\_shutdown}. 
When multiple machines were named on the command line, 
these tools could report 
\begin{verbatim}
Can't find address for master XXXX 
\end{verbatim}
for some daemons,
even though the daemons were properly advertised to the \Condor{collector}.
\Ticket{4207}

\item Fixed a bug that could have caused the \Condor{startd} to become 
unresponsive when starting a job obtained via the Work Fetch Hook.
\Ticket{4210}

\item Fixed a bug that could have caused the \Condor{schedd} to advertise a 
stale address in the \Attr{ScheddIpAddr} attribute of its submitter ClassAds,
resulting in other daemons being unable to contact it.
The problem occurred when using both the \Condor{shared\_port} daemon and CCB,
and the value of configuration variable \Macro{CCB\_ADDRESS} was changed.
\Ticket{4250}

\item Fixed a bug introduced earlier in the 8.1 developer series that 
could cause \Condor{submit} to crash when reading 
large submit description files.
\Ticket{4260}

\item Fixed a bug that prevented a configuration variable 
from referring to itself,
when the previous value was defined by the code,
rather than within a configuration file.
\Ticket{4256}

\item The temperature attributes output by the \Condor{gpu\_discovery} tool
contained values represented in Celsius, while
the names of these attributes ended in the letter 'F,' implying Fahrenheit.
The names of these attributes have been changed to end with the letter 'C.' 
For instance \Attr{<name>DieTempF} has been changed to \Attr{<name>DieTempC}.
\Ticket{4294}

\item The \Condor{startd} no longer generates this erroneous message
when a plugin can not be run:
\begin{verbatim}
Warning: Starter pid XXX is not associated with a claim.
A slot may fail to transition to Idle.
\end{verbatim}
\Ticket{4026}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-4}Version 8.1.4}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.4 released on February 27, 2014.

\item This version of HTCondor includes all bug fixes from version 8.0.6,
as well as the new full port for the Red Hat Enterprise Linux 7.0 \emph{Beta} 
release on the x86\_64 architecture.
A full port includes support for the standard universe. 

\end{itemize}


\noindent New Features:

\begin{itemize}

\item When configured to use partitionable slots,
those slots running jobs can now be preempted by the 
\Condor{negotiator} daemon based on the value of 
the machine's configuration of \MacroNI{RANK}.
\Ticket{3667}

\item Improved support for publishing monitoring information about an
HTCondor pool to \TM{Ganglia}.
Added Ganglia statistics for total job starts and total job preemptions
within a \Condor{startd}.
This allows Ganglia to graph the total job preemptions
across all \Condor{startd} daemons in a pool.
See section~\ref{sec:Config-gangliad} for configuration variable definitions,
and section~\ref{sec:monitor-ganglia} for details about monitoring
with Ganglia.
\Ticket{4151}
\Ticket{3965}

\item The grid universe can now be used to create and manage VM instances
in Google Compute Engine (GCE), using the new grid type \SubmitCmdNI{gce}.
\Ticket{3833}

\item As a scalability improvement for Unix platforms, 
the \Condor{shared\_port} daemon no longer forks on incoming connections.
\Ticket{4094}

\item \Condor{ssh\_to\_job} and interactive jobs no longer try to 
connect to held jobs.
They instead report the hold and the reason why the job is being held.
\Ticket{3867}

\item Improved the restart time of the \Condor{schedd} after it has crashed.
\Ticket{4169}

\item The new configuration variable \Macro{EC2\_RESOURCE\_TIMEOUT} sets
the amount of time that HTCondor will wait for an unresponsive EC2 service 
before placing the corresponding jobs on hold.
\Ticket{4113}

\item The new python binding \Procedure{refreshGSIProxy}
can refresh a remote job's GSI proxy as a part of the \texttt{Schedd} object.
\Ticket{4116}

\item By default, 
the TCP keep alive interval is automatically tuned to 5 minutes.  
This causes at least one packet to be sent on established,
but idle, TCP connections once every 5 minutes, 
and it speeds up the detection of connections that were silently dropped 
by NAT or firewall devices.
Without this, 
the \Condor{shadow} may not reliably recover from transient network failures.
This behavior is controlled by the new configuration variable
\Macro{TCP\_KEEPALIVE\_INTERVAL}.
Setting this variable to 0 restores the prior behavior.
In addition, the configuration variable \Macro{CCB\_HEARTBEAT\_INTERVAL} 
default value has been reduced to 5 minutes.
\Ticket{4122}

\item New python \Code{ClassAd} module function calls 
\Procedure{Attribute}, \Procedure{Function}, \Procedure{Literal},
\Procedure{flatten}, \Procedure{matches}, and \Procedure{symmetricMatch}
aid the composition of ClassAd expressions.
It should now be possible to build expressions directly
in python, without having to resort to string manipulation.
\Ticket{4154}

\item For those that use the Python bindings,
the \Env{LD\_LIBRARY\_PATH} environment variable no longer needs to be set.
\Ticket{4128}

\item The Python bindings are now compatible with Python 3.
\Ticket{4146}


\item Setting configuration variable
\Macro{DAGMAN\_ALWAYS\_USE\_NODE\_LOG} to \Expr{False}
or using the corresponding \Opt{-dont\_use\_default\_node\_log} option
to \Condor{submit\_dag} is no longer recommended.
It is no longer recommended to have \Condor{dagman} read the log files 
specified in the node job submit description files.
\Ticket{4091}

\item Invoking \Condor{fetchlog} with the \Arg{STARTD\_HISTORY} argument
now fetches all \Condor{startd} history by concatenating all instances 
of log files resulting from rotation to the current history log.
\Ticket{4152}

\item Several general mechanisms for specifying user-defined \Condor{startd} 
resources have been enhanced,
so that GPUs can be easily defined and used.
New to this 8.1.4 version of HTCondor is the allocation of user defined
resources (especially GPUs) with partitionable and dynamic slots.
This includes having HTCondor automatically set the environment variable
\Env{CUDA\_VISIBLE\_DEVICES} for jobs that use CUDA GPUs
and \Env{GPU\_DEVICE\_ORDINAL} for jobs that use OpenCL GPUs.

The mechanism defines configuration variables 
\Macro{MACHINE\_RESOURCE\_<name>} and 
\Macro{MACHINE\_RESOURCE\_INVENTORY\_<name>}
to specify the definition user-defined resources with a list of resource
identifiers.  
When HTCondor allocates one of these user-defined resources to a slot, 
it will also publish this assignment within the slot's ClassAd 
using the new job ClassAd attribute \Attr{Assigned<name>}.
And, it will define in the job's environment the variable
\Env{\_CONDOR\_Assigned<name>}.
The new configuration variable \Macro{ENVIRONMENT\_FOR\_Assigned<name>}
also sets further environment variables.
\Ticket{4141}
\Ticket{4148}

\item The new \Condor{gpu\_discovery} tool detects CUDA and OpenCL GPUs,
reporting them in the format needed to configure GPU resources 
using the configuration variable
\Macro{MACHINE\_RESOURCE\_INVENTORY\_GPUs}.
\Ticket{3386}

\item Two new pre-defined configuration variables are referenced with
\MacroU{DETECTED\_PHYSICAL\_CPUS} and \MacroU{DETECTED\_CPUS}.
\MacroUNI{DETECTED\_PHYSICAL\_CPUS} contains the number of 
physical (non-hyperthreaded) CPUs. 
\MacroUNI{DETECTED\_CPUS} will match the value of
either \MacroNI{DETECTED\_CORES} or \MacroNI{DETECTED\_PHYSICAL\_CPUS}, 
depending on the state of \Macro{COUNT\_HYPERTHREAD\_CPUS}.
The default value of \Macro{NUM\_CPUS} now defaults to the value
of \MacroNI{DETECTED\_CPUS}.
\Ticket{4197}

\item \Condor{q} will now show the macro-expanded job description from the attribute
\Attr{MATCH\_EXP\_JobDescription} instead of \Attr{JobDescription} if it is available.
\Ticket{4110}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item Fixed a small memory leak that was triggered by failed
file transfer attempts.
\Ticket{4134}

\item Fixed a bug that would leak one socket in each daemon,
when \Expr{NO\_DNS = True}.
\Ticket{4140}

\item Changed the way the \Condor{startd} allocates CPUs to
slots in configurations where there are more slots than CPUs.
CPUs are now distributed equally between slots that are not configured
to receive a specific number 
(using configuration variable \Macro{SLOT\_TYPE\_<N>}).
Before this change, these slots received 1 CPU each.
The new behavior matches how other slot resources are distributed.
\Ticket{3249}

\item The failure to terminate an EC2 grid universe job instance,
because the instance no longer exists at the service, 
is now considered a successful termination.  
This allows EC2 grid universe jobs to exit the queue, 
if the service purges termination records quickly.
\Ticket{4133}

\item HTCondor now interacts with EC2 services by using \Code{POST}
instead of \Code{GET},
which permits more services to accept user data with size greater than 8Kbytes.
\Ticket{4004}

\item Improved the handling of the \SubmitCmd{coresize} 
submit description file command,
by allowing values larger than 4Gbytes.
\Ticket{4155}

\item Fixed a bug that caused job arguments to not be displayed in the
default output of \Condor{q} when the submit description file used the
new syntax for job arguments.
\Ticket{2875}

\item The \Condor{startd} daemon will no longer abort when it exhausts
the supply of user-defined resources such as GPUs 
while assigning automatic resource shares to slots.
\Ticket{4176}

\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-3}Version 8.1.3}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.3 released on December 23, 2013.
This developer release contains all bug fixes from HTCondor version 8.0.5.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item The parsing of configuration has changed with respect to how
line continuation characters and comments interact.
The line continuation character no longer takes precedence over the
comment character.
\Ticket{4027}

\index{SUBSYS\_SUPER\_ADDRESS\_FILE macro@\texttt{<SUBSYS>\_SUPER\_ADDRESS\_FILE} macro}
\index{configuration macro!\texttt{SUBSYS\_SUPER\_ADDRESS\_FILE}}
\item When the super user issues a command 
or when the new \Condor{sos} tool invokes another tool,
the command can be serviced with a higher priority. 
This should be useful when attempting to get information from an
overloaded daemon, in order to diagnose or fix a problem.
Commands directed at the \Condor{schedd} or \Condor{collector} daemons 
have this ability by default.
Other DaemonCore daemons require configuration using the new 
configuration variable
\MacroB{<SUBSYS>\_SUPER\_ADDRESS\_FILE}.
\Ticket{4029}

\item The dedicated scheduler cpu usage within the \Condor{schedd} is now
throttled, so that it cannot consume all of the cpu, while starving the vanilla
scheduler.  This throttle can be adjusted by the new configuration variable
\Macro{DEDICATED\_SCHEDULER\_DELAY\_FACTOR}.  
This variable, which defaults to five,
sets the ratio of time spent not in the dedicated scheduler to the 
time scheduling parallel jobs.  
With this default of five, 
a maximum of 20\% of the scheduler's time will go to scheduling
parallel jobs.
\Ticket{4048}

\item The new \Condor{defrag} daemon ClassAd attribute 
\Attr{MeanDrainedArrived}
measures the mean time between arrivals of fully drained machines,
and the new attribute \Attr{DrainedMachines} 
measures the total numbers of fully drained machines
which have arrived during the run time of this \Condor{defrag} daemon.
\Ticket{4055}

\item The new \Opt{-defrag} option for \Condor{status} queries ClassAds
of the \Condor{defrag} daemon.
\Ticket{4039}

\item Machine ClassAd attributes \Attr{ExpectedMachineQuickDrainingCompletion}
and \Attr{ExpectedMachineGracefulDrainingCompletion} are updated with their
completion times if there are no active claims,
making these attributes more useful in setting policy for
partitionable slots. 
\Ticket{3481}

\item In a DAG, the node retry number is now available as VARS macro
(see section~\ref{dagman:VARS}).
\Ticket{4032}

\item Macro substitution both within configuration and within submit
description files has been extended to specify and use  
an optional default value if a value is not defined.
Section~\ref{sec:Config-File-Macros} has details for configuration.
\Ticket{4033}

\item The Python bindings \Code{htcondor} module has 
a new \Procedure{read\_events} method to acquire an iterator of
an HTCondor event log file.
\Ticket{4071}

\item The new \Opt{-daemons} option to \Condor{who} prints information
about the HTCondor daemons running on the specified machine,
including the daemon's PID, IP address and command port.
\Ticket{4007}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item Configuration variable \Macro{DAGMAN\_DEFAULT\_NODE\_LOG}
has been made more powerful,
so that it can be defined in HTCondor configuration files, 
instead of being useful only when defined in a per-DAG configuration file.
See section~\ref{param:DAGManDefaultNodeLog} for details.
\Ticket{3930}

\item The new configuration variable \Macro{CORE\_FILE\_NAME} is used to set
the name that DaemonCore uses to create a core file,
in the event of a daemon crash.
The default value for this configuration variable appends the daemon name,
so a crash of the \Condor{schedd} would create a core file named
\File{core.SCHEDD}.
\Ticket{4100}

\item The new configuration variable \Macro{JOB\_EXECDIR\_PERMISSIONS}
defines the permissions on a job's scratch directory. 
It defaults to setting permissions as \emph{0700}.
\Ticket{4016}

\item The following recently added machine ClassAd attributes have been renamed.
\begin{description}
\item \Attr{TotalJobStarts} became \Attr{JobStarts}.
\item \Attr{RecentTotalJobStarts} became \Attr{RecentJobStarts}.
\item \Attr{TotalPreemptions} became \Attr{JobPreemptions}.
\item \Attr{RecentPreemptions} became \Attr{RecentJobPreemptions}.
\item \Attr{TotalRankPreemptions} became \Attr{JobRankPreemptions}.
\item \Attr{RecentTotalRankPreemptions} became \Attr{RecentJobRankPreemptions}.
\item \Attr{TotalUserPrioPreemptions} became \Attr{JobUserPrioPreemptions}.
\item \Attr{RecentTotalUserPrioPreemptions} became \Attr{RecentJobUserPrioPreemptions}.
\end{description}
\Ticket{4101}

\item The new \Condor{schedd} statistics ClassAd attribute
\Attr{Autoclusters} gives the number of active autoclusters.
\Ticket{4020}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item None.

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-2}Version 8.1.2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.2 released on October 31, 2013.
This 8.1.2 release contains all bug fixes from HTCondor version 8.0.4.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item \Condor{config\_val} now supports \Opt{-dump} and \Opt{-verbose}
options to query configuration remotely from daemons.
\Ticket{3894}

\item The \Condor{chirp} protocol and command line tool has been
enhanced to support lower-cost, delayed updates to the job
ClassAd residing in the \Condor{schedd}; updates occur as other communications
take place, eliminating the overhead of a separate update.
These two new Chirp commands,
\Opt{set\_job\_attr\_delayed} and \Opt{get\_job\_attr\_delayed} allow the job
to send lightweight notification for events such as progress
monitoring, which need not be durable.
\Ticket{3353}

\item \Condor{history} has been enhanced to support
remote history using new \Opt{-pool} and \Opt{-name} options.
\Ticket{3897}

\item Matchmaking in the \Condor{negotiator} may be made aware of resources
available for partitionable slots.
This permits multiple jobs to be matched against a partitionable slot
during a single negotiation cycle.
The new policies discussed in Section~\ref{sec:consumption-policy}
are set using new configuration variables and are known as consumption policies.
\Ticket{3435}

\item Definition syntax for the authorization configuration variables
\Macro{ALLOW\_*} and \Macro{DENY\_*} has been expanded to permit
the specification of Unix netgroups.
See section~\ref{sec:Security-Authorization} for the syntax.
\Ticket{3859}

\item Definition syntax for the configuration variable
\Macro{QUEUE\_SUPER\_USERS} has been expanded to accept a specification
of Unix user groups.
See section~\ref{param:QueueSuperUsers} for the syntax.
\Ticket{3859}

\item To ensure that a grid universe job running at an EC2 service
terminates, 
HTCondor now checks after a fixed time interval 
that the job actually has terminated,
instead of relying on the service's potentially unreliable 
job shut down indication.
If the job has not terminated after a total of four checks,
the job is placed on hold; it does not leave the queue marked as completed.
\Ticket{3438}

\item Email alerts about file transfers taking longer than
\Macro{MAX\_TRANSFER\_QUEUE\_AGE} are now grouped together
to reduce the number of email messages that are sent.

\item Floating point values in Old ClassAds are now printed in a more
human-readable format, while retaining 64-bit double precision.
In previous versions, these values were always printed in scientific
notation.
\Ticket{3928}

\item \Condor{ssh\_to\_job} now works with grid universe jobs
which use EC2 resources.
\Ticket{1548}

\item Machine ClassAd attributes \Attr{Disk} and \Attr{TotalDisk} 
are now published as 64-bit integers,
rather than being capped at the maximum value of a 32-bit integer.
\Ticket{1784}

\item In an effort to improve scalability under heavy load, the tuning
configuration variable \Macro{MAX\_REAPS\_PER\_CYCLE} is exposed,
as defined at section~\ref{param:MaxReapsPerCycle}.
The default for this variable changed from 1 to 0.
\Ticket{3992}

\item To reduce the overwhelming quantity of per-user \Condor{schedd} 
statistics that are generated when configuration variables 
\MacroNI{SCHEDD\_COLLECT\_STATS\_FOR\_<Name>} or 
\MacroNI{SCHEDD\_COLLECT\_STATS\_BY\_<Name>} are used, 
the statistics are now published at verbosity level 2,
instead of verbosity level 1.
\Ticket{3980}

\item The Python bindings now include the \Code{Negotiator} class to
manage users and their priorities.
\Ticket{3893}

\item The Python bindings now provide automatic conversions from 
dictionaries to ClassAds,
so they can accept a dictionary directly as an argument,
rather than constructing a ClassAd from the dictionary.
\Ticket{3892}

\item The Python bindings \Code{ClassAd} module has 
\Procedure{quote} and \Procedure{unquote} 
methods to help create string literals. 
\Ticket{3900}

\item The Python bindings \Code{ClassAd} module has new
methods \Procedure{parseAds} and \Procedure{parseOldAds} 
that implement an iterator over ClassAds, in the New ClassAd and 
Old ClassAd format. 
\Ticket{3918}

\item The ordering of adding attributes to the machine ClassAd has been
changed, such that the attributes \Attr{Draining}, \Attr{DrainingRequestId},
and \Attr{LastDrainStartTime} are now added before the job retirement
is calculated.
This allows a decision about preemption to be made based on if
a machine is currently draining. 
\Ticket{3901}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item When \Macro{USE\_PID\_NAMESPACES} is \Expr{True}, 
the soft kill signal is now successfully sent to the job.
Previously, a \Condor{rm}
command of such a job would not remove the job until the
killing timeout had expired.
\Ticket{3981}

\item If a standard universe job exited without producing any
checkpoints and no checkpoint server was used, 
two spurious error messages would be logged to the \File{SchedLog},
as it tried to remove the old checkpoint images from the
non-existent checkpoint server.  
These error messages are no longer logged.
\Ticket{3919}

\item When configuration variable \Macro{STARTER\_RLIMIT\_AS} is set 
to its default value of 0, it means that there is no limit.  
This value was logged as a limit of 0Mb, leading to confusion.
Now, no message is logged in this default case.
\Ticket{3914}

\item Improved how the \Condor{schedd} notifies the \Condor{shadow}
and \Condor{gridmanager} about modifications to job ClassAds made using
\Condor{qedit}.
\Ticket{3909}

\item Grid universe jobs now use the correct executable file when
\SubmitCmd{copy\_to\_spool} is set to \Expr{True}.
Previously, the executable file named in the submit description file 
would be copied to the remote server, 
rather than the copy of the executable file stored in the spool directory.
\Ticket{3589}

\item The example configuration provided within files 
\File{condor\_config.generic} and \File{condor\_config.generic.redhat} 
has been updated to fix an inadequate expression defining 
\MacroNI{NEGOTIATOR\_POST\_JOB\_RANK} when the \Condor{startd} is 
configured to not run benchmarks, as \Attr{Kflops} would not be defined.
\Ticket{3589}

\item Fixed a Python binding crash due to a segmentation fault,
when evaluating an expression tree with an undefined reference.
The fix allows the user to define the \Code{ClassAd} scope 
within which an expression tree is evaluated.
\Ticket{3910}

\item The Python bindings now include a correct conversion of
\Code{absTime} and \Code{relTime} ClassAd literals to the 
corresponding Python types.
\Ticket{3911}

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-1}Version 8.1.1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.1 released on September 17, 2013.
This release contains all bug fixes from the stable release version 8.0.2.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Reduced the number of calls to the service when managing EC2 jobs. This
should increase the number of EC2 jobs HTCondor can manage on a given service
without overloading it.
\Ticket{3683}

\item When configuration variable \Macro{USE\_SHARED\_PORT} is \Expr{True},
\Macro{SHARED\_PORT} will now be automatically added to \Macro{DAEMON\_LIST}.
To disable this new behavior, set the new configuration variable:
\begin{verbatim}
  AUTO_INSERT_SHARED_PORT_IN_DAEMON_LIST = False
\end{verbatim}
\Ticket{3799}

\item Floating point values in ClassAds are now printed as 64-bit
double precision values when sent over the network, written to disk, and
displayed using the \Opt{-long} or \Opt{-autoformat} options of
\Condor{status} and \Condor{q}.
\Ticket{3363}

\item In the Pegasus/DAGMan workflow metrics,
as documented in section ~\ref{sec:DAGMetrics},
the two metrics
\Expr{dagman\_id} and \Expr{parent\_dagman\_id} are now reported
as the \Attr{ClusterId} of the \Condor{dagman} job.  This
eliminates any privacy concerns with reporting the \Condor{schedd} 
daemon's address,
which includes the submit machine's IP address.

\item The python bindings now can perform the equivalent of 
\Condor{ping} as a part of the \texttt{SecMan} object.
\Ticket{3857}

\item The \Condor{gridmanager} and \Condor{ft-gahp} now create
dynamic security session for performing file transfers.
Previously, the security configuration had to be set in a special
way for file transfers with the \Condor{ft-gahp} to work.
\Ticket{3536}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The new configuration variable \Macro{USE\_RESOURCE\_REQUEST\_COUNTS}
is a boolean value that defaults to \Expr{True}, 
reducing the latency of negotiation 
when there are many jobs next to each other in the queue 
with the same auto cluster, and many matches are being made.
\Ticket{3585}

\item Four new machine ClassAd attributes are advertised.
\Attr{TotalJobStarts} is the total number of jobs started by 
this \Condor{startd} daemon since it booted. 
\Attr{RecentTotalJobStarts} is the number of jobs started in the
last twenty minutes.  
Similarly, \Attr{TotalPreemptions} is
the number of jobs preempted since the \Condor{startd} daemon started,
and \Attr{RecentTotalPreemptions} is 
the number in the last 20 minutes.
\Ticket{3712}

\item \Macro{FILE\_TRANSFER\_DISK\_LOAD\_THROTTLE} now accepts tabs in addition to spaces as delimiters.
\Ticket{3798}

\item Configuration variable \Macro{VALID\_SPOOL\_FILES} has been expanded
to accept a single asterisk wild card character in each listed file name.
\Ticket{3764}

\item The new configuration variable \Macro{GAHP\_DEBUG\_HIDE\_SENSITIVE\_DATA}
is a boolean value that defaults to hiding sensitive data 
such as security keys and passwords
when communication with a GAHP server is written to a daemon log.
\Ticket{3536}

\item The default value of configuration variable 
\Macro{ENABLE\_CLASSAD\_CACHING} has changed to \Expr{True} for all
daemons other than the \Condor{shadow}, \Condor{starter}, and \Condor{master}.
\Ticket{3441}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item The \Condor{gridmanager} now does proper failure recovery when
submitting EC2 grid universe jobs to services that do not support 
the EC2 ClientToken parameter.
Previously, if there was a failure when submitting jobs to OpenStack
or Eucalyptus, the jobs could be submitted twice.
\Ticket{3682}

\item Fixed the printing of nested ClassAds, so that the nested ClassAds
can be read back properly.
\Ticket{3772}

\item Fixed a bug between the \Condor{gridmanager} and \Condor{ft-gahp}
that caused file transfers to fail if one of the two daemons was older
than version 8.1.0.
\Ticket{3856}

\item Fixed a bug that caused substitution in configuration variable
evaluation to ignore per-daemon overrides. 
This is a long standing bug that may result in subtle changes
to the way your configuration files are processed.
An example of how substitution works with the per-daemon overrides
is in section \ref{sec:Config-File-Macros}.
\Ticket{3822}

\item Fixed a bug that caused the command
\begin{verbatim}
  condor_submit -
\end{verbatim}
to be interpreted as an interactive submit,
rather than a request to read input from \File{stdin}.
\Condor{qsub} was also modified to be immune to this bug,
such that it will still work with other versions of HTCondor containing
the bug.
\Ticket{3902}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}
\item DAGMan recovery mode does not work for Pegasus-generated sub-DAGs.
For sub-DAGs, doing \Condor{hold} or \Condor{release} on
the \Condor{dagman} job, or stopping and re-starting the
\Condor{schedd} with the DAGMan
job in the queue will result in failure of the DAG.  This can be
avoided by doing a \Condor{rm} of the DAGMan job, which produces a Rescue
DAG, and re-submitting the DAG; the Rescue DAG is automatically run.
This bug was introduced in HTCondor version 8.0.1, and it also appears
in versions 8.0.2, 8.1.0, and 8.1.1.
\Ticket{3882}

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection*{\label{sec:New-8-1-0}Version 8.1.0}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\noindent Release Notes:

\begin{itemize}

\item HTCondor version 8.1.0 released on August 5, 2013.
This release contains all bug fixes from the stable release version 8.0.1.

\end{itemize}


\noindent New Features:

\begin{itemize}

\item Added support for publishing information about an HTCondor pool 
to \TM{Ganglia}.
See section~\ref{sec:Config-gangliad} on 
page~\pageref{sec:Config-gangliad} for configuration variable details.
\Ticket{3515}

\item Improved the performance of the \Condor{collector} daemon when running
at sites that do not observe daylight savings time.
\Ticket{2898}

\item \Condor{q}, \Condor{rm}, \Condor{status} and \Condor{qedit} are now 
more consistent in the way they handle the \Opt{-constraint} option.
\Ticket{1156}

\item The new \Condor{dagman\_metrics\_reporter} executable
with manual page at ~\pageref{man-condor-dagman-metrics-reporter},
reports metrics for DAGMan workflows running under Pegasus.  \Condor{dagman}
now generates an output file of the relevant metrics,
as described at ~\pageref{sec:DAGMetrics}.
\Ticket{3532}

\end{itemize}

\noindent Configuration Variable and ClassAd Attribute Additions and Changes:

\begin{itemize}

\item The default value of configuration variable
\Macro{COLLECTOR\_MAX\_FILE\_DESCRIPTORS} has changed to 10240,
and the default value of configuration variable 
\Macro{SCHEDD\_MAX\_FILE\_DESCRIPTORS} has changed to 4096.
This increases the scalability of the default configuration.
\Ticket{3626}

\item The new configuration variable
\Macro{FILE\_TRANSFER\_DISK\_LOAD\_THROTTLE} enables dynamic
adjustment of the level of file transfer concurrency in order to
keep the disk load generated by transfers below a specified level.
Supporting this new feature are configuration variables
\Macro{FILE\_TRANSFER\_DISK\_LOAD\_THROTTLE\_WAIT\_BETWEEN\_INCREMENTS},
\Macro{FILE\_TRANSFER\_DISK\_LOAD\_THROTTLE\_SHORT\_HORIZON}, and
\Macro{FILE\_TRANSFER\_DISK\_LOAD\_THROTTLE\_LONG\_HORIZON}.
\Ticket{3613}

\item The following new \Condor{schedd} ClassAd attributes are for
monitoring file transfer activity:
\AdAttr{TransferQueueMBWaitingToDownload},
\AdAttr{TransferQueueMBWaitingToUpload},
\AdAttr{FileTransferDiskThrottleLevel},
\AdAttr{FileTransferDiskThrottleHigh}, and
\AdAttr{FileTransferDiskThrottleLow}.
\Ticket{3613}

\item The default value for the configuration variable
\Macro{PASSWD\_CACHE\_REFRESH} has been changed from 300 seconds to
72000 seconds (20 hours).
\Ticket{3723}

\item The new configuration variables
\Macro{DAGMAN\_PEGASUS\_REPORT\_METRICS} and
\Macro{DAGMAN\_PEGASUS\_REPORT\_TIMEOUT}
set defaults used by the new \Condor{dagman\_metrics\_reporter} executable,
which reports metrics for DAGMan jobs running under Pegasus.
\Ticket{3532}

\end{itemize}

\noindent Bugs Fixed:

\begin{itemize}

\item HTCondor version 8.0.0 had an unintended change in the Chirp 
wire protocol.
This change caused \Condor{chirp} with the \Opt{put} option
to fail when the execute node
was running HTCondor version 7.8.x or earlier versions. 
HTCondor 8.0.1 and later
versions will now send the original wire protocol, and accept either the
original protocol, or the variant that HTCondor version 8.0.0 sends.
\Ticket{3735}

\item Fixed a bug that could cause the daemons to crash on Unix platforms,
if the operating system reported that a job owner's account 
did not exist, for example due to a temporary NIS or LDAP failure.
\Ticket{3723}

\item Fixed a bug that resulted in a misleading error message when
\Condor{status} with the \Opt{-constraint} option specified a constraint 
that could not be parsed.
\Ticket{1319}

\item Fixed a typo in the output of \Condor{q},
where a period was erroneously present within a heading.
\Ticket{3703}

\end{itemize}

\noindent Known Bugs:

\begin{itemize}

\item None.

\end{itemize}

\noindent Additions and Changes to the Manual:

\begin{itemize}

\item None.

\end{itemize}


