SRC_DIR = $(SRC_TREE)/condor_tools
CFLAGS = $(STD_C_FLAGS) $(PLATFORM_C_FLAGS) 

#if IS_SGI_IRIX53 || IS_SGI_IRIX62
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS)  
#else
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) -fno-implicit-templates
#endif

LDFLAGS = RpcLib SocketLib

CLASSAD_LIB = ../condor_classad/expr_lib.a

SRC = config_val.C preen.C user_prio.C history.C tool.C stats.C releasejob.C \
	view_collection.C

LIB= ../condor_c++_util/cplus_lib.a $(CLASSAD_LIB) ../condor_util_lib/util_lib.a $(AUTH2_LIB)
LIBDIRS =../condor_util_lib ../condor_c++_util
PROGRAMS =  	condor_config_val condor_preen condor_stats \
		condor_userprio condor_history condor test_calc \
		condor_release view_collection

all_target( $(PROGRAMS) )
tags_target($(SRC),$(LIBDIRS))
depend_target($(SRC))

c_plus_target(condor_preen,preen.o,../condor_schedd.V6/libqmgmt.a $(LIB))
release_target(condor_preen,$(RELEASE_DIR)/sbin,EXECUTABLE_MODE)
strip_target(condor_preen,$(STRIP_DIR)/sbin,EXECUTABLE_MODE)
static_target(condor_preen,preen.o,../condor_schedd.V6/libqmgmt.a $(LIB),$(STATIC_DIR)/sbin)

c_plus_target(condor_release,releasejob.o,../condor_schedd.V6/libqmgmt.a $(LIB))
release_target(condor_release,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
strip_target(condor_release,$(STRIP_DIR)/bin,EXECUTABLE_MODE)
static_target(condor_release,releasejob.o,../condor_schedd.V6/libqmgmt.a $(LIB),$(STATIC_DIR)/bin)

c_plus_target(condor_config_val,config_val.o,$(LIB))
release_target(condor_config_val,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
strip_target(condor_config_val,$(STRIP_DIR)/bin,EXECUTABLE_MODE)
static_target(condor_config_val,config_val.o,$(LIB),$(STATIC_DIR)/bin)
purecov_c_plus_target(condor_config_val.pc,config_val.pure.o,$(LIB))

config_val.pure.o: config_val.C
	$(CPlusPlus) -o config_val.pure.o -c config_val.C -DPURE_DEBUG \
	$(C_PLUS_FLAGS) 

c_plus_target(condor_userprio,user_prio.o,$(LIB))
release_target(condor_userprio,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
strip_target(condor_userprio,$(STRIP_DIR)/bin,EXECUTABLE_MODE)
static_target(condor_userprio,user_prio.o,$(LIB),$(STATIC_DIR)/bin)

c_plus_target(condor_history,history.o,$(LIB))
release_target(condor_history,$(RELEASE_DIR)/bin,EXECUTABLE_MODE)
strip_target(condor_history,$(STRIP_DIR)/bin,EXECUTABLE_MODE)
static_target(condor_history,history.o,$(LIB),$(STATIC_DIR)/bin)

c_plus_target(condor,tool.o,$(LIB))
release_target(condor,$(RELEASE_DIR)/sbin,EXECUTABLE_MODE)
strip_target(condor,$(STRIP_DIR)/sbin,EXECUTABLE_MODE)
static_target(condor,tool.o,$(LIB),$(STATIC_DIR)/sbin)
purecov_c_plus_target(condor.pc,tool.o,$(LIB))

link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_on)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_off)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_checkpoint)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_vacate)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_restart)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reconfig)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reconfig_schedd)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_reschedule)
link_torelease_target($(RELEASE_DIR)/sbin/condor,sbin,condor_master_off)

link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_on)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_off)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_checkpoint)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_vacate)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_restart)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_reconfig)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_reconfig_schedd)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_reschedule)
link_tostrip_target($(STRIP_DIR)/sbin/condor,sbin,condor_master_off)

link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_on)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_off)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_checkpoint)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_vacate)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_restart)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_reconfig)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_reconfig_schedd)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_reschedule)
link_tostatic_target($(STATIC_DIR)/sbin/condor,sbin,condor_master_off)

c_plus_target(condor_stats,stats.o,$(LIB))

c_plus_target(test_calc,test_calc.o,$(LIB))

c_plus_target(view_collection,view_collection.o,$(LIB))

condor_master_on: master_on.c
	gcc -o condor_master_on master_on.c

condor_kill: kill.C
	g++ -o condor_kill kill.C -I../condor_c++_util

clean::
	rm -f condor_kill condor_master_on *.o
