all_target(procd_client.a condor_procd)

CFLAGS = $(STD_C_FLAGS) -DPROCD_DEBUG=1
C_PLUS_FLAGS = $(STD_C_PLUS_FLAGS) -DPROCD_DEBUG=1

IMPORT_LINKS=../../config/import_links
import(../condor_util_lib,condor_full_io.o)
import(../condor_util_lib,condor_blkng_full_disk_io.o)
import(../condor_util_lib,condor_pidenvid.o)
import(../condor_c++_util,condor_open.o)
import(../condor_procapi,procapi.o)
IMPORT_OBJ=condor_full_io.o condor_blkng_full_disk_io.o condor_pidenvid.o condor_open.o

PROCD_OBJ=procd_main.o procd_common.o \
          proc_family_server.o local_server.UNIX.o \
          named_pipe_reader.o named_pipe_writer.o \
          named_pipe_watchdog_server.o named_pipe_watchdog.o \
          named_pipe_util.o \
          proc_family_monitor.o proc_family.o proc_family_member.o \
          proc_family_tracker.o parent_tracker.o login_tracker.o \
          procd_instantiate.o \
          dprintf_lite.o \
          $(IMPORT_OBJ)
#if IS_LINUX
PROCD_OBJ+= group_tracker.o gid_pool.o
#endif
template_inst(procd_instantiate.C,procd_instantiate.o)
public_c_plus_nowrap_target(condor_procd,sbin,$(PROCD_OBJ),$(PROCAPI_LIB))

LIB_OBJ=proc_family_client.o proc_family_io.o local_client.UNIX.o \
        named_pipe_reader.o named_pipe_writer.o \
        named_pipe_watchdog.o named_pipe_util.o
library_target(procd_client.a,$(LIB_OBJ))

c_plus_nowrap_target(procd_dump,procd_dump.o,procd_client.a $(STD_LIBS))
c_plus_nowrap_target(procd_quit,procd_quit.o,procd_client.a $(STD_LIBS))

LOCAL_SERVER_TEST_OBJ=local_server_test.o local_server.UNIX.o \
                      named_pipe_reader.o named_pipe_writer.o \
                      named_pipe_watchdog_server.o \
                      named_pipe_util.o
c_plus_target(local_server_test,$(LOCAL_SERVER_TEST_OBJ),$(STD_LIBS))

LOCAL_CLIENT_TEST_OBJ=local_client_test.o local_client.UNIX.o \
                      named_pipe_reader.o named_pipe_writer.o \
                      named_pipe_util.o
c_plus_target(local_client_test,$(LOCAL_CLIENT_TEST_OBJ),$(STD_LIBS))

html:
release:: all
stripped:: all
static:: all
clean::
testbin:: all
