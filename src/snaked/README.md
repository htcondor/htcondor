Updated
-------

The command handler can now be a generator.

Config Magic
------------

    SNAKED          = $(SBIN)/condor_snaked
    SNAKED_LOG      = $(LOG)/SnakeLog
    SNAKE_PATH      = $(LIB)/python3:$(ETC)/snake.d
    DAEMON_LIST     = $(DAEMON_LIST), SNAKED

Further Setup
-------------

Create ``$(ETC)/snake.d/snake/__init__.py`` and fill it with:

    from pathlib import Path

    # def handleCommand(command_int):
    #     p = Path("/tmp") / "snake.out"
    #     p.write_text(f"handled command int {command_int}\n")

    # def handleCommand(command_int):
    #     for i in range(3):
    #         p = Path("/tmp") / "snake.out"
    #         with p.open("a") as f:
    #             print(f"handled command int {command_int}, count {i}", file=f)
    #         yield i

    # def handleCommand(command_int, payload):
    #     for i in range(3):
    #        p = Path("/tmp") / "snake.out"
    #         with p.open("a") as f:
    #             p = payload.get('classad')
    #             print(f"handled command int {command_int}, count {i}, payload {p}", file=f)
    #         yield i

    def handleCommand(command_int, payload):
        for i in range(3):
            p = Path("/tmp") / "snake.out"
            with p.open("a") as f:
                p = payload.get('classad')
                print(
                    f"handled command int {command_int}, count {i}, payload {p}",
                    file=f
                )
            yield i


where ``"/tmp"`` is subject to change and ``"handled ..."`` should be,
to make sure I'm not cheating. :)

Demo
----

Run ``condor_master``.  Look at ``SnakeLog``; copy its command socket
sinful.  Run ``condor_status -direct '<sinful>'``; it will fail, but
you should now have a file, ``/tmp/snake.out``, that was generated by the
``handleCommand()`` function.
